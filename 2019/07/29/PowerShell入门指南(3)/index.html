<!DOCTYPE html>
<html lang="zh-CN">
    <head hexo-theme='https://github.com/volantis-x/hexo-theme-volantis/#5.7.6'>
  <meta name="generator" content="Hexo 5.4.0">
  <meta name="Volantis" content="5.7.6">
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
  <link rel="canonical" href="https://www.lollipopnougat.top/2019/07/29/powershell入门指南(3)/"/>
  <!-- 渲染优化 -->
    <meta http-equiv='x-dns-prefetch-control' content='on' />
      <link rel='dns-prefetch' href='https://unpkg.com'>
      <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Content-Security-Policy" content=" default-src 'self' https:; block-all-mixed-content; base-uri 'self' https:; form-action 'self' https:; worker-src 'self' https:; connect-src 'self' https: *; img-src 'self' data: https: *; media-src 'self' https: *; font-src 'self' data: https: *; frame-src 'self' https: *; manifest-src 'self' https: *; child-src https:; script-src 'self' https: 'unsafe-inline' *; style-src 'self' https: 'unsafe-inline' *; ">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta content="black-translucent" name="apple-mobile-web-app-status-bar-style">
  <meta content="telephone=no" name="format-detection">
  <!-- import head_begin begin -->
  <!-- import head_begin end -->
  <!-- Custom Files headBegin begin-->
  
  <!-- Custom Files headBegin end-->
  <link rel="preload" href="/css/style.css" as="style">
  <link rel="preload" href="https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/VarelaRound/VarelaRound-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
<link rel="preload" href="https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/UbuntuMono/UbuntuMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <!-- feed -->
      <link rel="alternate" href="/atom.xml" title="LNP" type="application/atom+xml">
  <!-- 页面元数据 -->
  <title>PowerShell入门指南(3) - LNP</title>
  <meta name="keywords" content="PowerShell,null">
  <meta desc name="description" content="PowerShell入门指南(三)·一门新的编程语言
作为独立的编程语言作为一门独立的语言来说，PowerShell 是非常地Powerful，我们先来了解一下它的特点: - lollipopnougat - LNP">
  
<meta property="og:type" content="article">
<meta property="og:title" content="PowerShell入门指南(3)">
<meta property="og:url" content="https://www.lollipopnougat.top/2019/07/29/PowerShell%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97(3)/index.html">
<meta property="og:site_name" content="LNP">
<meta property="og:description" content="PowerShell入门指南(三)·一门新的编程语言 作为独立的编程语言作为一门独立的语言来说，PowerShell 是非常地Powerful，我们先来了解一下它的特点:">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png">
<meta property="article:published_time" content="2019-07-29T01:56:12.000Z">
<meta property="article:modified_time" content="2021-04-25T15:24:47.976Z">
<meta property="article:author" content="lollipopnougat">
<meta property="article:tag" content="PowerShell">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png">
  <style>
    /* 首屏样式 */
    #safearea {
  display: none;
}
:root {
  --color-site-body: #f4f4f4;
  --color-site-bg: #f4f4f4;
  --color-site-inner: #fff;
  --color-site-footer: #666;
  --color-card: #fff;
  --color-text: #444;
  --color-block: #f6f6f6;
  --color-inlinecode: #c74f00;
  --color-codeblock: #fff7ea;
  --color-h1: #3a3a3a;
  --color-h2: #3a3a3a;
  --color-h3: #333;
  --color-h4: #444;
  --color-h5: #555;
  --color-h6: #666;
  --color-p: #444;
  --color-list: #666;
  --color-list-hl: #30ad91;
  --color-meta: #888;
  --color-read-bkg: #e0d8c8;
  --color-read-post: #f8f1e2;
  --color-copyright-bkg: #f5f5f5;
}
* {
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  outline: none;
  margin: 0;
  padding: 0;
}
*::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}
*::-webkit-scrollbar-track-piece {
  background: transparent;
}
*::-webkit-scrollbar-thumb {
  background: #3dd9b6;
  cursor: pointer;
  border-radius: 2px;
  -webkit-border-radius: 2px;
}
*::-webkit-scrollbar-thumb:hover {
  background: #ff5722;
}
html {
  color: var(--color-text);
  width: 100%;
  height: 100%;
  font-family: UbuntuMono, "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Menlo, Monaco, monospace, sans-serif;
  font-size: 16px;
}
html >::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}
html >::-webkit-scrollbar-track-piece {
  background: transparent;
}
html >::-webkit-scrollbar-thumb {
  background: #3dd9b6;
  cursor: pointer;
  border-radius: 2px;
  -webkit-border-radius: 2px;
}
html >::-webkit-scrollbar-thumb:hover {
  background: #ff5722;
}
body {
  background-color: var(--color-site-body);
  text-rendering: optimizelegibility;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
  line-height: 1.6;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}
body.modal-active {
  overflow: hidden;
}
@media screen and (max-width: 680px) {
  body.modal-active {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
a {
  color: #2092ec;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
a:hover {
  color: #ff5722;
}
a:active,
a:hover {
  outline: 0;
}
ul,
ol {
  padding-left: 0;
}
ul li,
ol li {
  list-style: none;
}
header {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
img {
  border: 0;
  background: none;
  max-width: 100%;
}
svg:not(:root) {
  overflow: hidden;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  -webkit-box-sizing: content-box;
  -moz-box-sizing: content-box;
  height: 0;
  border: 0;
  border-radius: 1px;
  -webkit-border-radius: 1px;
  border-bottom: 1px solid rgba(68,68,68,0.1);
}
button,
input {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
  text-transform: none;
  -webkit-appearance: button;
  cursor: pointer;
}
@supports (backdrop-filter: blur(20px)) {
  .blur {
    background: rgba(255,255,255,0.9) !important;
    backdrop-filter: saturate(200%) blur(20px);
  }
}
.shadow {
  box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
}
.shadow.floatable {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.shadow.floatable:hover {
  box-shadow: 0 2px 4px 0px rgba(0,0,0,0.1), 0 4px 8px 0px rgba(0,0,0,0.1), 0 8px 16px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 2px 4px 0px rgba(0,0,0,0.1), 0 4px 8px 0px rgba(0,0,0,0.1), 0 8px 16px 0px rgba(0,0,0,0.1);
}
#l_cover {
  min-height: 64px;
}
.cover-wrapper {
  top: 0;
  left: 0;
  max-width: 100%;
  height: 100vh;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  align-self: center;
  align-content: center;
  color: var(--color-site-inner);
  padding: 0 16px;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  position: relative;
  overflow: hidden;
  margin-bottom: -100px;
}
.cover-wrapper .cover-bg {
  position: absolute;
  width: 100%;
  height: 100%;
  background-position: center;
  background-size: cover;
  -webkit-background-size: cover;
  -moz-background-size: cover;
}
.cover-wrapper .cover-bg.lazyload:not(.loaded) {
  opacity: 0;
  -webkit-opacity: 0;
  -moz-opacity: 0;
}
.cover-wrapper .cover-bg.lazyload.loaded {
  animation-delay: 0s;
  animation-duration: 0.5s;
  animation-fill-mode: forwards;
  animation-timing-function: ease-out;
  animation-name: fadeIn;
}
@-moz-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-o-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.cover-wrapper .cover-body {
  z-index: 1;
  position: relative;
  width: 100%;
  height: 100%;
}
.cover-wrapper#full {
  height: calc(100vh + 100px);
  padding-bottom: 100px;
}
.cover-wrapper#half {
  max-height: 640px;
  min-height: 400px;
  height: calc(36vh - 64px + 200px);
}
.cover-wrapper #scroll-down {
  width: 100%;
  height: 64px;
  position: absolute;
  bottom: 100px;
  text-align: center;
  cursor: pointer;
}
.cover-wrapper #scroll-down .scroll-down-effects {
  color: #fff;
  font-size: 24px;
  line-height: 64px;
  position: absolute;
  width: 24px;
  left: calc(50% - 12px);
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
  animation: scroll-down-effect 1.5s infinite;
  -webkit-animation: scroll-down-effect 1.5s infinite;
  -khtml-animation: scroll-down-effect 1.5s infinite;
  -moz-animation: scroll-down-effect 1.5s infinite;
  -o-animation: scroll-down-effect 1.5s infinite;
  -ms-animation: scroll-down-effect 1.5s infinite;
}
@-moz-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-webkit-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-o-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.cover-wrapper .cover-body {
  margin-top: 64px;
  margin-bottom: 100px;
}
.cover-wrapper .cover-body,
.cover-wrapper .cover-body .top,
.cover-wrapper .cover-body .bottom {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  max-width: 100%;
}
.cover-wrapper .cover-body .bottom {
  margin-top: 32px;
}
.cover-wrapper .cover-body .title {
  font-family: "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Helvetica, monospace;
  font-size: 3.125rem;
  line-height: 1.2;
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
.cover-wrapper .cover-body .subtitle {
  font-size: 20px;
}
.cover-wrapper .cover-body .logo {
  max-height: 120px;
  max-width: calc(100% - 4 * 16px);
}
@media screen and (min-height: 1024px) {
  .cover-wrapper .cover-body .title {
    font-size: 3rem;
  }
  .cover-wrapper .cover-body .subtitle {
    font-size: 1.05rem;
  }
  .cover-wrapper .cover-body .logo {
    max-height: 150px;
  }
}
.cover-wrapper .cover-body .m_search {
  position: relative;
  max-width: calc(100% - 16px);
  width: 320px;
  vertical-align: middle;
}
.cover-wrapper .cover-body .m_search .form {
  position: relative;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  width: 100%;
}
.cover-wrapper .cover-body .m_search .icon,
.cover-wrapper .cover-body .m_search .input {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.cover-wrapper .cover-body .m_search .icon {
  position: absolute;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  line-height: 2.5rem;
  width: 32px;
  top: 0;
  left: 5px;
  color: rgba(68,68,68,0.75);
}
.cover-wrapper .cover-body .m_search .input {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  height: 2.5rem;
  width: 100%;
  box-shadow: none;
  -webkit-box-shadow: none;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  font-size: 0.875rem;
  -webkit-appearance: none;
  padding-left: 36px;
  border-radius: 1.4rem;
  -webkit-border-radius: 1.4rem;
  background: rgba(255,255,255,0.6);
  backdrop-filter: blur(10px);
  border: none;
  color: var(--color-text);
}
@media screen and (max-width: 500px) {
  .cover-wrapper .cover-body .m_search .input {
    padding-left: 36px;
  }
}
.cover-wrapper .cover-body .m_search .input:hover {
  background: rgba(255,255,255,0.8);
}
.cover-wrapper .cover-body .m_search .input:focus {
  background: #fff;
}
.cover-wrapper .list-h {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  -khtml-flex-wrap: wrap;
  -moz-flex-wrap: wrap;
  -o-flex-wrap: wrap;
  -ms-flex-wrap: wrap;
  align-items: stretch;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.cover-wrapper .list-h a {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1 0;
  -ms-flex: 1 0;
  flex: 1 0;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  font-weight: 600;
}
.cover-wrapper .list-h a img {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  border-radius: 2px;
  -webkit-border-radius: 2px;
  margin: 4px;
  min-width: 40px;
  max-width: 44px;
}
@media screen and (max-width: 768px) {
  .cover-wrapper .list-h a img {
    min-width: 36px;
    max-width: 40px;
  }
}
@media screen and (max-width: 500px) {
  .cover-wrapper .list-h a img {
    margin: 2px 4px;
    min-width: 32px;
    max-width: 36px;
  }
}
@media screen and (max-width: 375px) {
  .cover-wrapper .list-h a img {
    min-width: 28px;
    max-width: 32px;
  }
}
.cover-wrapper {
  max-width: 100%;
}
.cover-wrapper.search .bottom .menu {
  margin-top: 16px;
}
.cover-wrapper.search .bottom .menu .list-h a {
  white-space: nowrap;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  align-items: baseline;
  padding: 2px;
  margin: 4px;
  color: var(--color-site-inner);
  opacity: 0.75;
  -webkit-opacity: 0.75;
  -moz-opacity: 0.75;
  text-shadow: 0 1px 2px rgba(0,0,0,0.05);
  border-bottom: 2px solid transparent;
}
.cover-wrapper.search .bottom .menu .list-h a i {
  margin-right: 4px;
}
.cover-wrapper.search .bottom .menu .list-h a p {
  font-size: 0.9375rem;
}
.cover-wrapper.search .bottom .menu .list-h a:hover,
.cover-wrapper.search .bottom .menu .list-h a.active,
.cover-wrapper.search .bottom .menu .list-h a:active {
  opacity: 1;
  -webkit-opacity: 1;
  -moz-opacity: 1;
  border-bottom: 2px solid var(--color-site-inner);
}
@media (prefers-color-scheme: dark) {
  :root {
    --color-mode: 'dark';
  }
  :root:not([color-scheme]) {
    --color-site-body: #121212;
    --color-read-bkg: #1f1f1f;
    --color-read-post: #262626;
    --color-site-bg: #1f1f1f;
    --color-site-inner: rgba(238,238,238,0.871);
    --color-site-footer: rgba(170,170,170,0.871);
    --color-card: #262626;
    --color-text: rgba(238,238,238,0.871);
    --color-block: #434343;
    --color-codeblock: #1f1f1f;
    --color-inlinecode: #d56d28;
    --color-h1: rgba(255,255,255,0.871);
    --color-h2: rgba(255,255,255,0.871);
    --color-h3: rgba(255,255,255,0.6);
    --color-h4: rgba(255,255,255,0.6);
    --color-h5: rgba(255,255,255,0.6);
    --color-h6: rgba(255,255,255,0.6);
    --color-p: rgba(217,217,217,0.871);
    --color-list: rgba(217,217,217,0.871);
    --color-list-hl: #63e0c4;
    --color-meta: rgba(191,191,191,0.871);
    --color-link: rgba(191,191,191,0.871);
    --color-copyright-bkg: #21252b;
  }
  :root:not([color-scheme]) img {
    filter: brightness(70%) !important;
  }
  :root:not([color-scheme]) .blur {
    background: rgba(31,31,31,0.9) !important;
  }
  :root:not([color-scheme]) .white-box.blur {
    background: rgba(38,38,38,0.9) !important;
  }
  :root:not([color-scheme]) .nav-main .u-search-input {
    background: var(--color-card) !important;
  }
  :root:not([color-scheme]) #l_main .article .prev-next>a {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) #l_main .article .prev-next>a:hover {
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) .article blockquote {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .article-title a {
    color: var(--color-h1) !important;
  }
  :root:not([color-scheme]) details>summary {
    color: var(--color-p) !important;
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) details {
    border: 1px solid var(--color-site-bg) !important;
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) #u-search .modal,
  :root:not([color-scheme]) #u-search .modal-header,
  :root:not([color-scheme]) #u-search .modal-body {
    background: var(--color-card) !important;
  }
  :root:not([color-scheme]) #u-search .modal-body .modal-results .result:hover {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .u-search-input:hover {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .u-search-input:focus {
    background: var(--color-site-body) !important;
  }
}
[color-scheme='dark'] {
  --color-site-body: #121212;
  --color-read-bkg: #1f1f1f;
  --color-read-post: #262626;
  --color-site-bg: #1f1f1f;
  --color-site-inner: rgba(238,238,238,0.871);
  --color-site-footer: rgba(170,170,170,0.871);
  --color-card: #262626;
  --color-text: rgba(238,238,238,0.871);
  --color-block: #434343;
  --color-codeblock: #1f1f1f;
  --color-inlinecode: #d56d28;
  --color-h1: rgba(255,255,255,0.871);
  --color-h2: rgba(255,255,255,0.871);
  --color-h3: rgba(255,255,255,0.6);
  --color-h4: rgba(255,255,255,0.6);
  --color-h5: rgba(255,255,255,0.6);
  --color-h6: rgba(255,255,255,0.6);
  --color-p: rgba(217,217,217,0.871);
  --color-list: rgba(217,217,217,0.871);
  --color-list-hl: #63e0c4;
  --color-meta: rgba(191,191,191,0.871);
  --color-link: rgba(191,191,191,0.871);
  --color-copyright-bkg: #21252b;
}
[color-scheme='dark'] img {
  filter: brightness(70%) !important;
}
[color-scheme='dark'] .blur {
  background: rgba(31,31,31,0.9) !important;
}
[color-scheme='dark'] .white-box.blur {
  background: rgba(38,38,38,0.9) !important;
}
[color-scheme='dark'] .nav-main .u-search-input {
  background: var(--color-card) !important;
}
[color-scheme='dark'] #l_main .article .prev-next>a {
  background: var(--color-block) !important;
}
[color-scheme='dark'] #l_main .article .prev-next>a:hover {
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] .article blockquote {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .article-title a {
  color: var(--color-h1) !important;
}
[color-scheme='dark'] details>summary {
  color: var(--color-p) !important;
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] details {
  border: 1px solid var(--color-site-bg) !important;
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] #u-search .modal,
[color-scheme='dark'] #u-search .modal-header,
[color-scheme='dark'] #u-search .modal-body {
  background: var(--color-card) !important;
}
[color-scheme='dark'] #u-search .modal-body .modal-results .result:hover {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .u-search-input:hover {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .u-search-input:focus {
  background: var(--color-site-body) !important;
}
@media screen and (max-width: 500px) {
  [color-scheme='dark'] .l_header .m_search {
    background: var(--color-site-bg) !important;
  }
}
@font-face {
  font-family: 'UbuntuMono';
  src: url("https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/UbuntuMono/UbuntuMono-Regular.ttf");
  font-weight: 'normal';
  font-style: 'normal';
  font-display: swap;
}
@font-face {
  font-family: 'Varela Round';
  src: url("https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/VarelaRound/VarelaRound-Regular.ttf");
  font-weight: 'normal';
  font-style: 'normal';
  font-display: swap;
}
.l_header {
  position: fixed;
  z-index: 1000;
  top: 0;
  width: 100%;
  height: 64px;
  background: var(--color-card);
  box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
}
.l_header.auto {
  transition: opacity 0.4s ease;
  -webkit-transition: opacity 0.4s ease;
  -khtml-transition: opacity 0.4s ease;
  -moz-transition: opacity 0.4s ease;
  -o-transition: opacity 0.4s ease;
  -ms-transition: opacity 0.4s ease;
  visibility: hidden;
}
.l_header.auto.show {
  opacity: 1 !important;
  -webkit-opacity: 1 !important;
  -moz-opacity: 1 !important;
  visibility: visible;
}
.l_header .container {
  margin-left: 16px;
  margin-right: 16px;
}
.l_header #wrapper {
  height: 100%;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.l_header #wrapper .nav-main,
.l_header #wrapper .nav-sub {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  justify-content: space-between;
  -webkit-justify-content: space-between;
  -khtml-justify-content: space-between;
  -moz-justify-content: space-between;
  -o-justify-content: space-between;
  -ms-justify-content: space-between;
  align-items: center;
}
.l_header #wrapper .nav-main {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.l_header #wrapper.sub .nav-main {
  transform: translateY(-64px);
  -webkit-transform: translateY(-64px);
  -khtml-transform: translateY(-64px);
  -moz-transform: translateY(-64px);
  -o-transform: translateY(-64px);
  -ms-transform: translateY(-64px);
}
.l_header #wrapper .nav-sub {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  opacity: 0;
  -webkit-opacity: 0;
  -moz-opacity: 0;
  height: 64px;
  width: calc(100% - 2 * 16px);
  position: absolute;
}
.l_header #wrapper .nav-sub ::-webkit-scrollbar {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
}
@media screen and (min-width: 2048px) {
  .l_header #wrapper .nav-sub {
    max-width: 55vw;
    margin: auto;
  }
}
.l_header #wrapper.sub .nav-sub {
  opacity: 1;
  -webkit-opacity: 1;
  -moz-opacity: 1;
}
.l_header #wrapper .title {
  position: relative;
  color: var(--color-text);
  padding-left: 24px;
  max-height: 64px;
}
.l_header #wrapper .nav-main .title {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex-shrink: 0;
  line-height: 64px;
  padding: 0 24px;
  font-size: 1.25rem;
  font-family: "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Helvetica, monospace;
}
.l_header #wrapper .nav-main .title img {
  height: 64px;
}
.l_header .nav-sub {
  max-width: 1080px;
  margin: auto;
}
.l_header .nav-sub .title {
  font-weight: bold;
  font-family: UbuntuMono, "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Menlo, Monaco, monospace, sans-serif;
  line-height: 1.2;
  max-height: 64px;
  white-space: normal;
  flex-shrink: 1;
}
.l_header .switcher {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  line-height: 64px;
  align-items: center;
}
.l_header .switcher .s-toc {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
}
@media screen and (max-width: 768px) {
  .l_header .switcher .s-toc {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: -ms-flexbox /* TWEENER - IE 10 */;
    display: -webkit-flex /* NEW - Chrome */;
    display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
    display: flex;
  }
}
.l_header .switcher >li {
  height: 48px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  margin: 2px;
}
@media screen and (max-width: 500px) {
  .l_header .switcher >li {
    margin: 0 1px;
    height: 48px;
  }
}
.l_header .switcher >li >a {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  align-items: center;
  width: 48px;
  height: 48px;
  padding: 0.85em 1.1em;
  border-radius: 100px;
  -webkit-border-radius: 100px;
  border: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  color: #3dd9b6;
}
.l_header .switcher >li >a:hover {
  border: none;
}
.l_header .switcher >li >a.active,
.l_header .switcher >li >a:active {
  border: none;
  background: var(--color-site-bg);
}
@media screen and (max-width: 500px) {
  .l_header .switcher >li >a {
    width: 36px;
    height: 48px;
  }
}
.l_header .nav-sub .switcher {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
}
.l_header .m_search {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  height: 64px;
  width: 240px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
@media screen and (max-width: 1024px) {
  .l_header .m_search {
    width: 44px;
    min-width: 44px;
  }
  .l_header .m_search input::placeholder {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
  }
  .l_header .m_search:hover {
    width: 240px;
  }
  .l_header .m_search:hover input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media screen and (min-width: 500px) {
  .l_header .m_search:hover .input {
    width: 100%;
  }
  .l_header .m_search:hover .input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media screen and (max-width: 500px) {
  .l_header .m_search {
    min-width: 0;
  }
  .l_header .m_search input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.l_header .m_search .form {
  position: relative;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  width: 100%;
  align-items: center;
}
.l_header .m_search .icon {
  position: absolute;
  width: 36px;
  left: 5px;
  color: var(--color-meta);
}
@media screen and (max-width: 500px) {
  .l_header .m_search .icon {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: none;
  }
}
.l_header .m_search .input {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  padding-top: 8px;
  padding-bottom: 8px;
  line-height: 1.3;
  width: 100%;
  color: var(--color-text);
  background: #fafafa;
  box-shadow: none;
  -webkit-box-shadow: none;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  padding-left: 40px;
  font-size: 0.875rem;
  border-radius: 8px;
  -webkit-border-radius: 8px;
  border: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
@media screen and (min-width: 500px) {
  .l_header .m_search .input:focus {
    box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1);
    -webkit-box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1);
  }
}
@media screen and (max-width: 500px) {
  .l_header .m_search .input {
    background: var(--color-block);
    padding-left: 8px;
    border: none;
  }
  .l_header .m_search .input:hover,
  .l_header .m_search .input:focus {
    border: none;
  }
}
@media (max-width: 500px) {
  .l_header .m_search {
    left: 0;
    width: 0;
    overflow: hidden;
    position: absolute;
    background: #fff;
    transition: all 0.28s ease;
    -webkit-transition: all 0.28s ease;
    -khtml-transition: all 0.28s ease;
    -moz-transition: all 0.28s ease;
    -o-transition: all 0.28s ease;
    -ms-transition: all 0.28s ease;
  }
  .l_header .m_search .input {
    border-radius: 32px;
    -webkit-border-radius: 32px;
    margin-left: 16px;
    padding-left: 16px;
  }
  .l_header.z_search-open .m_search {
    width: 100%;
  }
  .l_header.z_search-open .m_search .input {
    width: calc(100% - 120px);
  }
}
ul.m-pc >li>a {
  color: inherit;
  border-bottom: 2px solid transparent;
}
ul.m-pc >li>a:active,
ul.m-pc >li>a.active {
  border-bottom: 2px solid #3dd9b6;
}
ul.m-pc li:hover >ul.list-v,
ul.list-v li:hover >ul.list-v {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
ul.nav-list-h {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  align-items: stretch;
}
ul.nav-list-h>li {
  position: relative;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  height: 100%;
  line-height: 2.4;
  border-radius: 4px;
  -webkit-border-radius: 4px;
}
ul.nav-list-h>li >a {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  font-weight: 600;
}
ul.list-v {
  z-index: 1;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  position: absolute;
  background: var(--color-card);
  box-shadow: 0 2px 4px 0px rgba(0,0,0,0.08), 0 4px 8px 0px rgba(0,0,0,0.08), 0 8px 16px 0px rgba(0,0,0,0.08);
  -webkit-box-shadow: 0 2px 4px 0px rgba(0,0,0,0.08), 0 4px 8px 0px rgba(0,0,0,0.08), 0 8px 16px 0px rgba(0,0,0,0.08);
  margin-top: -6px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  padding: 8px 0;
}
ul.list-v.show {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
ul.list-v hr {
  margin-top: 8px;
  margin-bottom: 8px;
}
ul.list-v >li {
  white-space: nowrap;
  word-break: keep-all;
}
ul.list-v >li.header {
  font-size: 0.78125rem;
  font-weight: bold;
  line-height: 2em;
  color: var(--color-meta);
  margin: 8px 16px 4px;
}
ul.list-v >li.header i {
  margin-right: 8px;
}
ul.list-v >li ul {
  margin-left: 0;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  margin-top: -40px;
}
ul.list-v .aplayer-container {
  min-height: 64px;
  padding: 6px 16px;
}
ul.list-v >li>a {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  color: var(--color-list);
  font-size: 0.875rem;
  font-weight: bold;
  line-height: 36px;
  padding: 0 20px 0 16px;
  text-overflow: ellipsis;
  margin: 0 4px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
}
@media screen and (max-width: 1024px) {
  ul.list-v >li>a {
    line-height: 40px;
  }
}
ul.list-v >li>a >i {
  margin-right: 8px;
}
ul.list-v >li>a:active,
ul.list-v >li>a.active {
  color: var(--color-list-hl);
}
ul.list-v >li>a:hover {
  color: var(--color-list-hl);
  background: var(--color-site-bg);
}
.l_header .menu >ul>li>a {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  padding: 0 8px;
}
.l_header .menu >ul>li>a >i {
  margin-right: 4px;
}
.l_header ul.nav-list-h>li {
  color: var(--color-list);
  line-height: 64px;
}
.l_header ul.nav-list-h>li >a {
  max-height: 64px;
  overflow: hidden;
  color: inherit;
}
.l_header ul.nav-list-h>li >a:active,
.l_header ul.nav-list-h>li >a.active {
  color: #3dd9b6;
}
.l_header ul.nav-list-h>li:hover>a {
  color: var(--color-list-hl);
}
.l_header ul.nav-list-h>li i.music {
  animation: rotate-effect 1.5s linear infinite;
  -webkit-animation: rotate-effect 1.5s linear infinite;
  -khtml-animation: rotate-effect 1.5s linear infinite;
  -moz-animation: rotate-effect 1.5s linear infinite;
  -o-animation: rotate-effect 1.5s linear infinite;
  -ms-animation: rotate-effect 1.5s linear infinite;
}
@-moz-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@-webkit-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@-o-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
.menu-phone li ul.list-v {
  right: calc(100% - 0.5 * 16px);
}
.menu-phone li ul.list-v ul {
  right: calc(100% - 0.5 * 16px);
}
#wrapper {
  max-width: 1080px;
  margin: auto;
}
@media screen and (min-width: 2048px) {
  #wrapper {
    max-width: 55vw;
  }
}
#wrapper .menu {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1 1;
  -ms-flex: 1 1;
  flex: 1 1;
  margin: 0 16px 0 0;
}
#wrapper .menu .list-v ul {
  left: calc(100% - 0.5 * 16px);
}
.menu-phone {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  margin-top: 16px;
  right: 8px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.menu-phone ul {
  right: calc(100% - 0.5 * 16px);
}
@media screen and (max-width: 500px) {
  .menu-phone {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: block;
  }
}
.l_header {
  max-width: 65vw;
  left: calc((100% - 65vw) * 0.5);
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
}
@media screen and (max-width: 2048px) {
  .l_header {
    max-width: 1112px;
    left: calc((100% - 1112px) * 0.5);
  }
}
@media screen and (max-width: 1112px) {
  .l_header {
    left: 0;
    border-radius: 0;
    -webkit-border-radius: 0;
    max-width: 100%;
  }
}
@media screen and (max-width: 500px) {
  .l_header .container {
    margin-left: 0;
    margin-right: 0;
  }
  .l_header #wrapper .nav-main .title {
    padding-left: 16px;
    padding-right: 16px;
  }
  .l_header #wrapper .nav-sub {
    width: 100%;
  }
  .l_header #wrapper .nav-sub .title {
    overflow-y: scroll;
    margin-top: 2px;
    padding: 8px 16px;
  }
  .l_header #wrapper .switcher {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: -ms-flexbox /* TWEENER - IE 10 */;
    display: -webkit-flex /* NEW - Chrome */;
    display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
    display: flex;
    margin-right: 8px;
  }
  .l_header .menu {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: none;
  }
}
@media screen and (max-width: 500px) {
  .list-v li {
    max-width: 270px;
  }
}
#u-search {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  padding: 60px 20px;
  z-index: 1001;
}
@media screen and (max-width: 680px) {
  #u-search {
    padding: 0px;
  }
}
@media screen and (prefers-color-scheme: dark) and (max-width: 500px) {
  .l_header .m_search {
    background: var(--color-site-bg) !important;
  }
}

  </style>
  <link rel="stylesheet" href="/css/style.css" media="print" onload="this.media='all';this.onload=null">
  <noscript><link rel="stylesheet" href="/css/style.css"></noscript>
    <script>
      let userColorScheme=localStorage.getItem("color-scheme")
      if(userColorScheme){
        document.documentElement.setAttribute("color-scheme", userColorScheme);
      }
    </script>
  
<script>
if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode))
    document.write(
	'<style>'+
		'html{'+
			'overflow-x: hidden !important;'+
			'overflow-y: hidden !important;'+
		'}'+
		'.kill-ie{'+
			'text-align:center;'+
			'height: 100%;'+
			'margin-top: 15%;'+
			'margin-bottom: 5500%;'+
		'}'+
    '.kill-t{'+
      'font-size: 2rem;'+
    '}'+
    '.kill-c{'+
      'font-size: 1.2rem;'+
    '}'+
		'#l_header,#l_body{'+
			'display: none;'+
		'}'+
	'</style>'+
    '<div class="kill-ie">'+
        `<span class="kill-t"><b>抱歉，您的浏览器无法访问本站</b></span><br/>`+
        `<span class="kill-c">微软已经于2016年终止了对 Internet Explorer (IE) 10 及更早版本的支持，<br/>继续使用存在极大的安全隐患，请使用当代主流的浏览器进行访问。</span><br/>`+
        `<a target="_blank" rel="noopener" href="https://blogs.windows.com/windowsexperience/2021/05/19/the-future-of-internet-explorer-on-windows-10-is-in-microsoft-edge/"><strong>了解详情 ></strong></a>`+
    '</div>');
</script>


<noscript>
	<style>
		html{
			overflow-x: hidden !important;
			overflow-y: hidden !important;
		}
		.kill-noscript{
			text-align:center;
			height: 100%;
			margin-top: 15%;
			margin-bottom: 5500%;
		}
    .kill-t{
      font-size: 2rem;
    }
    .kill-c{
      font-size: 1.2rem;
    }
		#l_header,#l_body{
			display: none;
		}
	</style>
    <div class="kill-noscript">
        <span class="kill-t"><b>抱歉，您的浏览器无法访问本站</b></span><br/>
        <span class="kill-c">本页面需要浏览器支持（启用）JavaScript</span><br/>
        <a target="_blank" rel="noopener" href="https://www.baidu.com/s?wd=启用JavaScript"><strong>了解详情 ></strong></a>
    </div>
</noscript>


  <script>
  /************这个文件存放不需要重载的全局变量和全局函数*********/
  window.volantis = {}; // volantis 全局变量
  volantis.debug = "false"; // 调试模式
  volantis.dom = {}; // 页面Dom see: /source/js/app.js etc.

  volantis.GLOBAL_CONFIG ={
    debug: false,
    cdn: {"js":{"app":"/js/app.js","parallax":"/js/plugins/parallax.js","rightMenu":"/js/plugins/rightMenu.js","rightMenus":"/js/plugins/rightMenus.js","sites":"/js/plugins/tags/sites.js","friends":"/js/plugins/tags/friends.js","contributors":"/js/plugins/tags/contributors.js","search":"/js/search/hexo.js"},"css":{"style":"/css/style.css"}},
    default: {"avatar":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/avatar/round/3442075.svg","link":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/link/8f277b4ee0ecd.svg","cover":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/cover/76b86c0226ffd.svg","image":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/image/2659360.svg"},
    lastupdate: new Date(1684637460606),
    sidebar: {
      for_page: ["blogger","category","tagcloud","webinfo"],
      for_post: ["blogger","toc","category","tagcloud"],
      webinfo: {
        lastupd: {
          enable: true,
          friendlyShow: true
        },
        runtime: {
          data: "2020/01/01",
          unit: "天"
        }
      }
    },
    plugins: {
      message: {"enable":true,"css":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/izitoast/dist/css/iziToast.min.css","js":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/izitoast/dist/js/iziToast.min.js","icon":{"default":"fa-solid fa-info-circle light-blue","quection":"fa-solid fa-question-circle light-blue"},"time":{"default":5000,"quection":20000},"position":"topRight","transitionIn":"bounceInLeft","transitionOut":"fadeOutRight","titleColor":"var(--color-text)","messageColor":"var(--color-text)","backgroundColor":"var(--color-card)","zindex":2147483647,"copyright":{"enable":true,"title":"知识共享许可协议","message":"请遵守 CC BY-NC-SA 4.0 协议。","icon":"far fa-copyright light-blue"},"aplayer":{"enable":true,"play":"fa-solid fa-play","pause":"fa-solid fa-pause"},"rightmenu":{"enable":true,"notice":true}},
      fancybox: {"css":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fancyapps/ui/dist/fancybox.css","js":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fancyapps/ui/dist/fancybox.umd.js"},
      
      
      
      rightmenus: {"enable":true,"order":["plugins.navigation","hr","plugins.inputBox","plugins.seletctText","plugins.elementCheck","plugins.elementImage","menus.link","hr","menus.darkMode","plugins.articlePage","music"],"options":{"iconPrefix":"fa-solid","articleShowLink":true,"musicAlwaysShow":true},"plugins":{"navigation":[{"id":"left","name":"转到上一页","icon":"fa-solid fa-arrow-left","event":"history.back()","group":"navigation"},{"id":"right","name":"转到下一页","icon":"fa-solid fa-arrow-right","event":"history.forward()","group":"navigation"},{"id":"redo","name":"刷新当前页面","icon":"fa-solid fa-redo","event":"window.location.reload()","group":"navigation"},{"id":"up","name":"回到顶部","icon":"fa-solid fa-arrow-up","event":"VolantisApp.scrolltoElement(volantis.dom.bodyAnchor)","group":"navigation"}],"inputBox":[{"id":"copyPaste","name":"粘贴文本","icon":"fa-solid fa-paste","event":"copyPaste","group":"inputBox"},{"id":"copyAll","name":"全选文本","icon":"fa-solid fa-object-ungroup","event":"copyAll","group":"inputBox"},{"id":"copyCut","name":"剪切文本","icon":"fa-solid fa-cut","event":"copyCut","group":"inputBox"}],"seletctText":[{"id":"copyText","name":"复制文本","icon":"fa-solid fa-copy","event":"copyText","group":"seletctText"},{"id":"searchWord","name":"站内搜索","icon":"fa-solid fa-search","event":"OpenSearch(__text__)","group":"seletctText"},{"id":"bingSearch","name":"必应搜索","icon":"fa-solid fa-search","event":"window.open(`https://cn.bing.com/search?q=${__text__}`)","group":"seletctText"}],"elementCheck":[{"id":"openTab","name":"新标签页打开","icon":"fa-solid fa-external-link-square-alt","event":"window.open(__link__)","group":"elementCheck"},{"id":"copyLink","name":"复制链接地址","icon":"fa-solid fa-link","event":"copyLink","group":"elementCheck"}],"elementImage":[{"id":"copyImg","name":"复制图片","icon":"fa-solid fa-image","event":"copyImg","group":"elementImage"},{"id":"googleImg","name":"谷歌识图","icon":"fa-solid fa-images","event":"window.open(`https://www.google.com.hk/searchbyimage?image_url=${__link__}`)","group":"elementImage"}],"articlePage":[{"id":"printMode","name":"打印页面","icon":"fa-solid fa-print","event":"printMode","group":"articlePage"},{"id":"readMode","name":"阅读模式","icon":"fa-solid fa-book-open","event":"readMode","group":"articlePage"}]},"menus":{"link":[{"id":"help","name":"常见问题","icon":"fa-solid fa-question","link":"https://volantis.js.org/faqs/","group":"link"},{"id":"examples","name":"示例博客","icon":"fa-solid fa-rss","link":"https://volantis.js.org/examples/","group":"link"},{"id":"contributors","name":"加入社区","icon":"fa-solid fa-fan","link":"https://volantis.js.org/contributors/","group":"link"},"hr",{"id":"source_docs","name":"本站源码","icon":"fa-solid fa-code-branch","link":"https://github.com/volantis-x/volantis-docs/","group":"link"},{"id":"source_theme","name":"主题源码","icon":"fa-solid fa-code-branch","link":"https://github.com/volantis-x/hexo-theme-volantis/","group":"link"}],"darkMode":[{"id":"darkMode","name":"暗黑模式","icon":"fa-solid fa-moon","event":"volantis.dark.toggle()","group":"darkMode"}]}}
      
    }
  }

  /******************** volantis.EventListener ********************************/
  // 事件监听器 see: /source/js/app.js
  volantis.EventListener = {}
  // 这里存放pjax切换页面时将被移除的事件监听器
  volantis.EventListener.list = []
  //构造方法
  function volantisEventListener(type, f, ele) {
    this.type = type
    this.f = f
    this.ele = ele
  }
  // 移除事件监听器
  volantis.EventListener.remove = () => {
    volantis.EventListener.list.forEach(function (i) {
      i.ele.removeEventListener(i.type, i.f, false)
    })
    volantis.EventListener.list = []
  }
  /******************** volantis.dom.$ ********************************/
  // 注：这里没有选择器，也没有forEach一次只处理一个dom，这里重新封装主题常用的dom方法，返回的是dom对象，对象包含了以下方法，同时保留dom的原生API
  function volantisDom(ele) {
    if (!ele) ele = document.createElement("div")
    this.ele = ele;
    // ==============================================================
    this.ele.find = (c) => {
      let q = this.ele.querySelector(c)
      if (q)
        return new volantisDom(q)
    }
    // ==============================================================
    this.ele.hasClass = (c) => {
      return this.ele.className.match(new RegExp('(\\s|^)' + c + '(\\s|$)'));
    }
    this.ele.addClass = (c) => {
      this.ele.classList.add(c);
      return this.ele
    }
    this.ele.removeClass = (c) => {
      this.ele.classList.remove(c);
      return this.ele
    }
    this.ele.toggleClass = (c) => {
      if (this.ele.hasClass(c)) {
        this.ele.removeClass(c)
      } else {
        this.ele.addClass(c)
      }
      return this.ele
    }
    // ==============================================================
    // 参数 r 为 true 表示pjax切换页面时事件监听器将被移除，false不移除
    this.ele.on = (c, f, r = 1) => {
      this.ele.addEventListener(c, f, false)
      if (r) {
        volantis.EventListener.list.push(new volantisEventListener(c, f, this.ele))
      }
      return this.ele
    }
    this.ele.click = (f, r) => {
      this.ele.on("click", f, r)
      return this.ele
    }
    this.ele.scroll = (f, r) => {
      this.ele.on("scroll", f, r)
      return this.ele
    }
    // ==============================================================
    this.ele.html = (c) => {
      // if(c=== undefined){
      //   return this.ele.innerHTML
      // }else{
      this.ele.innerHTML = c
      return this.ele
      // }
    }
    // ==============================================================
    this.ele.hide = (c) => {
      this.ele.style.display = "none"
      return this.ele
    }
    this.ele.show = (c) => {
      this.ele.style.display = "block"
      return this.ele
    }
    // ==============================================================
    return this.ele
  }
  volantis.dom.$ = (ele) => {
    return !!ele ? new volantisDom(ele) : null;
  }
  /******************** RunItem ********************************/
  function RunItem() {
    this.list = []; // 存放回调函数
    this.start = () => {
      for (var i = 0; i < this.list.length; i++) {
        this.list[i].run();
      }
    };
    this.push = (fn, name, setRequestAnimationFrame = true) => {
      let myfn = fn
      if (setRequestAnimationFrame) {
        myfn = ()=>{
          volantis.requestAnimationFrame(fn)
        }
      }
      var f = new Item(myfn, name);
      this.list.push(f);
    };
    this.remove = (name) =>{
      for (let index = 0; index < this.list.length; index++) {
        const e = this.list[index];
        if (e.name == name) {
          this.list.splice(index,1);
        }
      }
    }
    // 构造一个可以run的对象
    function Item(fn, name) {
      // 函数名称
      this.name = name || fn.name;
      // run方法
      this.run = () => {
        try {
          fn()
        } catch (error) {
          console.log(error);
        }
      };
    }
  }
  /******************** Pjax ********************************/
  // /layout/_plugins/pjax/index.ejs
  // volantis.pjax.send(callBack[,"callBackName"]) 传入pjax:send回调函数
  // volantis.pjax.push(callBack[,"callBackName"]) 传入pjax:complete回调函数
  // volantis.pjax.error(callBack[,"callBackName"]) 传入pjax:error回调函数
  volantis.pjax = {};
  volantis.pjax.method = {
    complete: new RunItem(),
    error: new RunItem(),
    send: new RunItem(),
  };
  volantis.pjax = Object.assign(volantis.pjax, {
    push: volantis.pjax.method.complete.push,
    error: volantis.pjax.method.error.push,
    send: volantis.pjax.method.send.push,
  });
  /******************** RightMenu ********************************/
  // volantis.rightmenu.handle(callBack[,"callBackName"]) 外部菜单项控制
  // 可在 volantis.mouseEvent 处获取右键事件
  volantis.rightmenu = {};
  volantis.rightmenu.method = {
    handle: new RunItem(),
  }
  volantis.rightmenu = Object.assign(volantis.rightmenu, {
    handle: volantis.rightmenu.method.handle.push,
  });
  /********************  Dark Mode  ********************************/
  // /layout/_partial/scripts/darkmode.ejs
  // volantis.dark.mode 当前模式 dark or light
  // volantis.dark.toggle() 暗黑模式触发器
  // volantis.dark.push(callBack[,"callBackName"]) 传入触发器回调函数
  volantis.dark = {};
  volantis.dark.method = {
    toggle: new RunItem(),
  };
  volantis.dark = Object.assign(volantis.dark, {
    push: volantis.dark.method.toggle.push,
  });
  /********************  Message  ********************************/
  // VolantisApp.message
  /********************  isMobile  ********************************/
  // /source/js/app.js
  // volantis.isMobile
  // volantis.isMobileOld
  /********************脚本动态加载函数********************************/
  // volantis.js(src, cb)  cb 可以传入onload回调函数 或者 JSON对象 例如: volantis.js("src", ()=>{}) 或 volantis.js("src", {defer:true,onload:()=>{}})
  // volantis.css(src)

  // 返回Promise对象，如下方法同步加载资源，这利于处理文件资源之间的依赖关系，例如：APlayer 需要在 MetingJS 之前加载
  // (async () => {
  //     await volantis.js("...theme.plugins.aplayer.js.aplayer...")
  //     await volantis.js("...theme.plugins.aplayer.js.meting...")
  // })();

  // 已经加入了setTimeout
  volantis.js = (src, cb) => {
    return new Promise(resolve => {
      setTimeout(function () {
        var HEAD = document.getElementsByTagName("head")[0] || document.documentElement;
        var script = document.createElement("script");
        script.setAttribute("type", "text/javascript");
        if (cb) {
          if (JSON.stringify(cb)) {
            for (let p in cb) {
              if (p == "onload") {
                script[p] = () => {
                  cb[p]()
                  resolve()
                }
              } else {
                script[p] = cb[p]
                script.onload = resolve
              }
            }
          } else {
            script.onload = () => {
              cb()
              resolve()
            };
          }
        } else {
          script.onload = resolve
        }
        script.setAttribute("src", src);
        HEAD.appendChild(script);
      });
    });
  }
  volantis.css = (src) => {
    return new Promise(resolve => {
      setTimeout(function () {
        var link = document.createElement('link');
        link.rel = "stylesheet";
        link.href = src;
        link.onload = resolve;
        document.getElementsByTagName("head")[0].appendChild(link);
      });
    });
  }
  /********************按需加载的插件********************************/
  // volantis.import.jQuery().then(()=>{})
  volantis.import = {
    jQuery: () => {
      if (typeof jQuery == "undefined") {
        return volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/jquery/dist/jquery.min.js")
      } else {
        return new Promise(resolve => {
          resolve()
        });
      }
    }
  }
  /********************** requestAnimationFrame ********************************/
  // 1、requestAnimationFrame 会把每一帧中的所有 DOM 操作集中起来，在一次重绘或回流中就完成，并且重绘或回流的时间间隔紧紧跟随浏览器的刷新频率，一般来说，这个频率为每秒60帧。
  // 2、在隐藏或不可见的元素中，requestAnimationFrame 将不会进行重绘或回流，这当然就意味着更少的的 cpu，gpu 和内存使用量。
  volantis.requestAnimationFrame = (fn)=>{
    if (!window.requestAnimationFrame) {
      window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame;
    }
    window.requestAnimationFrame(fn)
  }
  /************************ layoutHelper *****************************************/
  volantis.layoutHelper = (helper, html, opt)=>{
    opt = Object.assign({clean:false, pjax:true}, opt)
    function myhelper(helper, html, clean) {
      volantis.tempDiv = document.createElement("div");
      volantis.tempDiv.innerHTML = html;
      let layoutHelper = document.querySelector("#layoutHelper-"+helper)
      if (layoutHelper) {
        if (clean) {
          layoutHelper.innerHTML = ""
        }
        layoutHelper.append(volantis.tempDiv);
      }
    }
    myhelper(helper, html, opt.clean)
    if (opt.pjax) {
      volantis.pjax.push(()=>{
        myhelper(helper, html, opt.clean)
      },"layoutHelper-"+helper)
    }
  }
  /****************************** 滚动事件处理 ****************************************/
  volantis.scroll = {
    engine: new RunItem(),
    unengine: new RunItem(),
  };
  volantis.scroll = Object.assign(volantis.scroll, {
    push: volantis.scroll.engine.push,
  });
  // 滚动条距离顶部的距离
  volantis.scroll.getScrollTop = () =>{
    let scrollPos;
    if (window.pageYOffset) {
      scrollPos = window.pageYOffset;
    } else if (document.compatMode && document.compatMode != 'BackCompat') {
      scrollPos = document.documentElement.scrollTop;
    } else if (document.body) {
      scrollPos = document.body.scrollTop;
    }
    return scrollPos;
  }
  // 使用 requestAnimationFrame 处理滚动事件
  // `volantis.scroll.del` 中存储了一个数值, 该数值检测一定时间间隔内滚动条滚动的位移, 数值的检测频率是浏览器的刷新频率. 数值为正数时, 表示向下滚动. 数值为负数时, 表示向上滚动.
  volantis.scroll.handleScrollEvents = () => {
    volantis.scroll.lastScrollTop = volantis.scroll.getScrollTop()
    function loop() {
      const scrollTop = volantis.scroll.getScrollTop();
      if (volantis.scroll.lastScrollTop !== scrollTop) {
        volantis.scroll.del = scrollTop - volantis.scroll.lastScrollTop;
        volantis.scroll.lastScrollTop = scrollTop;
        // if (volantis.scroll.del > 0) {
        //   console.log("向下滚动");
        // } else {
        //   console.log("向上滚动");
        // }
        // 注销过期的unengine未滚动事件
        volantis.scroll.unengine.list=[]
        volantis.scroll.engine.start();
      }else{
        volantis.scroll.unengine.start();
      }
      volantis.requestAnimationFrame(loop)
    }
    volantis.requestAnimationFrame(loop)
  }
  volantis.scroll.handleScrollEvents()
  // 触发页面滚动至目标元素位置
  volantis.scroll.to = (ele, option = {}) =>{
    // 默认配置
    opt = {
      top: ele.getBoundingClientRect().top + document.documentElement.scrollTop,
      behavior: "smooth"
    }
    // 定义配置
    if ("top" in option) {
      opt.top = option.top
    }
    if ("behavior" in option) {
      opt.behavior = option.behavior
    }
    if ("addTop" in option) {
      opt.top += option.addTop
    }
    if (!("observerDic" in option)) {
      option.observerDic = 100
    }
    // 滚动
    window.scrollTo(opt);
    // 监视器
    // 监视并矫正元素滚动到指定位置
    // 用于处理 lazyload 引起的 cls 导致的定位失败问题
    // option.observer = false
    if (option.observer) {
      setTimeout(()=>{
        volantis.scroll.unengine.push(()=>{
          let me = ele.getBoundingClientRect().top
          if(!(me >= -option.observerDic && me <= option.observerDic)){
            volantis.scroll.to(ele, option)
          }
          volantis.scroll.unengine.remove("unengineObserver")
        },"unengineObserver")
      },1000)
    }
  }
  /********************** Content Visibility ********************************/
  // 见 source/css/first.styl 如果遇到任何问题 删除 .post-story 即可
  // 一个元素被声明 content-visibility 属性后 如果元素不在 viewport 中 浏览器不会计算其后代元素样式和属性 从而节省 Style & Layout 耗时
  // content-visibility 的副作用: 锚点失效 等等(实验初期 暂不明确), 使用此方法清除样式
  volantis.cleanContentVisibility = ()=>{
    if (document.querySelector(".post-story")) {
      console.log("cleanContentVisibility");
      document.querySelectorAll(".post-story").forEach(e=>{
        e.classList.remove("post-story")
      })
    }
  }
  /******************************************************************************/
  /******************************************************************************/
  /******************************************************************************/
  //图像加载出错时的处理
  function errorImgAvatar(img) {
    img.src = "https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/avatar/round/3442075.svg";
    img.onerror = null;
  }
  function errorImgCover(img) {
    img.src = "https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/cover/76b86c0226ffd.svg";
    img.onerror = null;
  }
  /******************************************************************************/
</script>

  <!-- import head_end begin -->
  <!-- import head_end end -->
  <!-- Custom Files headEnd begin-->
  
  <!-- Custom Files headEnd end-->
</head>
  <body itemscope itemtype="http://schema.org/WebPage">
    <!-- import body_begin begin-->
    <!-- import body_begin end-->
    <!-- Custom Files bodyBegin begin-->
    
    <!-- Custom Files bodyBegin end-->
    <header itemscope itemtype="http://schema.org/WPHeader" id="l_header" class="l_header auto shadow floatable blur show" style='opacity: 0' >
  <div class='container'>
  <div id='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone' id="pjax-header-nav-list">
        <li><a id="s-comment" class="fa-solid fa-comments fa-fw" target="_self"  href="/" onclick="return false;" title="comment"></a></li>
        
          <li><a id="s-toc" class="s-toc fa-solid fa-list fa-fw" target="_self"  href="/" onclick="return false;" title="toc"></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
            <img no-lazy class='logo' src='https://gcore.jsdelivr.net/gh/lollipopnougat/picbed/bloglogo.png'/>
          
          
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/" title="博客"
                  
                  
                  
                    active-action="action-home"
                  >
                  <i class='fa-solid fa-blog fa-fw'></i>博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/" title="分类"
                  
                  
                  
                    active-action="action-categories"
                  >
                  <i class='fa-solid fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/tags/" title="标签"
                  
                  
                  
                    active-action="action-tags"
                  >
                  <i class='fa-solid fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/archives/" title="归档"
                  
                  
                  
                    active-action="action-archives"
                  >
                  <i class='fa-solid fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/friends/" title="友链"
                  
                  
                  
                    active-action="action-friends"
                  >
                  <i class='fa-solid fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/about/" title="关于"
                  
                  
                  
                    active-action="action-about"
                  >
                  <i class='fa-solid fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fas fa-moon fa-fw'></i>暗黑模式
                </a>
              <li>
            
          
          
				</ul>
			</div>
      
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fa-solid fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>
      

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fa-solid fa-search fa-fw" target="_self" href="/" onclick="return false;" title="search"></a></li>
				
				<li>
          <a class="s-menu fa-solid fa-bars fa-fw" target="_self" href="/" onclick="return false;" title="menu"></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/" title="博客"
                  
                  
                  
                    active-action="action-home"
                  >
                  <i class='fa-solid fa-blog fa-fw'></i>博客
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/categories/" title="分类"
                  
                  
                  
                    active-action="action-categories"
                  >
                  <i class='fa-solid fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/tags/" title="标签"
                  
                  
                  
                    active-action="action-tags"
                  >
                  <i class='fa-solid fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/archives/" title="归档"
                  
                  
                  
                    active-action="action-archives"
                  >
                  <i class='fa-solid fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/friends/" title="友链"
                  
                  
                  
                    active-action="action-friends"
                  >
                  <i class='fa-solid fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/about/" title="关于"
                  
                  
                  
                    active-action="action-about"
                  >
                  <i class='fa-solid fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fas fa-moon fa-fw'></i>暗黑模式
                </a>
              <li>
            
          
            
          </ul>
        </li>
			</ul>

      <!-- Custom Files header begin -->
      
      <!-- Custom Files header end -->
		</div>
	</div>
  </div>
</header>

    <div id="l_body">
      <div id="l_cover">
  
    
      <!-- see: /layout/_partial/scripts/_ctrl/coverCtrl.ejs -->
      <div id="none" class='cover-wrapper post search' style="display: none;">
        
  <div class='cover-bg lazyload placeholder' data-bg="https://gcore.jsdelivr.net/gh/MHG-LAB/cron@gh-pages/bing/bing.jpg"></div>

<div class='cover-body'>
  <div class='top'>
    
    
      <p class="title">lnp's blog</p>
    
    
      <p class="subtitle">没什么存在感的博客</p>
    
  </div>
  <div class='bottom'>
    
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <input type="text" class="input u-search-input" placeholder="搜索博客文章" />
          <i class="icon fa-solid fa-search fa-fw"></i>
        </form>
      </div>
    
    <div class='menu navigation'>
      <div class='list-h'>
        
          
            <a href="/"
              
              
              active-action="action-home">
              <i class='fa-solid fa-file-alt fa-fw'></i><p>博客文章</p>
            </a>
          
            <a href="/projects/"
              
              
              active-action="action-projects">
              <i class='fa-solid fa-code-branch fa-fw'></i><p>我的项目</p>
            </a>
          
            <a target="_blank" rel="noopener" href="https://github.com/lollipopnougat?tab=repositories/"
              
              
              active-action="action-https:githubcomlollipopnougat?tab=repositories">
              <i class='fa-brands fa-github fa-fw'></i><p>Github仓库</p>
            </a>
          
            <a href="/friends/"
              
              
              active-action="action-friends">
              <i class='fa-solid fa-handshake fa-fw'></i><p>朋友</p>
            </a>
          
            <a href="/archives/"
              
              
              active-action="action-archives">
              <i class='fa-solid fa-archive fa-fw'></i><p>归档</p>
            </a>
          
            <a href="/atom.xml"
              
              
              active-action="action-atomxml">
              <i class='fa-solid fa-rss fa-fw'></i><p>RSS订阅</p>
            </a>
          
        
      </div>
    </div>
  </div>
</div>

        <div id="scroll-down" style="display: none;"><i class="fa fa-chevron-down scroll-down-effects"></i></div>
      </div>
    
  
</div>

      <div id="safearea">
        <div class="body-wrapper">
          
<div id="l_main" class=''>
  <article itemscope itemtype="http://schema.org/Article" class="article post white-box reveal md shadow floatable blur article-type-post" id="post" itemscope itemprop="blogPost">
  <link itemprop="mainEntityOfPage" href="https://www.lollipopnougat.top/2019/07/29/PowerShell入门指南(3)/">
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="LNP">
  </span>
  <span hidden itemprop="post" itemscope itemtype="http://schema.org/Post">
    <meta itemprop="name" content="LNP">
    <meta itemprop="description" content="">
  </span>
  


  
    <div class='headimg-div'>
      <a class='headimg-a'>
        <img itemprop="image" class='headimg' src='https://gcore.jsdelivr.net/gh/lollipopnougat/website-calculator/img/powershell.png'/>
      </a>
    </div>
  
  <div class="article-meta" id="top">
    
    
    
      <h1 class="title" itemprop="name headline">
        PowerShell入门指南(3)
      </h1>
      <div class='new-meta-box'>
        
          
            
<div class='new-meta-item author' itemprop="author" itemscope itemtype="http://schema.org/Person">
  <a itemprop="url" class='author' target="_blank" href="https://github.com/lollipopnougat/" rel="nofollow noopener">
    <img itemprop="image" src="https://www.lollipopnougat.top/picbed/33110314.png" class="lazyload" data-srcset="https://www.lollipopnougat.top/picbed/33110314.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
    <p itemprop="name">lollipopnougat</p>
  </a>
</div>

          
        
          
            
  <div class='new-meta-item category'>
    <i class="fa-solid fa-folder-open fa-fw" aria-hidden="true"></i>
    <a class="category-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a><span class="sep"></span><a class="category-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/PowerShell/">PowerShell</a>
    
      <span hidden itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url"><span itemprop="name">编程语言</span></a>
      </span>
    
      <span hidden itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/PowerShell/" itemprop="url"><span itemprop="name">PowerShell</span></a>
      </span>
    
  </div>


          
        
          
            <div class="new-meta-item date" itemprop="dateCreated datePublished" datetime="2019-07-29T09:56:12+08:00">
  <a class='notlink'>
    <i class="fa-solid fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2019年7月29日</p>
  </a>
</div>

          
        
          
            

          
        
          
            



          
        
        <!-- Custom Files topMeta begin-->
        
        <!-- Custom Files topMeta end-->
      </div>
    
  </div>


  <div id="layoutHelper-page-plugins"></div>
  <div id="post-body" itemprop="articleBody">
    <h3 id="PowerShell入门指南-三-·一门新的编程语言"><a href="#PowerShell入门指南-三-·一门新的编程语言" class="headerlink" title="PowerShell入门指南(三)·一门新的编程语言"></a>PowerShell入门指南(三)·一门新的编程语言</h3><hr>
<h4 id="作为独立的编程语言"><a href="#作为独立的编程语言" class="headerlink" title="作为独立的编程语言"></a>作为独立的编程语言</h4><p>作为一门独立的语言来说，<code>PowerShell</code> 是非常地Powerful，我们先来了解一下它的特点:</p>
<span id="more"></span>

<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li><h4 id="破天荒的方便"><a href="#破天荒的方便" class="headerlink" title="破天荒的方便"></a>破天荒的方便</h4><p>诸如存储计算中 <code>GB</code>， <code>MB</code>， <code>KB</code> 单位等；数组声明中的 <code>1..n</code> 和下标为 <code>-1</code> 的处理；还有所见即所得，通俗易懂的<strong>动词</strong>+<strong>名词</strong>结构的Cmdlet(PowerShell命令的称呼)。<br>还有自带的文档支持也很是丰富，只要熟练掌握 <code>Get-Help</code> 命令，其他命令的用法均可通过 <code>Get-Help</code> 查到</p>
</li>
<li><h4 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h4><p>良心啊，这个语言竟然是面向对象的<br>与面向过程相比，面向对象更方便更容易描述现实世界，也算赶上了时髦。</p>
</li>
<li><h4 id="依托-NET"><a href="#依托-NET" class="headerlink" title="依托 .NET"></a>依托 .NET</h4><p>正所谓大树下面好乘凉，<code>PowerShell</code> 绑上 <code>.NET</code> 这个大款了，借助 <code>.NET</code> 平台强大的类库，几乎让一切都成为可能。</p>
</li>
<li><h4 id="强大的兼容性"><a href="#强大的兼容性" class="headerlink" title="强大的兼容性"></a>强大的兼容性</h4><p>完全兼容 <code>Windows</code> 平台上其它调用，如可执行文件(exe)，批处理bat/cmd和VBscript等, 在 <code>Linux</code> 和 <code>macOS</code> 上也能很好地工作。</p>
</li>
<li><h4 id="基于平台的可扩展性"><a href="#基于平台的可扩展性" class="headerlink" title="基于平台的可扩展性"></a>基于平台的可扩展性</h4><p>微软有个优点，与应用相比，它更喜欢做平台。<code>PowerShell</code> 早已变成一个平台，在 <code>PowerShell</code> 刚发布的第二年，微软的 System Center Operations Manager 和 SharePoint 就提供了针对该平台的组件，后来的活动目录，Hyper-V，Windows Azure，Office 365就更不用说了。除了微软，亚马逊的云平台管理，Dell的out-of-hand 管理，也都提供了基于 <code>PowerShell</code> 的管理组件。<code>PowerShell</code> 俨然变成了一个标准，变成了一个规范。</p>
</li>
</ul>
<hr>
<h3 id="使用Get-Help-快速入门"><a href="#使用Get-Help-快速入门" class="headerlink" title="使用Get-Help 快速入门"></a>使用<code>Get-Help</code> 快速入门</h3><p>下面用一个简单例子说明如何<code>Get-Help</code>，设想这样一个场景：<br>你想通过命令行查看所有进程，你第一个反应应该是用一个跟Process相关的命令来达到此目的，所以你可以会尝试执行：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Command</span> *<span class="keyword">Process</span></span><br><span class="line"><span class="comment">#结果</span></span><br><span class="line">CommandType     Name                   Version    Source</span><br><span class="line">-----------     ----                   -------    ------</span><br><span class="line">Cmdlet          <span class="built_in">Debug-Process</span>          <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          <span class="built_in">Enter-PSHostProcess</span>    <span class="number">3.0</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Core</span><br><span class="line">Cmdlet          <span class="built_in">Exit-PSHostProcess</span>     <span class="number">3.0</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Core</span><br><span class="line">Cmdlet          <span class="built_in">Get-Process</span>            <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          <span class="built_in">Start-Process</span>          <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          <span class="built_in">Stop-Process</span>           <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          <span class="built_in">Wait-Process</span>           <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Management</span><br></pre></td></tr></table></figure>

<p>得知处理进程的命令有这些<br>然后再用 <code>Get-Help Get-Process -full</code> 就能得到 <code>Get-Process</code> 的详细用法以及使用范例</p>
<h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p><code>PowerShell</code> 是一个强类型(变量一旦定义，其本身类型不可改变就是强类型，反之就是弱类型)的动态脚本语言，支持面向对象，支持调用系统API和 <code>.NET</code> 库。<br>受到了 <code>Python</code>, <code>Ksh</code>, <code>Perl</code>, <code>C#</code>, <code>CL</code>, <code>DCL</code>, <code>SQL</code>, <code>Tcl</code>, <code>Tk</code>, <code>Chef</code>, <code>Puppet</code> 等语言的影响，结合了以上语言的部分特性。</p>
<p><code>PowerShell</code> 代码的外观和操作方式与C#的相似程度最高，不过也有它自己的特色。</p>
<h4 id="关于空白字符"><a href="#关于空白字符" class="headerlink" title="关于空白字符"></a>关于空白字符</h4><p>与 <code>Python</code> 等语言不同，**<code>PowerShell</code> 的解释器不会考虑代码中的空格或制表符**(这些字符统称空白字符)。这样一来，格式化代码就有很大的自由度，但是遵循某些规则将有助于提高代码的可读性。</p>
<h4 id="代码块和代码基本结构"><a href="#代码块和代码基本结构" class="headerlink" title="代码块和代码基本结构"></a>代码块和代码基本结构</h4><p><code>PowerShell</code> 代码由一系列语句构成，每条语句可以使用一个分号结束，当然也可以不写。<strong>按照习惯是不写分号的，因此要用换行来区分不同的语句，如果必须写到一行中，那就在每一句后加个分号</strong>。</p>
<p>和C语系的大多数语言类似，<code>PowerShell</code> 是一种块结构的语言，这些块用 <code>&#123;</code> 和 <code>&#125;</code> 来界定，代码块可以包含任意多条语句，或者不包含任何语句，下面的示例还使用了缩进格式，这样能大大提高可读性，实际上编译器会自带缩进代码。一般情况下，每个代码块都有自己的缩进级别，代码块之间还能嵌套。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">&lt;#代码行1#&gt;</span></span><br><span class="line">    <span class="comment">&lt;#代码行2#&gt;</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">&lt;#代码行3#&gt;</span></span><br><span class="line">        <span class="comment">&lt;#代码行4#&gt;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">&lt;#代码行5#&gt;</span>;<span class="comment">&lt;#代码行6#&gt;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然 <code>PowerShell</code> 的缩进不是强制的。</p>
<p>在 <code>PowerShell</code> 代码中，另一种常见的语句是注释，注释并不是能执行的语句，而是对代码的描述说明性文本。当代码运行时，解释器会忽略这些内容。<br>代码最好有注释，特别是处理较复杂的工作时，注释可以为正在进行的操作添加提示，例如“这行代码要求用户输入一个字符”、“此段代码是 LNP 编写的”。<br><code>PowerShell</code> 有两种添加注释方法</p>
<ul>
<li>行注释:  <code>#</code></li>
<li>块注释:  <code>&lt;#</code> 和 <code>#&gt;</code></li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这是一行注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;#</span></span><br><span class="line"><span class="comment">这是注释块</span></span><br><span class="line"><span class="comment">123ABC</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">ls</span> <span class="comment">#列出当前目录下的文件和文件夹，是Get-ChildItem的别名</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#注意下面语句会产生错误</span></span><br><span class="line"><span class="comment">&lt;#块注释由&quot;#&gt;</span><span class="string">&quot;结尾#&gt;</span></span><br></pre></td></tr></table></figure>

<p>第一个 <code>#&gt;</code> 后面的部分会被认为是 <code>PowerShell</code> 代码，因此出现错误。</p>
<p>还有特别的注意一点，**<code>PowerShell</code> 代码是不区分大小写的**，因此只要拼写正确的命令(或变量)，而无需关心大小写即可执行，不过最好还是有一定规范。</p>
<hr>
<h3 id="PowerShell-脚本的基本结构"><a href="#PowerShell-脚本的基本结构" class="headerlink" title="PowerShell 脚本的基本结构"></a><code>PowerShell</code> 脚本的基本结构</h3><p><code>PowerShell</code> 像 <code>Python</code> 一样，允许使用控制台直接输入命令进行交互，也可以事先把代码写入一个文件再作为脚本运行。<br>一个 <code>PowerShell</code> 脚本仅仅是一个包含 <code>PowerShell</code> 代码的文本文件。如果这个文本文件执行， <code>PowerShell</code> 解释器会逐行解释并执行它的的语句。<code>PowerShell</code> 脚本有点像以前 <code>CMD</code> 控制台上的批处理文件。可以通过非常简单的文本编辑工具创建 <code>PowerShell</code> 脚本。</p>
<p>PowerShell脚本文件的扩展名是 <code>.ps1</code></p>
<hr>
<h3 id="执行策略限制"><a href="#执行策略限制" class="headerlink" title="执行策略限制"></a>执行策略限制</h3><p><code>PowerShell</code> 一般初始化情况下都会禁止脚本执行。脚本能否执行取决于PowerShell的执行策略。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> E:&gt; ./MyScript.ps1</span><br><span class="line"></span><br><span class="line">无法加载文件 E:MyScript.ps1，因为在此系统中禁止执行脚本。有关详细信息，请参阅 <span class="string">&quot;get-help about_signing&quot;</span>。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">15</span></span><br><span class="line">+ .MyScript.ps1 &lt; &lt;&lt;&lt;</span><br><span class="line">    + CategoryInfo          : NotSpecified: (:) [], PSSecurityException</span><br><span class="line">    + FullyQualifiedErrorId : RuntimeException</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>只有管理员才有权限更改这个策略。非管理员会报错。</strong></p>
<p>查看脚本执行策略，可以通过在 <code>PowerShell</code> 控制台直接输入:<br><code>Get-ExecutionPolicy</code><br><strong>更改脚本执行策略，可以管理员启动PowerShell，在控制台输入:</strong><br><code>Set-ExecutionPolicy &lt;策略&gt;</code><br>策略|解释<br>-|-<br>Unrestricted|权限最高，可以不受限制执行任何脚本。<br>Default|为Powershell默认的策略，即Restricted<br>Restricted|不允许任何脚本执行<br>AllSigned|所有脚本都必须经过签名才能在运行<br>RemoteSigned|本地脚本无限制，但是对来自网络的脚本必须经过签名</p>
<p>如果要使用脚本功能又要兼顾安全性，我们就选择RemoteSigned<br>即在以管理员身份允许的 <code>PowerShell</code> 输入<br><code>Set-ExecutionPolicy RemoteSigned</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">执行策略可以防止您执行不信任的脚本。更改执行策略可能会使您面临 about_Execution_Policies帮助主题中所述的安全风险。是否要更改执行策略?</span><br><span class="line">[Y] 是(Y)  [N] 否(N)  [S] 挂起(S)  [?] 帮助 (默认值为“Y”): y</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="运行-PowerShell-脚本"><a href="#运行-PowerShell-脚本" class="headerlink" title="运行 PowerShell 脚本"></a>运行 <code>PowerShell</code> 脚本</h3><p>当您的脚本编写成功后您可能第一次会像下面的方式运行它，也就是只输入脚本的文件名，会报错。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> E:&gt; MyScript.ps1</span><br><span class="line"></span><br><span class="line">无法将“MyScript.ps1”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括</span><br><span class="line">路径，请确保路径正确，然后重试。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">13</span></span><br><span class="line">+ MyScript.ps1 &lt; &lt;&lt;&lt;</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (MyScript.ps1:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class="line"></span><br><span class="line">Suggestion [<span class="number">3</span>,<span class="type">General</span>]: 未找到命令 MyScript.ps1，但它确实存在于当前位置。Windows PowerShell 默认情况下不从当前位置加载命令。如果信任此命令，请改为键入 <span class="string">&quot;./MyScript.ps1&quot;</span>。有关更多详细信息，请参阅 <span class="string">&quot;get-h</span></span><br><span class="line"><span class="string">elp about_Command_Precedence&quot;</span>。</span><br></pre></td></tr></table></figure>

<p>解决办法很简单，如果脚本在当前工作目录，请在脚本文件明前添加<code>./</code>，或者使用绝对路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PS E:&gt; .\MyScript.ps1</span><br><span class="line"></span><br><span class="line">2019年3月27日 18:33:03</span><br><span class="line">C:\Program Files\Common Files</span><br><span class="line">files count</span><br><span class="line">20</span><br><span class="line"></span><br><span class="line">PS E:&gt; E:MyScript.ps1</span><br><span class="line"></span><br><span class="line">2019年3月27日 18:33:11</span><br><span class="line">C:\Program Files\Common Files</span><br><span class="line">files count</span><br><span class="line">20</span><br></pre></td></tr></table></figure>

<h5 id="通过重定向创建脚本"><a href="#通过重定向创建脚本" class="headerlink" title="通过重定向创建脚本"></a>通过重定向创建脚本</h5><p>如果想要执行的脚本不是很长，我们甚至可以直接在控制台中要执行的语句重定向给一个脚本文件。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> E:&gt; <span class="string">&#x27;&quot;Hello,World!&quot;&#x27;</span> &gt; MyScript.ps1</span><br><span class="line"><span class="built_in">PS</span> E:&gt; ./MyScript.ps1</span><br><span class="line">Hello,World!</span><br></pre></td></tr></table></figure>

<p>这样有个缺点，就是您的代码必须放在闭合的引号中。这样的书写方式一旦在脚本内部也有引号时，是一件很痛苦的事。甚至您还可能希望在脚本中换行。下面的Here-strings例子不错，也就是将脚本文件通过<code>@&#39; &#39;@</code>闭合起来。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> E:&gt; <span class="string">@&#x27;</span></span><br><span class="line"><span class="string">&gt;&gt; Get-Date</span></span><br><span class="line"><span class="string">&gt;&gt; $Env:CommonProgramFiles</span></span><br><span class="line"><span class="string">&gt;&gt; #Script End</span></span><br><span class="line"><span class="string">&gt;&gt; &quot;files count&quot;</span></span><br><span class="line"><span class="string">&gt;&gt; (ls).Count</span></span><br><span class="line"><span class="string">&gt;&gt; #Script Really End</span></span><br><span class="line"><span class="string">&gt;&gt;</span></span><br><span class="line"><span class="string">&gt;&gt; &#x27;@ &gt; myscript.ps1</span></span><br><span class="line"><span class="string">&gt;&gt;</span></span><br><span class="line"><span class="string">PS E:&gt; .MyScript.ps1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2019年3月27日 18:15:10</span></span><br><span class="line"><span class="string">C:\Program Files\Common Files</span></span><br><span class="line"><span class="string">files count</span></span><br><span class="line"><span class="string">20</span></span><br></pre></td></tr></table></figure>
<p>Here-String以 <code>@&#39;</code>开头，以<code>&#39;@</code>结束.任何文本都可以存放在里面，哪怕是一些特殊字符，空号，白空格。但是如果您不小心将单引号写成了双引号，<code>PowerShell</code> 将会把里面的变量进行解析。</p>
<h5 id="通过编辑器创建脚本"><a href="#通过编辑器创建脚本" class="headerlink" title="通过编辑器创建脚本"></a>通过编辑器创建脚本</h5><p>其实最方便的还是使用文本编辑器直接编写代码，保存成PS1文件，右键即可执行。<br>这里推荐使用Visual Studio Code(以下简称VSC)，VSC提供了PS1的自动补全(安装插件)、语法高亮、自动缩进、格式化代码、断点调试等功能。</p>
<hr>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>变量可以临时保存数据，因此可以把数据保存在变量中，以便进一步操作。<code>PowerShell</code> 的变量定义非常方便。<br>我们可以用 <code>$变量名=初值</code> 的方法定义变量，解释器会根据所赋的初值判断变量类型，类似于C#的 <code>var</code> 关键字或C++11中的 <code>auto</code> 关键字<code>PowerShell</code> 不需要显示地去声明，可以自动创建变量，只须记住变量的前缀为$.<br>创建好了变量后，可以通过变量名输出变量，也可以把变量名存在字符串中。但是有个例外:<strong>单引号中的字符串不会识别和处理变量名。</strong></p>
<h4 id="选择变量名"><a href="#选择变量名" class="headerlink" title="选择变量名"></a>选择变量名</h4><p>在 <code>PowerShell</code> 中变量名均是以美元符 <code>$</code> 开始，剩余字符可以是数字、字母、下划线的任意字符，并且PowerShell变量名也对大小写不敏感（<code>$a</code> 和 <code>$A</code> 是同一个变量)。<br>某些特殊的字符(比如<code>$</code>等)在 <code>PowerShell</code> 中有特殊的用途，一般不推荐使用这些字符作为变量名。当然你硬要使用，请把整个变量名后缀用花括号括起来。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/&gt; <span class="variable">$</span>&#123;<span class="string">&quot;I&quot;</span>like <span class="variable">$</span>&#125;=<span class="number">5.1</span></span><br><span class="line"><span class="built_in">PS</span> C:/&gt; <span class="variable">$</span>&#123;<span class="string">&quot;I&quot;</span>like <span class="variable">$</span>&#125;</span><br><span class="line"><span class="number">5.1</span></span><br></pre></td></tr></table></figure>

<p><strong>不能定义和保留变量名称相同的变量</strong><br>使用<code>ls variable:</code> 列出当前使用的所有变量，刚启动的 <code>PowerShell</code> 执行此命令能看到 <code>PowerShell</code> 的所有自动化变量(一旦打开 <code>Powershell</code> 就会自动加载的变量，后面将会详细解释这些变量的作用)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">Name                           Value</span><br><span class="line">----                           -----</span><br><span class="line">$</span><br><span class="line">?                              True</span><br><span class="line">^</span><br><span class="line">args                           &#123;&#125;</span><br><span class="line">ConfirmPreference              High</span><br><span class="line">ConsoleFileName</span><br><span class="line">DebugPreference                SilentlyContinue</span><br><span class="line">Error                          &#123;&#125;</span><br><span class="line">ErrorActionPreference          Continue</span><br><span class="line">ErrorView                      NormalView</span><br><span class="line">ExecutionContext               System.Management.Automation.EngineIntrinsics</span><br><span class="line">false                          False</span><br><span class="line">FormatEnumerationLimit         4</span><br><span class="line">HOME                           C:\Users\aaaaa</span><br><span class="line">Host                           System.Management.Automation.Internal.Host.InternalHost</span><br><span class="line">InformationPreference          SilentlyContinue</span><br><span class="line">input                          System.Collections.ArrayList+ArrayListEnumeratorSimple</span><br><span class="line">MaximumAliasCount              4096</span><br><span class="line">MaximumDriveCount              4096</span><br><span class="line">MaximumErrorCount              256</span><br><span class="line">MaximumFunctionCount           4096</span><br><span class="line">MaximumHistoryCount            4096</span><br><span class="line">MaximumVariableCount           4096</span><br><span class="line">MyInvocation                   System.Management.Automation.InvocationInfo</span><br><span class="line">NestedPromptLevel              0</span><br><span class="line">null</span><br><span class="line">OutputEncoding                 System.Text.ASCIIEncoding</span><br><span class="line">PID                            8796</span><br><span class="line">PROFILE                        C:\Users\aaaaa\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</span><br><span class="line">ProgressPreference             Continue</span><br><span class="line">PSBoundParameters              &#123;&#125;</span><br><span class="line">PSCommandPath</span><br><span class="line">PSCulture                      zh-CN</span><br><span class="line">PSDefaultParameterValues       &#123;&#125;</span><br><span class="line">PSEdition                      Desktop</span><br><span class="line">PSEmailServer</span><br><span class="line">PSHOME                         C:\Windows\System32\WindowsPowerShell\v1.0</span><br><span class="line">PSScriptRoot</span><br><span class="line">PSSessionApplicationName       wsman</span><br><span class="line">PSSessionConfigurationName     http:&#x2F;&#x2F;schemas.microsoft.com&#x2F;powershell&#x2F;Microsoft.PowerShell</span><br><span class="line">PSSessionOption                System.Management.Automation.Remoting.PSSessionOption</span><br><span class="line">PSUICulture                    zh-CN</span><br><span class="line">PSVersionTable                 &#123;PSVersion, PSEdition, PSCompatibleVersions, BuildVersion...&#125;</span><br><span class="line">PWD                            C:\Users\aaaaa</span><br><span class="line">ShellId                        Microsoft.PowerShell</span><br><span class="line">StackTrace</span><br><span class="line">true                           True</span><br><span class="line">VerbosePreference              SilentlyContinue</span><br><span class="line">WarningPreference              Continue</span><br><span class="line">WhatIfPreference               False</span><br></pre></td></tr></table></figure>

<h4 id="查看变量类型"><a href="#查看变量类型" class="headerlink" title="查看变量类型"></a>查看变量类型</h4><p>变量可以自动存储任何<code>PowerShell</code>能够识别的类型信息，可以通过 <code>$变量名.GetType()</code> 查看和验证 <code>PowerShell</code> 分配给变量的数据类型</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/&gt; <span class="variable">$num</span>=<span class="number">10</span></span><br><span class="line"><span class="built_in">PS</span> C:/&gt; <span class="variable">$num</span>.gettype() <span class="comment">#不区分大小写</span></span><br><span class="line"></span><br><span class="line">IsPublic IsSerial Name                            BaseType</span><br><span class="line">-------- -------- ----                            --------</span><br><span class="line">True     True     Int32                           System.ValueType</span><br></pre></td></tr></table></figure>

<h4 id="删除变量"><a href="#删除变量" class="headerlink" title="删除变量"></a>删除变量</h4><p>如果不想继续使用自定义的变量，可以使用<code>del variable:变量名</code>的方法删除变量，注意此处无<code>$</code>符号</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="number">0</span></span><br><span class="line"><span class="variable">$a</span> <span class="operator">-eq</span> <span class="variable">$null</span></span><br><span class="line">False</span><br><span class="line"><span class="built_in">del</span> variable:a</span><br><span class="line"><span class="variable">$a</span> <span class="operator">-eq</span> <span class="variable">$null</span> </span><br><span class="line">True</span><br></pre></td></tr></table></figure>

<p>PowerShell支持的变量类型和C#大体相同(没有了short、uint、ulong等)，大多都继承自<code>System.ValueType</code>类( .NET类)，其基本数据类型包括</p>
<h4 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h4><table>
<thead>
<tr>
<th>类型</th>
<th>名称</th>
<th>允许的值</th>
<th>所属类</th>
</tr>
</thead>
<tbody><tr>
<td>byte</td>
<td>无符号整数(1字节)</td>
<td>0~255之间的整数</td>
<td>System.Byte</td>
</tr>
<tr>
<td>sbyte</td>
<td>有符号整数(1字节)</td>
<td>-128~127之间的整数</td>
<td>System.SByte</td>
</tr>
<tr>
<td>int16</td>
<td>有符号短整型(2字节)</td>
<td>-32768~32767之间的整数</td>
<td>System.Int16</td>
</tr>
<tr>
<td>uint16</td>
<td>无符号短整型(2字节)</td>
<td>0~65535之间的整数</td>
<td>System.UInt16</td>
</tr>
<tr>
<td>int</td>
<td>有符号整型</td>
<td>-2147483648~2147483647之间的整数</td>
<td>System.Int32</td>
</tr>
<tr>
<td>uint32</td>
<td>无符号整型</td>
<td>0~4294967295之间的整数</td>
<td>System.UInt32</td>
</tr>
<tr>
<td>long</td>
<td>有符号长整数(8字节)</td>
<td>-9223372036854775808~9223372036854775807之间的整数</td>
<td>System.Int64</td>
</tr>
<tr>
<td>ulong</td>
<td>无符号长整数(8字节)</td>
<td>0~18446744073709551615之间的整数</td>
<td>System.UInt64</td>
</tr>
</tbody></table>
<p>其实 <code>int</code> 、<code>long</code> 、以及下面的 <code>float</code> 都是 .NET的语法糖，真正的原生类型名是<code>int32</code>、<code>int64</code>、<code>single</code> 之类的类名</p>
<h4 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h4><p>浮点数标准形式(<code>float</code>和<code>double</code>)<br>$+/-m×2^e$<br>其中m为尾数，e为阶码，尾数是一个非负数，阶码是一个整数<br>PowerShell还支持一个特别的浮点数类型 <code>decimal</code>，其形式为<br>$+/-m×10^e$</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>名称</th>
<th>指数</th>
<th>m范围</th>
<th>e范围</th>
<th>近似最小值</th>
<th>近似最大值</th>
<th>所属类</th>
</tr>
</thead>
<tbody><tr>
<td>float</td>
<td>单精度浮点数</td>
<td>2</td>
<td>0~$2^{24}$</td>
<td>-149~104</td>
<td>$1.5×10^{-45}$</td>
<td>$3.4×10^{38}$</td>
<td>System.Single</td>
</tr>
<tr>
<td>double</td>
<td>双精度浮点数</td>
<td>2</td>
<td>0~$2^{53}$</td>
<td>-1075~970</td>
<td>$5.0×10^{-324}$</td>
<td>$1.7×10^{308}$</td>
<td>System.Double</td>
</tr>
<tr>
<td>decimal</td>
<td>16字节浮点数</td>
<td>10</td>
<td>0~$2^{96}$</td>
<td>-28~0</td>
<td>$1.0×10^{-28}$</td>
<td>$7.9×10^{28}$</td>
<td>System.Decimal</td>
</tr>
</tbody></table>
<h4 id="其他简单类型"><a href="#其他简单类型" class="headerlink" title="其他简单类型"></a>其他简单类型</h4><p>除了数值类型以外，还有3种基本类型</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>名称</th>
<th>允许的值</th>
<th>所属类</th>
</tr>
</thead>
<tbody><tr>
<td>char</td>
<td>字符型</td>
<td>一个Unicode字符，存储0~65535之间的整数</td>
<td>System.Char</td>
</tr>
<tr>
<td>bool</td>
<td>布尔型</td>
<td>布尔值: <code>$true</code> 或 <code>$false</code>(必须加<code>$</code>符号)</td>
<td>System.Boolean</td>
</tr>
<tr>
<td>enum</td>
<td>枚举</td>
<td>限定取值一组命名常量的独特的值类型</td>
<td>System.Enum</td>
</tr>
<tr>
<td>datetime</td>
<td>时间型</td>
<td>包含日期、时间的类型</td>
<td>System.DateTime</td>
</tr>
<tr>
<td>string</td>
<td>字符串</td>
<td>一组字符</td>
<td>System.String</td>
</tr>
</tbody></table>
<p>注意 <strong>C/C++的 <code>char</code> 仅支持ASCII里面的256个字符, <code>PowerShell</code> 和 <code>C#</code> 的 <code>char</code> 是支持Unicode的</strong>，<br><strong>PowerShell和C#的<code>string</code>类型并不是继承自 <code>System.ValuType</code> 类，而是继承自 <code>System.Object</code> 类</strong>，因此严格来说 <code>string</code> 类型并非是简单类型。<br>**PowerShell的转义字符是 ` 而不是 \**，这也是和C#的一个区别</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用char</span></span><br><span class="line"><span class="built_in">PS</span> D:/&gt;[<span class="built_in">char</span>]<span class="variable">$c</span>=<span class="string">&quot;A&quot;</span></span><br><span class="line"><span class="variable">$c</span></span><br><span class="line">A</span><br><span class="line"><span class="comment">#使用bool</span></span><br><span class="line"><span class="built_in">PS</span> D:/&gt;<span class="variable">$boolean</span>=<span class="variable">$true</span></span><br><span class="line"><span class="variable">$boolean</span></span><br><span class="line">True</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用enum</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">fruit</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	apple</span><br><span class="line">	banana</span><br><span class="line">	cherry</span><br><span class="line">	durian</span><br><span class="line">&#125;</span><br><span class="line">[<span class="type">fruit</span>]<span class="variable">$en</span>=[<span class="type">fruit</span>]::apple</span><br><span class="line"><span class="variable">$en</span></span><br><span class="line">apple</span><br><span class="line"><span class="variable">$item</span>=<span class="string">&quot;cherry&quot;</span></span><br><span class="line">[<span class="type">fruit</span>]<span class="variable">$enu</span>=[<span class="type">fruit</span>]::(<span class="variable">$item</span>)</span><br><span class="line"><span class="variable">$enu</span></span><br><span class="line">cherry</span><br><span class="line"></span><br><span class="line"><span class="comment">#这种使用方法是错误的</span></span><br><span class="line"><span class="built_in">PS</span> D:/&gt; [<span class="type">fruit</span>]<span class="variable">$enum</span>=banana</span><br><span class="line"></span><br><span class="line">banana : 无法将“banana”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正确，然后再试一次。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">12</span></span><br><span class="line">+ [<span class="type">fruit</span>]<span class="variable">$en</span>=banana</span><br><span class="line">+            ~~~~~~</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (banana:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class="line"></span><br><span class="line"><span class="comment">#当尝试使用非枚举值进行赋值时</span></span><br><span class="line"><span class="built_in">PS</span> D:/&gt; [<span class="type">fruit</span>]<span class="variable">$en</span>=[<span class="type">fruit</span>]::peach</span><br><span class="line"></span><br><span class="line">由于枚举值无效，无法将 Null 转换为类型“fruit”。请指定以下枚举值之一，然后重试。可能的枚举值为“apple,banana,cherry,durian”。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">1</span></span><br><span class="line">+ [<span class="type">fruit</span>]<span class="variable">$en</span>=[<span class="type">fruit</span>]::peach</span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : MetadataError: (:) [], ArgumentTransformationMetadataException</span><br><span class="line">    + FullyQualifiedErrorId : RuntimeException</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> D:/&gt; <span class="string">&quot;\n 123 `n 123&quot;</span></span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment">\n 123</span></span><br><span class="line"><span class="comment"> 123</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> D:/&gt;<span class="variable">$date</span>=<span class="built_in">get-date</span></span><br><span class="line"><span class="variable">$date</span></span><br><span class="line"><span class="variable">$date</span>.gettype()</span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment">2019年3月28日 19:32:30</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">IsPublic IsSerial Name                            BaseType</span></span><br><span class="line"><span class="comment">-------- -------- ----                            --------</span></span><br><span class="line"><span class="comment">True     True     DateTime                        System.ValueType</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="赋值和返回值"><a href="#赋值和返回值" class="headerlink" title="赋值和返回值"></a>赋值和返回值</h4><p>赋值操作符为 <code>=</code>，几乎可以把任何数据赋值给一个变量，甚至一条cmdlet命令<br>，因为 <code>PowerShell</code> 支持面向对象，对象可以包罗万象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">PS D:\powershell\test&gt; $item&#x3D;ls</span><br><span class="line">PS D:\powershell\test&gt; $item</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    目录: D:\powershell\test</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-a----       2017&#x2F;11&#x2F;24     12:52            136 4-3.cpp</span><br><span class="line">-a----        2019&#x2F;3&#x2F;27     15:13             65 anapple.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS D:\powershell\test&gt; $item.gettype()</span><br><span class="line"></span><br><span class="line">IsPublic IsSerial Name                              BaseType</span><br><span class="line">-------- -------- ----                              --------</span><br><span class="line">True     True     Object[]                          System.Array</span><br><span class="line"></span><br><span class="line">$item为一个对象数组</span><br></pre></td></tr></table></figure>

<h4 id="弱类型与强类型"><a href="#弱类型与强类型" class="headerlink" title="弱类型与强类型"></a>弱类型与强类型</h4><p>一般对 <code>PowerShell</code> 变量重新赋值时，变量类型会自动改变，这是弱类型语言的特点；<br>而 <code>PowerShell</code> 依托的 .NET是强类型的，所以 <code>PowerShell</code> 可以使用强类型。<br>强类型语言在速度上略逊于弱类型语言，但是强类型定义语言带来的严谨性又能避免不必要的错误。<br>可以在变量前添加类型限定符使该变量变为强类型，可以确保变量的类型不会随着赋值而改变</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">int</span>]<span class="variable">$num</span>=<span class="number">123</span> <span class="comment">#正确</span></span><br><span class="line">[<span class="built_in">int</span>]<span class="variable">$num</span>=<span class="built_in">ls</span> <span class="comment">&lt;#错误</span></span><br><span class="line"><span class="comment">无法将“System.Object[]”类型的“System.Object[]”值转换为“System.Int32”类型。</span></span><br><span class="line"><span class="comment">所在位置 行:1 字符: 1</span></span><br><span class="line"><span class="comment">+ [int]$num=ls</span></span><br><span class="line"><span class="comment">+ ~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment">    + CategoryInfo          : MetadataError: (:) [], ArgumentTransformationMetadataException</span></span><br><span class="line"><span class="comment">    + FullyQualifiedErrorId : RuntimeException</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><p><code>PowerShell</code> 能够非常方便地将字符串等基本类型转换成期望的类型。之所以神奇，是因为 <code>PowerShell</code> 本身做了很多辛苦的工作，按照优先级：</p>
<ol>
<li> <strong>直接赋值</strong>：输入类型和期望类型一致，可以直接交付。</li>
<li> <strong>基于语言的类型转换</strong>：当目标类型为<code>void</code>,<code>Boolean</code>,<code>String</code> , <code>Array</code> , <code>Hashtable</code> , <code>PSReference</code> (i.e.: [ref]), <code>XmlDocument</code> , <code>Delegate</code> 和 <code>Enum</code> 时，基于语言的类型转换开始工作。</li>
<li> <strong>Parse 转换</strong>：如果目标类型包含了 <code>Parse()</code> 方法，则采用它。</li>
<li> <strong>Static Create 转换</strong>：如果目标类型包含静态的Create，则采用它。</li>
<li> <strong>构造函数转换</strong>：如果目标类型定义了构造函数，采用它。</li>
<li> <strong>Cast 转换</strong>：如果目标类型定义了从源类型的显式或者隐式的操作符，则采用它。</li>
<li> <strong>IConvertible 接口转换</strong>：如果目标类型实现了支持源类型<code>IConvertible</code> 接口，则采用它。</li>
<li> <strong>IDictionary 转换</strong>：如果源类型是词典或者哈希表，会尝试创建一个实例，然后来填充name和value属性。</li>
<li> <strong>PSObject 属性转换</strong>：如果源类型是<code>PSObject</code>，通过目标类型的默认的构造函数创建一个实例，然后使用<code>PSObject</code>中的属性名称和值来填充实例的属性。</li>
<li> <strong>TypeConverter 转换</strong>：如果存在注册的 <code>TypeConverter</code> 或 <code>PSTypeConverter</code> 来处理转换，则使用它。</li>
</ol>
<p>注意<strong>对浮点数向整数进行类型转换时，会自动四舍五入！！</strong><br>如果要C++/C#那种向下取整的方法请使用 <code>[math]::Floor()</code> 函数<br>看几个转换的例子</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> D:/test&gt; <span class="variable">$s</span>=<span class="number">12.56</span></span><br><span class="line"><span class="built_in">PS</span> D:/test&gt; [<span class="built_in">int</span>]<span class="variable">$s</span></span><br><span class="line"><span class="number">13</span></span><br><span class="line"><span class="built_in">PS</span> D:/test&gt; [<span class="type">convert</span>]::ToInt32(<span class="variable">$s</span>)</span><br><span class="line"><span class="number">13</span></span><br></pre></td></tr></table></figure>

<p><code>[convert]::ToInt32()</code> 是 .NET <code>System.Convert</code> 类提供的转换函数<br><code>convert</code> 类中的转换函数格式为:<code>TO</code>+<code>原生类型名()</code>，这里的原生类型名指的是各个类型实际类名<br>常用：</p>
<ul>
<li><code>[convert]::ToInt32()</code></li>
<li><code>[convert]::ToSingle()</code></li>
<li><code>[convert]::ToDouble()</code></li>
<li><code>[convert]::ToBoolean()</code></li>
<li><code>[convert]::ToString()</code></li>
</ul>
<p><code>convert</code> 类提供了一系列方法来完成不同变量之间的转换，获得函数列表及使用方法请参考微软的 .NET文档<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/api/system.convert?redirectedfrom=MSDN&view=netframework-4.7.2#%E6%96%B9%E6%B3%95">Convert类 方法列表</a></p>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><p>注意逻辑运算符和比较运算符的写法,不支持 <code>C#</code> 的<code>&amp;&amp;</code> <code>||</code> <code>！</code> <code>==</code> <code>!=</code> <code>&lt;</code> <code>&gt;</code> <code>&gt;=</code> <code>&lt;=</code>这些运算符</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#加 减 乘 除 取余</span></span><br><span class="line">+ - * / %</span><br><span class="line"><span class="comment">#自增、自减运算符，和C#或C++完全一致</span></span><br><span class="line">++<span class="variable">$i</span></span><br><span class="line"><span class="variable">$i</span>++</span><br><span class="line"><span class="variable">$i</span>--</span><br><span class="line">--<span class="variable">$i</span></span><br><span class="line"><span class="comment">#且</span></span><br><span class="line"><span class="operator">-and</span></span><br><span class="line"><span class="comment">#并</span></span><br><span class="line"><span class="operator">-or</span></span><br><span class="line"><span class="comment">#非</span></span><br><span class="line"><span class="operator">-not</span></span><br><span class="line">!</span><br><span class="line"><span class="comment">#样例</span></span><br><span class="line"><span class="variable">$true</span> <span class="operator">-and</span> <span class="variable">$false</span> <span class="operator">-or</span> <span class="operator">-not</span> <span class="number">0</span></span><br><span class="line">!<span class="variable">$true</span></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">True</span><br><span class="line">False</span><br><span class="line"><span class="comment">#等于 (equal to)</span></span><br><span class="line"><span class="operator">-eq</span></span><br><span class="line"><span class="comment">#不等于 (not equal to)</span></span><br><span class="line"><span class="literal">-nq</span></span><br><span class="line"><span class="comment">#大于 (greater than)</span></span><br><span class="line"><span class="operator">-gt</span></span><br><span class="line"><span class="comment">#大于等于 (greater than or equal to)</span></span><br><span class="line"><span class="operator">-ge</span></span><br><span class="line"><span class="comment">#小于 (less than)</span></span><br><span class="line"><span class="operator">-lt</span></span><br><span class="line"><span class="comment">#小于等于 (less than or equal to)</span></span><br><span class="line"><span class="operator">-le</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#对于字符串类型，可以在比较运算符前加i或c表示是否区分大小写,</span></span><br><span class="line"><span class="comment">#i表示对大小写不敏感，c表示敏感，不写默认不敏感</span></span><br><span class="line"><span class="string">&quot;a&quot;</span> <span class="operator">-eq</span> <span class="string">&quot;A&quot;</span></span><br><span class="line"><span class="string">&quot;a&quot;</span> <span class="operator">-ceq</span> <span class="string">&quot;A&quot;</span></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">True</span><br><span class="line">False</span><br><span class="line"></span><br><span class="line"><span class="comment">#判断变量是否为兼容类型(同一类型或其父类型)，类型格式为 [类型名]</span></span><br><span class="line"><span class="operator">-is</span></span><br><span class="line"><span class="comment">#示例</span></span><br><span class="line"><span class="variable">$a</span>=<span class="number">0</span></span><br><span class="line"><span class="variable">$a</span> <span class="operator">-is</span> [<span class="built_in">int</span>]</span><br><span class="line"><span class="variable">$b</span>=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"><span class="variable">$b</span> <span class="operator">-is</span> [<span class="built_in">array</span>]</span><br><span class="line"><span class="variable">$a</span> <span class="operator">-is</span> [<span class="type">ValueType</span>]</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">True</span><br><span class="line">True</span><br><span class="line">True <span class="comment"># System.Int32类继承自System.ValueType类，因此int是其父类型ValueType的子类型</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="条件分支"><a href="#条件分支" class="headerlink" title="条件分支"></a>条件分支</h3><h4 id="if-else"><a href="#if-else" class="headerlink" title="if else"></a>if else</h4><p><code>if</code> 和 <code>else</code> 用法和C#完全一样，除了大括号不允许省略，多分支时还多了个<code>elseif</code> 可用，和<code>Python</code> 的 <code>elif</code> 作用相同</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$true</span> <span class="operator">-and</span> <span class="variable">$true</span>) &#123;</span><br><span class="line">	<span class="variable">$a</span>=<span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(<span class="variable">$a</span> <span class="operator">-eq</span> <span class="variable">$b</span>) &#123;</span><br><span class="line">	<span class="variable">$a</span>=<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="variable">$a</span>=<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h4><p>PowerShell的<code>switch</code>非常灵活，使用起来较为方便<br>相对C#或C++，PowerShell的switch不需要写`case:``，但是必须写大括号</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="string">&quot;Beijing&quot;</span></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$a</span>) </span><br><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;Beijing&quot;</span> &#123;<span class="variable">$res</span>=<span class="string">&quot;北京&quot;</span>&#125;</span><br><span class="line">	<span class="string">&quot;Shanghai&quot;</span> &#123;<span class="variable">$res</span>=<span class="string">&quot;上海&quot;</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>默认比较运算符为<code>-eq</code>，你也可以使用下面的例子自定义比较条件，必须保证表达式返回boolen类型($true和$false)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$v</span>=<span class="number">18</span></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$v</span>)</span><br><span class="line">&#123;</span><br><span class="line">	&#123;<span class="variable">$_</span> <span class="operator">-lt</span> <span class="number">10</span>&#125; &#123;<span class="string">&quot;小于10&quot;</span>&#125; <span class="comment"># $_ 表示当前的传入的变量 直接写的字符串会被输出</span></span><br><span class="line">	<span class="number">10</span> &#123;<span class="string">&quot;等于10&quot;</span>&#125;</span><br><span class="line">	&#123;<span class="variable">$_</span> <span class="operator">-gt</span> <span class="number">10</span>&#125; &#123;<span class="string">&quot;小于10&quot;</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment">大于10</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><p>接下来介绍循环</p>
<h4 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h4><p><code>PowerShell</code> 的 <code>for</code> 循环类似于<code>C#</code>，看一个样例:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span> <span class="operator">-lt</span> <span class="number">10</span>;<span class="variable">$i</span>++)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">Write-Output</span> <span class="string">&quot;Hello&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="do-while循环"><a href="#do-while循环" class="headerlink" title="do-while循环"></a>do-while循环</h4><p><code>Do</code> 和 <code>While</code> 可能产生死循环，为了防止死循环的发生，因此我们必须确切的指定循环终止的条件。指定了循环终止的条件后，一旦条件不满足就会退出循环。<br><code>do-while()</code> 会先执行再去判断，能保证循环至少执行一次。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> </span><br><span class="line">&#123; </span><br><span class="line">	<span class="variable">$n</span>=<span class="built_in">Read-Host</span> <span class="string">&quot;请输入数字&quot;</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$n</span> <span class="operator">-ne</span> <span class="number">0</span>)</span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment">请输入数字: 1</span></span><br><span class="line"><span class="comment">请输入数字: 2</span></span><br><span class="line"><span class="comment">请输入数字: s</span></span><br><span class="line"><span class="comment">请输入数字: 0</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="只使用while"><a href="#只使用while" class="headerlink" title="只使用while"></a>只使用while</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$n</span>=<span class="number">5</span></span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$n</span> <span class="operator">-gt</span> <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$n</span></span><br><span class="line">    <span class="variable">$n</span>=<span class="variable">$n</span><span class="literal">-1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<h5 id="跳出循环"><a href="#跳出循环" class="headerlink" title="跳出循环"></a>跳出循环</h5><p>使用 <code>continue</code> 关键字，可以终止当前循环，跳过 <code>continue</code> 后其它语句，重新下一次循环。<br>跳出循环语句使用 <code>break</code> 关键字</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$n</span>=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$n</span> <span class="operator">-lt</span> <span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$n</span> <span class="operator">-eq</span> <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$n</span>=<span class="variable">$n</span>+<span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$n</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$n</span>=<span class="variable">$n</span>+<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="variable">$n</span>=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$n</span> <span class="operator">-lt</span> <span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$n</span> <span class="operator">-eq</span> <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$n</span></span><br><span class="line">    <span class="variable">$n</span>++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还有一种循环 <code>foreach</code> ，等到我们讲到数组再说</p>
<hr>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><h4 id="定义数组"><a href="#定义数组" class="headerlink" title="定义数组"></a>定义数组</h4><p>在 <code>PowerShell</code> 中创建数组可以使用逗号</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$nums</span>=<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$nums</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>对于连续的数字数组可以使用一个更快捷的方法:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$nums</span>=<span class="number">1</span>..<span class="number">5</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$nums</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>

<h5 id="对象数组的多态"><a href="#对象数组的多态" class="headerlink" title="对象数组的多态"></a>对象数组的多态</h5><p>像变量一样，如果数组中元素的类型为弱类型，默认可以存储不同类型的值。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$array</span>=<span class="number">1</span>,<span class="string">&quot;2019&quot;</span>,([<span class="type">Guid</span>]::NewGuid()),(<span class="built_in">get-date</span>)</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$array</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2019</span></span><br><span class="line"></span><br><span class="line">Guid</span><br><span class="line">----</span><br><span class="line">ea5f17c6<span class="literal">-c0a2</span><span class="literal">-42ba</span><span class="literal">-9de4</span><span class="literal">-e4d03bebffaf</span></span><br><span class="line"></span><br><span class="line">DisplayHint : DateTime</span><br><span class="line">Date        : <span class="number">2019</span>/<span class="number">3</span>/<span class="number">29</span> <span class="number">0</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">Day         : <span class="number">29</span></span><br><span class="line">DayOfWeek   : Friday</span><br><span class="line">DayOfYear   : <span class="number">88</span></span><br><span class="line">Hour        : <span class="number">23</span></span><br><span class="line">Kind        : Local</span><br><span class="line">Millisecond : <span class="number">120</span></span><br><span class="line">Minute      : <span class="number">23</span></span><br><span class="line">Month       : <span class="number">3</span></span><br><span class="line">Second      : <span class="number">39</span></span><br><span class="line">Ticks       : <span class="number">636894986191207086</span></span><br><span class="line">TimeOfDay   : <span class="number">23</span>:<span class="number">23</span>:<span class="number">39.1207086</span></span><br><span class="line">Year        : <span class="number">2019</span></span><br><span class="line">DateTime    : <span class="number">2019</span>年<span class="number">3</span>月<span class="number">29</span>日 <span class="number">23</span>:<span class="number">23</span>:<span class="number">39</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$array</span>|<span class="keyword">foreach</span>&#123;<span class="variable">$_</span>.gettype()&#125;</span><br><span class="line"><span class="comment">#查看数组各元素类型</span></span><br><span class="line">IsPublic IsSerial Name                                     BaseType</span><br><span class="line">-------- -------- ----                                     --------</span><br><span class="line">True     True     Int32                                    System.ValueType</span><br><span class="line">True     True     String                                   System.Object</span><br><span class="line">True     True     Guid                                     System.ValueType</span><br><span class="line">True     True     DateTime                                 System.ValueType</span><br></pre></td></tr></table></figure>

<h5 id="空数组和单元素数组"><a href="#空数组和单元素数组" class="headerlink" title="空数组和单元素数组"></a>空数组和单元素数组</h5><p>对数组元素可以查看它的公有属性，比如长度<br>只需要输入<code>$数组名.Count</code>即可显示数组长度</p>
<h6 id="空数组"><a href="#空数组" class="headerlink" title="空数组"></a>空数组</h6><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$a</span>=<span class="selector-tag">@</span>()</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$a</span> <span class="operator">-is</span> [<span class="built_in">array</span>]</span><br><span class="line">True</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$a</span>.Count</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>

<h6 id="单元素数组"><a href="#单元素数组" class="headerlink" title="单元素数组"></a>单元素数组</h6><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:Powershell&gt; <span class="variable">$a</span>=,<span class="string">&quot;moss&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:Powershell&gt; <span class="variable">$a</span> <span class="operator">-is</span> [<span class="built_in">array</span>]</span><br><span class="line">True</span><br><span class="line"><span class="built_in">PS</span> C:Powershell&gt; <span class="variable">$a</span>.Count</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="使用数组"><a href="#使用数组" class="headerlink" title="使用数组"></a>使用数组</h4><h5 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h5><h6 id="直接法"><a href="#直接法" class="headerlink" title="直接法"></a>直接法</h6><p>将数组作为单独一行将会自动遍历这个数组的所有元素</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/&gt; <span class="variable">$a</span>=<span class="number">1</span>..<span class="number">10</span></span><br><span class="line"><span class="built_in">PS</span> C:/&gt; <span class="variable">$a</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>

<h6 id="for-循环遍历"><a href="#for-循环遍历" class="headerlink" title="for 循环遍历"></a><code>for</code> 循环遍历</h6><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/&gt; <span class="variable">$a</span>=<span class="number">1</span>..<span class="number">5</span></span><br><span class="line"><span class="built_in">PS</span> C:/&gt; <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span> <span class="operator">-lt</span> <span class="number">5</span>;<span class="variable">$i</span>++) &#123;</span><br><span class="line">&gt;&gt; <span class="variable">$a</span>[<span class="variable">$i</span>] &#125;</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="foreach-遍历法"><a href="#foreach-遍历法" class="headerlink" title="foreach 遍历法"></a><code>foreach</code> 遍历法</h6><p>还有一种遍历的方法，用到了之前提到的 <code>foreach</code> 语句<br>意思是使用变量 <code>$n</code> 对 <code>$a</code> 元素进行迭代，这实际上是一种对可迭代对象的访问算法<br>在 <code>C#</code> 也有这种语法</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="string">&quot;A&quot;</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&quot;C&quot;</span>,<span class="string">&quot;D&quot;</span>,<span class="string">&quot;E&quot;</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$n</span> <span class="keyword">in</span> <span class="variable">$a</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$n</span>+<span class="string">&quot; &quot;</span>+<span class="variable">$n</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">A A</span><br><span class="line">B B</span><br><span class="line">C C</span><br><span class="line">D D</span><br><span class="line">E E</span><br></pre></td></tr></table></figure>

<p><code>foreach</code>还有一种遍历的写法</p>
<p>这里我们需要先了解一下<strong>管道</strong><br>管道的符号 |<br>管道允许将它左侧命令的输出结果发送到右侧做命令的参数<br>管道并不是什么新事物，以前的Cmd控制台也有重定向的命令，例如Dir | More可以将结果分屏显示。<br>传统的Cmd管道是基于文本的，但是 <code>PowerShell</code> 是基于对象的</p>
<p>列出当前目录下的目录和文件，然后根据文件名降序排列，再投影(数据库术语)文件名，文件大小，文件的修改时间:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> D:/test&gt; <span class="built_in">ls</span> | <span class="built_in">Sort-Object</span> <span class="literal">-Descending</span> Name | <span class="built_in">Select-Object</span> Name,Length,LastWriteTime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    目录: D:/test</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Name        Length LastWriteTime</span><br><span class="line">----        ------ -------------</span><br><span class="line">out.txt        <span class="number">523</span> <span class="number">2019</span>/<span class="number">2</span>/<span class="number">24</span> <span class="number">22</span>:<span class="number">46</span>:<span class="number">35</span></span><br><span class="line">lang.json     <span class="number">6415</span> <span class="number">2019</span>/<span class="number">2</span>/<span class="number">16</span> <span class="number">23</span>:<span class="number">49</span>:<span class="number">24</span></span><br><span class="line">anapple.txt     <span class="number">65</span> <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span> <span class="number">15</span>:<span class="number">13</span>:<span class="number">52</span></span><br><span class="line"><span class="number">4</span><span class="literal">-3</span>.cpp        <span class="number">136</span> <span class="number">2017</span>/<span class="number">11</span>/<span class="number">24</span> <span class="number">12</span>:<span class="number">52</span>:<span class="number">28</span></span><br></pre></td></tr></table></figure>

<p>可迭代对象(比如数组)可以由管道送到一些命令上进一步处理<br><code>foreach</code>就可以接受管道送来的可迭代对象，并进行遍历</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$array</span>=<span class="string">&quot;A&quot;</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&quot;C&quot;</span>,<span class="string">&quot;D&quot;</span>,<span class="string">&quot;E&quot;</span></span><br><span class="line"><span class="variable">$array</span>|<span class="keyword">foreach</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$_</span>+<span class="string">&quot;s&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">As</span><br><span class="line">Bs</span><br><span class="line">Cs</span><br><span class="line">Ds</span><br><span class="line">Es</span><br></pre></td></tr></table></figure>

<h5 id="将数组逆序输出"><a href="#将数组逆序输出" class="headerlink" title="将数组逆序输出"></a>将数组逆序输出</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$books</span>=<span class="string">&quot;A1&quot;</span>,<span class="string">&quot;B2&quot;</span>,<span class="string">&quot;C3&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$books</span>[(<span class="variable">$books</span><span class="type">.Count</span>)<span class="type">..0</span>]</span><br><span class="line">C3</span><br><span class="line">B2</span><br><span class="line">A1</span><br></pre></td></tr></table></figure>
<h5 id="访问某些元素"><a href="#访问某些元素" class="headerlink" title="访问某些元素"></a>访问某些元素</h5><p>与C#相同，数组的元素可以使用索引寻址，第一个元素的索引为0，第i个元素的索引为i-1，最后一个元素的索引为Count-1，但是 <code>PowerShell</code> 为了使用方便，直接可以将 -1 作为最后的一个元素的索引(参考了 <code>Python</code> 的语法)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$books</span>=<span class="string">&quot;1A&quot;</span>,<span class="string">&quot;2B&quot;</span>,<span class="string">&quot;3C&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$books</span>[<span class="number">0</span>]</span><br><span class="line"><span class="number">1</span>A</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$books</span>[<span class="number">1</span>]</span><br><span class="line"><span class="number">2</span>B</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$books</span>[(<span class="variable">$book</span><span class="type">.Count</span>-<span class="number">1</span>)]</span><br><span class="line"><span class="number">3</span>C</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$books</span>[-<span class="number">1</span>]</span><br><span class="line"><span class="number">3</span>C</span><br></pre></td></tr></table></figure>

<h5 id="从数组中选择多个元素"><a href="#从数组中选择多个元素" class="headerlink" title="从数组中选择多个元素"></a>从数组中选择多个元素</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$result</span>=<span class="built_in">ls</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$result</span>[<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>]</span><br><span class="line">    Directory: C:Powershell</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime     Length Name</span><br><span class="line">----                -------------     ------ ----</span><br><span class="line">d----        <span class="number">2011</span>/<span class="number">11</span>/<span class="number">23</span>     <span class="number">17</span>:<span class="number">25</span>            ABC</span><br><span class="line"><span class="literal">-a</span>---        <span class="number">2011</span>/<span class="number">11</span>/<span class="number">24</span>     <span class="number">20</span>:<span class="number">04</span>      <span class="number">26384</span> a.txt</span><br><span class="line"><span class="literal">-a</span>---        <span class="number">2011</span>/<span class="number">11</span>/<span class="number">24</span>     <span class="number">20</span>:<span class="number">27</span>      <span class="number">12060</span> alias.ps1</span><br><span class="line"><span class="literal">-a</span>---        <span class="number">2011</span>/<span class="number">11</span>/<span class="number">24</span>     <span class="number">17</span>:<span class="number">37</span>       <span class="number">7420</span> name.html</span><br></pre></td></tr></table></figure>
<h5 id="给数组添加元素"><a href="#给数组添加元素" class="headerlink" title="给数组添加元素"></a>给数组添加元素</h5><p>因为PowerShell数组在内存中是顺序存储的，所以数组的大小必须是确定的，这样才方便分配存储空间，所以给数组增加元素其实相当于创建一个新的数组，只不过之后会把原来的副本删除。在当前数组追加元素可以使用 <code>+=</code> 操作符。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$books</span>=<span class="string">&quot;A1&quot;</span>,<span class="string">&quot;B2&quot;</span>,<span class="string">&quot;C3&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$books</span>+=<span class="string">&quot;D4&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$books</span></span><br><span class="line">A1</span><br><span class="line">B2</span><br><span class="line">C3</span><br><span class="line">D4</span><br></pre></td></tr></table></figure>

<h5 id="删除指定位置元素"><a href="#删除指定位置元素" class="headerlink" title="删除指定位置元素"></a>删除指定位置元素</h5><p>采用截断重连法删除指定元素</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$num</span>=<span class="number">1</span>..<span class="number">4</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$num</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$num</span>=<span class="variable">$num</span>[<span class="number">0</span><span class="type">..1</span>]+<span class="variable">$num</span>[<span class="number">3</span>] <span class="comment">#相当于删掉了第三项</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$num</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>

<h4 id="复制数组"><a href="#复制数组" class="headerlink" title="复制数组"></a>复制数组</h4><p>数组属于引用类型，使用默认的的赋值运算符在两个变量之间赋值只是复制了一个引用，两个变量共享同一份数据。这样的模式有一个弊病如果其中一个改变也会株连到另外一个。所以复制数组最好使用 <code>Clone()</code> 方法( <code>System.Array</code> 类的成员函数)，除非有特殊需求。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$chs</span>=<span class="selector-tag">@</span>(<span class="string">&quot;A&quot;</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&quot;C&quot;</span>)</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$chsBak</span>=<span class="variable">$chs</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$chsBak</span>[<span class="number">1</span>]=<span class="string">&quot;H&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$chs</span></span><br><span class="line">A</span><br><span class="line"><span class="built_in">H</span></span><br><span class="line">C</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$chs</span>.Equals(<span class="variable">$chsBak</span>)</span><br><span class="line">True</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$chsNew</span>=<span class="variable">$chs</span>.Clone()</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$chsNew</span>[<span class="number">1</span>]=<span class="string">&quot;Good&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$chs</span>.Equals(<span class="variable">$chsNew</span>)</span><br><span class="line">False</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$chs</span></span><br><span class="line">A</span><br><span class="line"><span class="built_in">H</span></span><br><span class="line">C</span><br></pre></td></tr></table></figure>

<h4 id="强类型数组"><a href="#强类型数组" class="headerlink" title="强类型数组"></a>强类型数组</h4><p><code>PowerShell</code> 数组一般具有多态性，如果你不指定元素的具体类型，解释器会自动选择合适的类型存储每个元素。如果要统一限制所有元素的类型，可是使用类型名和一对方括号作为数组变量的类型。这样每当赋值时，会自动类型检查。如果目标数据类型不能转换成功，就会抛出一个异常，这样的数组被称为强类型数组<br>定义方法<code>[类型[]]$数组名=初值</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; [<span class="built_in">int</span>[]] <span class="variable">$nums</span>=<span class="selector-tag">@</span>()</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$nums</span>+=<span class="number">2012</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$nums</span>+=<span class="number">12.3</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$nums</span>+=<span class="string">&quot;999&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$nums</span>+=<span class="string">&quot;can not convert&quot;</span></span><br><span class="line">Cannot convert value <span class="string">&quot;can not convert&quot;</span> to <span class="built_in">type</span> <span class="string">&quot;System.Int32&quot;</span>. Error: <span class="string">&quot;Input string was not in a correct format.&quot;</span></span><br><span class="line">At line:<span class="number">1</span> char:<span class="number">6</span></span><br><span class="line">+ <span class="variable">$nums</span> &lt;&lt;&lt;&lt; +=<span class="string">&quot;can not convert&quot;</span></span><br><span class="line">    + CategoryInfo          : MetadataError: (:) [], ArgumentTransformationMetadataException</span><br><span class="line">    + FullyQualifiedErrorId : RuntimeException</span><br></pre></td></tr></table></figure>

<h4 id="命令返回数组"><a href="#命令返回数组" class="headerlink" title="命令返回数组"></a>命令返回数组</h4><p>当我们把一个命令的执行结果保存到一个变量中，可能会认为变量存放的是纯文本。<br>但是，事实上 <code>PowerShell</code> 会把文本按每一行作为元素存为数组。如果一个命令的返回值不止一个结果时， <code>PowerShell</code> 也会自动把结果存储为数组</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$IPcfg</span>=ipconfig</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$IPcfg</span></span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Windows IP 配置</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">以太网适配器 以太网:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   媒体状态  . . . . . . . . . . . . : 媒体已断开连接</span></span><br><span class="line"><span class="comment">   连接特定的 DNS 后缀 . . . . . . . : lan</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">无线局域网适配器 本地连接* 1:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   媒体状态  . . . . . . . . . . . . : 媒体已断开连接</span></span><br><span class="line"><span class="comment">   连接特定的 DNS 后缀 . . . . . . . :</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">无线局域网适配器 本地连接* 2:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   连接特定的 DNS 后缀 . . . . . . . :</span></span><br><span class="line"><span class="comment">   本地链接 IPv6 地址. . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   IPv4 地址 . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   子网掩码  . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   默认网关. . . . . . . . . . . . . :</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">以太网适配器 VMware Network Adapter VMnet8:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   连接特定的 DNS 后缀 . . . . . . . :</span></span><br><span class="line"><span class="comment">   本地链接 IPv6 地址. . . . . . . . : fe80::f88d:cd97:5343:9713%16</span></span><br><span class="line"><span class="comment">   IPv4 地址 . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   子网掩码  . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   默认网关. . . . . . . . . . . . . :</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">无线局域网适配器 WLAN:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   连接特定的 DNS 后缀 . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   本地链接 IPv6 地址. . . . . . . . : fe80::954:3964:3731:997e%18</span></span><br><span class="line"><span class="comment">   IPv4 地址 . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   子网掩码  . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   默认网关. . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$IPcfg</span>.Count</span><br><span class="line"><span class="number">37</span></span><br></pre></td></tr></table></figure>

<h5 id="使用数组存储结果"><a href="#使用数组存储结果" class="headerlink" title="使用数组存储结果"></a>使用数组存储结果</h5><p>判断一个变量是否为数组</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$ip</span>=ipconfig</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$ip</span> <span class="operator">-is</span> [<span class="built_in">array</span>]</span><br><span class="line">True</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="string">&quot;abac&quot;</span> <span class="operator">-is</span> [<span class="built_in">array</span>]</span><br><span class="line">False</span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$str</span>=<span class="string">&quot;字符串&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:/Powershell&gt; <span class="variable">$str</span>.ToCharArray() <span class="operator">-is</span> [<span class="built_in">array</span>] <span class="comment">#转换为字符数组</span></span><br><span class="line">True</span><br></pre></td></tr></table></figure>

<h5 id="使用真实的对象操作"><a href="#使用真实的对象操作" class="headerlink" title="使用真实的对象操作"></a>使用真实的对象操作</h5><p>为什么不愿把IPconfig返回的结果称为对象，因为它不是真正Cmdlet命令(事实上ipconfig是一个单独的程序)，真正的 <code>PowerShell</code> 命令返回的数组元素可不止一个字符串，它是一个内容丰富的对象。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> D:/test&gt; <span class="variable">$list</span>=<span class="built_in">ls</span></span><br><span class="line"><span class="built_in">PS</span> D:/test&gt; <span class="variable">$list</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    目录: D:/test</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line"><span class="literal">-a</span>----       <span class="number">2017</span>/<span class="number">11</span>/<span class="number">24</span>     <span class="number">12</span>:<span class="number">52</span>            <span class="number">136</span> <span class="number">4</span><span class="literal">-3</span>.cpp</span><br><span class="line"><span class="literal">-a</span>----        <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span>     <span class="number">15</span>:<span class="number">13</span>             <span class="number">65</span> anapple.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> D:/test&gt; <span class="variable">$list</span>.gettype()</span><br><span class="line"></span><br><span class="line">IsPublic IsSerial Name                                     BaseType</span><br><span class="line">-------- -------- ----                                     --------</span><br><span class="line">True     True     Object[]                                 System.Array</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> D:/test&gt; <span class="keyword">foreach</span>(<span class="variable">$i</span> <span class="keyword">in</span> <span class="variable">$list</span>)&#123;<span class="variable">$i</span>.name&#125;</span><br><span class="line"><span class="number">4</span><span class="literal">-3</span>.cpp</span><br><span class="line">anapple.txt</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> D:/test&gt; <span class="variable">$list</span>[<span class="number">0</span>].gettype()</span><br><span class="line"></span><br><span class="line">IsPublic IsSerial Name                                     BaseType</span><br><span class="line">-------- -------- ----                                     --------</span><br><span class="line">True     True     FileInfo                                 System.IO.FileSystemInfo</span><br></pre></td></tr></table></figure>
<p>上面的例子中数组的每一个元素存放的是一个 <code>System.IO.DirectoryInfo</code> 对象。<br>当我们输出这些对象时，<code>PowerShell</code> 会自动帮我们把它转换成友好的文本格式。<br>对于任何一个对象都可以使用 <code>Format-List *</code> 来查看它所有的属性和方法。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> D:/test&gt; <span class="variable">$list</span>[<span class="number">0</span>]|<span class="built_in">fl</span> * </span><br><span class="line"><span class="comment"># &quot;|&quot;符号是管道符，将左边返回结果做参数发送到右侧，fl是Format-List的简称</span></span><br><span class="line"></span><br><span class="line">PSPath            : Microsoft.PowerShell.Core\FileSystem::D:test\<span class="number">4</span><span class="literal">-3</span>.cpp</span><br><span class="line">PSParentPath      : Microsoft.PowerShell.Core\FileSystem::D:\test</span><br><span class="line">PSChildName       : <span class="number">4</span><span class="literal">-3</span>.cpp</span><br><span class="line">PSDrive           : D</span><br><span class="line">PSProvider        : Microsoft.PowerShell.Core\FileSystem</span><br><span class="line">PSIsContainer     : False</span><br><span class="line">Mode              : <span class="literal">-a</span>----</span><br><span class="line">VersionInfo       : File:             D:\test\<span class="number">4</span><span class="literal">-3</span>.cpp</span><br><span class="line">                    InternalName:</span><br><span class="line">                    OriginalFilename:</span><br><span class="line">                    FileVersion:</span><br><span class="line">                    FileDescription:</span><br><span class="line">                    Product:</span><br><span class="line">                    ProductVersion:</span><br><span class="line">                    Debug:            False</span><br><span class="line">                    Patched:          False</span><br><span class="line">                    PreRelease:       False</span><br><span class="line">                    PrivateBuild:     False</span><br><span class="line">                    SpecialBuild:     False</span><br><span class="line">                    Language:</span><br><span class="line"></span><br><span class="line">BaseName          : <span class="number">4</span><span class="literal">-3</span></span><br><span class="line">Target            : &#123;&#125;</span><br><span class="line">LinkType          :</span><br><span class="line">Name              : <span class="number">4</span><span class="literal">-3</span>.cpp</span><br><span class="line">Length            : <span class="number">136</span></span><br><span class="line">DirectoryName     : D:\test</span><br><span class="line">Directory         : D:\test</span><br><span class="line">IsReadOnly        : False</span><br><span class="line">Exists            : True</span><br><span class="line">FullName          : D:\test\<span class="number">4</span><span class="literal">-3</span>.cpp</span><br><span class="line">Extension         : .cpp</span><br><span class="line">CreationTime      : <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">32</span></span><br><span class="line">CreationTimeUtc   : <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span> <span class="number">7</span>:<span class="number">07</span>:<span class="number">32</span></span><br><span class="line">LastAccessTime    : <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">32</span></span><br><span class="line">LastAccessTimeUtc : <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span> <span class="number">7</span>:<span class="number">07</span>:<span class="number">32</span></span><br><span class="line">LastWriteTime     : <span class="number">2017</span>/<span class="number">11</span>/<span class="number">24</span> <span class="number">12</span>:<span class="number">52</span>:<span class="number">28</span></span><br><span class="line">LastWriteTimeUtc  : <span class="number">2017</span>/<span class="number">11</span>/<span class="number">24</span> <span class="number">4</span>:<span class="number">52</span>:<span class="number">28</span></span><br><span class="line">Attributes        : Archive</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>函数是自定义的 <code>Powershell</code> 代码，有三个原则：  </p>
<ul>
<li><strong>简短</strong>：函数名简短，并且显而易见。  </li>
<li><strong>聚合</strong>：函数可以完成多个操作。  </li>
<li><strong>封装和扩展</strong>：将一批 <code>Powershell</code> 语句进行封装，实现全新的功能需求。<br>函数的结构由三部分组成：函数名，参数，函数体</li>
</ul>
<h4 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h4><h5 id="脚本中函数的定义方法"><a href="#脚本中函数的定义方法" class="headerlink" title="脚本中函数的定义方法"></a>脚本中函数的定义方法</h5><p>函数可以在文本编辑器上编写，写完以后复制进 <code>PowerShell</code> 控制台即可。如果控制台设置为快速编辑模式，从记事本复制后，直接在控制台鼠标右键即可完成粘贴(Windows 10默认开启了快速编辑模式)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FuncName</span><span class="params">(args[])</span> #括号可省略</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">&lt;#代码段#&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="控制台上多行输入定义函数"><a href="#控制台上多行输入定义函数" class="headerlink" title="控制台上多行输入定义函数"></a>控制台上多行输入定义函数</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/PowerShell&gt; <span class="function"><span class="keyword">function</span> <span class="title">MyPing</span></span></span><br><span class="line">&gt;&gt; &#123;</span><br><span class="line">&gt;&gt; PING.EXE  <span class="literal">-n</span> <span class="number">1</span> <span class="variable">$args</span></span><br><span class="line">&gt;&gt; &#125;</span><br><span class="line"><span class="built_in">PS</span> C:/PowerShell&gt;</span><br></pre></td></tr></table></figure>

<h5 id="把函数精简成一行"><a href="#把函数精简成一行" class="headerlink" title="把函数精简成一行"></a>把函数精简成一行</h5><p>我们可以将一个函数定义在一行上，但是这样阅读和理解起来就不方便，所以要在每条命令后加分号进行分割(最后一句可以不写<code>;</code>)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/PowerShell&gt; <span class="function"><span class="keyword">function</span> <span class="title">cd</span>...</span>&#123; <span class="built_in">cd</span>.. ; <span class="built_in">cd</span>.. &#125;</span><br><span class="line"><span class="built_in">PS</span> C:/PowerShell&gt; <span class="built_in">cd</span>...</span><br></pre></td></tr></table></figure>

<h5 id="使用函数作为别名"><a href="#使用函数作为别名" class="headerlink" title="使用函数作为别名"></a>使用函数作为别名</h5><p>假如 <code>PowerShell</code> 不支持 <code>Get-SystemVersion</code> 命令，你可以通过定义函数实现这个功能：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get-systemversion</span></span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$psversiontable</span>.BuildVersion</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Get-SystemVersion</span></span><br><span class="line"></span><br><span class="line">Major  Minor  Build  Revision</span><br><span class="line">-----  -----  -----  --------</span><br><span class="line"><span class="number">10</span>     <span class="number">0</span>      <span class="number">17134</span>  <span class="number">590</span></span><br></pre></td></tr></table></figure>

<h5 id="更新函数"><a href="#更新函数" class="headerlink" title="更新函数"></a>更新函数</h5><p>如果要更新已经定义好的函数，简单的方法是重新定义，这样新的定义会覆盖旧的定义。但是如果函数代码没有保存副本，可以先将函数定义导出到ps文件，然后就可以编辑了。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:/PowerShell&gt; <span class="function"><span class="keyword">function</span> <span class="title">MyPing</span></span></span><br><span class="line">&gt;&gt; &#123;</span><br><span class="line">&gt;&gt; PING.EXE  <span class="literal">-n</span> <span class="number">1</span> <span class="variable">$args</span></span><br><span class="line">&gt;&gt; &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:/PowerShell&gt; <span class="variable">$function:MyPing</span> | <span class="built_in">Out-File</span> myPing.ps1</span><br><span class="line"><span class="built_in">PS</span> C:/PowerShell&gt; <span class="variable">$function:MyPing</span></span><br><span class="line"></span><br><span class="line">PING.EXE  <span class="literal">-n</span> <span class="number">1</span> <span class="variable">$args</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:/PowerShell&gt; <span class="variable">$function:MyPing</span> | <span class="built_in">Out-File</span> myPing.ps1</span><br><span class="line"><span class="built_in">PS</span> C:/PowerShell&gt; .myPing.ps1</span><br><span class="line">必须指定 IP 地址。</span><br><span class="line"><span class="built_in">PS</span> C:/PowerShell&gt; notepad.exe <span class="variable">$</span><span class="variable">$</span></span><br></pre></td></tr></table></figure>

<h5 id="删除函数"><a href="#删除函数" class="headerlink" title="删除函数"></a>删除函数</h5><p>控制台定义的函数只会在当前会话生效，一旦控制台退出，会自动消失。在不关闭控制台的条件下删除一个已经定义好的函数，可是使用虚拟驱动器的方法：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cc</span></span>&#123;<span class="string">&quot;hello&quot;</span>&#125;</span><br><span class="line"><span class="built_in">PS</span> C:/&gt; cc</span><br><span class="line">hello</span><br><span class="line"><span class="built_in">PS</span> C:/&gt; <span class="built_in">del</span> function:cc</span><br><span class="line"><span class="built_in">PS</span> C:/&gt; cc</span><br><span class="line">cc : 无法将“cc”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正确，然后再试一次。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">1</span></span><br><span class="line">+ cc</span><br><span class="line">+ ~~</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (cc:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br></pre></td></tr></table></figure>
<h4 id="输入输出函数"><a href="#输入输出函数" class="headerlink" title="输入输出函数"></a>输入输出函数</h4><p>用于脚本文件的编写</p>
<h5 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h5><p>PowerShell提供了 <code>Read-Host</code> 命令，可以接收返回用户在控制台输入的字符</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$name</span>=<span class="built_in">read-host</span> <span class="string">&quot;请输入你的名字&quot;</span> </span><br><span class="line"><span class="comment">#会把提示信息打印到PS控制台，也可以不写提示信息</span></span><br><span class="line"><span class="comment">&lt;#执行+输入 结果:</span></span><br><span class="line"><span class="comment">请输入你的名字: Nougat </span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"><span class="variable">$name</span></span><br><span class="line">Nougat</span><br></pre></td></tr></table></figure>

<p>注意到</p>
<ol>
<li>提示信息(如果有)后面自动加了个冒号；</li>
<li>用户键入任何信息都被作为该命令的返回结果；</li>
<li>可以把键入的信息传递给一个变量；</li>
</ol>
<h5 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h5><p>有两种输出命令<br><code>Write-Host</code>和<code>Write-Output</code><br>若输出字符串不包含空白字符可以不加引号</p>
<h6 id="Write-Host"><a href="#Write-Host" class="headerlink" title="Write-Host"></a><code>Write-Host</code></h6><p>当需要展示一个特定信息，比如使用其他颜色来吸引人们的注意力的时候，可使用 <code>Write-Host</code> 命令<br> <code>Write-Host</code> 和其他Cmdlets一样使用管道，但是它不放置任何数据道管道中。反而会直接写到宿主应用程序的界面。正如此，可以使用<code>-ForegroundColor</code> 和 <code>-BackgroundColor</code> 参数将前景和背景设置为其他颜色：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">write-host</span> <span class="string">&quot;啊哈&quot;</span> <span class="literal">-ForegroundColor</span> White <span class="literal">-BackgroundColor</span> Red</span><br><span class="line">啊哈</span><br></pre></td></tr></table></figure>

<p>注：<strong>不是每个使用PowerShell的应用程序都支持其他颜色，也并不是每个应用程序都支持所有颜色</strong>。<br>该输出方法<strong>不适用于常规的输出结果</strong>，因为 <code>Write-Host</code> 命令输出到屏幕的任何东西都无法被捕捉。若执行远程命令或无人值守命令(纯自动化)， <code>Write-Host</code> 可能不会按照你的预期工作。因此，此命令仅仅用于与人进行直接交互。</p>
<h6 id="Write-Output"><a href="#Write-Output" class="headerlink" title="Write-Output"></a><code>Write-Output</code></h6><p><code>Write-Output</code>命令会将对象发送给管道。由于它不会直接发送到显示界面，所以不允许你指定其他任何的颜色。</p>
<p>它是<code>PowerShell</code>默认使用的一个Cmdlets，默认输出方式即使用该命令，即使你没有指定，<code>PowerShell</code>会在底层将信息传递给<code>Write-Output</code>命令(就是一行直接写一个变量就能直接输出的情况)，另外这个命令还有两个别名 <code>write</code> 和 <code>echo</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">write-host</span> ACB <span class="comment">#无空白字符可以不写引号 </span></span><br><span class="line">ACB</span><br><span class="line"><span class="built_in">write</span> <span class="string">&quot;ABC&quot;</span></span><br><span class="line">ABC</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ABD&quot;</span></span><br><span class="line">ABD</span><br></pre></td></tr></table></figure>

<p><code>Write-Output</code>输出基本过程为：</p>
<blockquote>
<ol>
<li><code>Write-Output</code>命令将<code>string</code>类型的对象<code>Hello World!</code>放入管道中；</li>
<li>管道中只有这个<code>string</code>对象，其会直接到达管道的末端，也就是<code>Out-Default</code>命令；</li>
<li><code>Out-Default</code>命令将对象传递给<code>Out-Host</code>命令；</li>
<li><code>Out-Host</code>命令要求<code>PowerShell</code>的格式化系统格式化该对象。</li>
<li><code>Out-Host</code>将格式化的结果集放在显示界面上</li>
</ol>
</blockquote>
<p>还有一点，在输出多个对象时，<code>Write-Host</code>会以空格隔开各对象<br><code>Write-Output</code>会以换行隔开各对象</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">write-host</span> <span class="string">&quot;ABC&quot;</span> <span class="string">&quot;23232&quot;</span></span><br><span class="line">ABC <span class="number">23232</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">write-output</span> <span class="string">&quot;ABC&quot;</span> <span class="string">&quot;23232&quot;</span></span><br><span class="line">ABC </span><br><span class="line"><span class="number">23232</span></span><br></pre></td></tr></table></figure>

<h6 id="其他的输出方式"><a href="#其他的输出方式" class="headerlink" title="其他的输出方式"></a>其他的输出方式</h6><p><code>Write-Warning/Verbose/Debug/Error</code></p>
<p>具体参考：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.utility/write-debug?view=powershell-3.0">微软官方文档</a></p>
<h4 id="处理函数参数"><a href="#处理函数参数" class="headerlink" title="处理函数参数"></a>处理函数参数</h4><p><code>PowerShell</code> 函数可以接受参数，并对参数进行处理。函数的参数有3个特性：</p>
<ol>
<li>任意参数：内部变量<code>$args</code> 接受函数调用时接受的参数，<code>$args</code>是一个数组类型；</li>
<li>命名参数：函数的每一个参数可以分配一个名称，在调用时通过名称指定对应的参数；</li>
<li>预定义参数：函数在定义参数时可以指定默认值，如果调用时没有专门指定参数的值，就会保持默认值；</li>
</ol>
<h5 id="args-万能参数"><a href="#args-万能参数" class="headerlink" title="$args 万能参数"></a>$args 万能参数</h5><p>给一个函数定义参数最简单的是使用<code>$args</code>这个内置的参数。它可以识别任意个参数。尤其适用那些参数可有可无的函数。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$args</span>.Count <span class="operator">-eq</span> <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;No argument!&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$args</span> | <span class="keyword">foreach</span> &#123;<span class="string">&quot;Hello,<span class="variable">$</span>(<span class="variable">$_</span>)&quot;</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#无参调用</span></span><br><span class="line">sayhello</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">No argument!</span><br><span class="line"></span><br><span class="line"><span class="comment">#一参调用</span></span><br><span class="line">sayhello <span class="string">&quot;World!&quot;</span> <span class="comment">#也可以写成sayhello(&quot;World!&quot;)</span></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">Hello,World!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#多参数调用</span></span><br><span class="line"><span class="variable">$str</span>=<span class="string">&quot;it&#x27;s me.&quot;</span></span><br><span class="line">sayhello <span class="number">123</span> <span class="string">&quot;aha&quot;</span> <span class="variable">$str</span> <span class="comment">#如果字符串不包含空白字符(比如空格)，引号可以不写</span></span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment">Hello,123</span></span><br><span class="line"><span class="comment">Hello,aha</span></span><br><span class="line"><span class="comment">Hello,it&#x27;s me.</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br></pre></td></tr></table></figure>

<p>因为 <code>$arg</code> 是一个数组,可以用它很方便的写出求和函数</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Add</span></span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$sum</span>=<span class="number">0</span></span><br><span class="line">	<span class="variable">$args</span> | <span class="keyword">foreach</span> &#123;<span class="variable">$sum</span>=<span class="variable">$sum</span>+<span class="variable">$_</span>&#125;</span><br><span class="line">	<span class="variable">$sum</span></span><br><span class="line">&#125;</span><br><span class="line">Add <span class="number">10</span> <span class="number">7</span> <span class="number">3</span> <span class="number">100</span></span><br><span class="line"><span class="comment">#120</span></span><br></pre></td></tr></table></figure>

<h5 id="使用固定参数"><a href="#使用固定参数" class="headerlink" title="使用固定参数"></a>使用固定参数</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">StringContact</span><span class="params">(<span class="variable">$str1</span>,<span class="variable">$str2</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$str1</span>+<span class="variable">$str2</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">StringContact LN P</span><br><span class="line"><span class="comment">#StringContact -str1 word -str2 press</span></span><br><span class="line"><span class="comment">#StringContact(&quot;word&quot;,&quot;press&quot;)</span></span><br><span class="line">LNP</span><br><span class="line">wordpress</span><br></pre></td></tr></table></figure>

<h5 id="给参数定义默认值"><a href="#给参数定义默认值" class="headerlink" title="给参数定义默认值"></a>给参数定义默认值</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">stringContact</span><span class="params">(<span class="variable">$str1</span>=&quot;LN&quot;,<span class="variable">$str2</span>=&quot;P&quot;)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$str1</span>+<span class="variable">$str2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stringContact</span><br><span class="line">LNP</span><br></pre></td></tr></table></figure>

<h5 id="使用强类型参数"><a href="#使用强类型参数" class="headerlink" title="使用强类型参数"></a>使用强类型参数</h5><p>通过之前的例子发现将用户的参数传递给函数显得比较混乱。罪魁祸首就是<code>PowerShell</code>的参数解释器，它可以自动处理和分配参数给函数。<br>函数的参数解释器比较傲慢，它对你提供的参数的信息完全不关心。它只会粗略地将参数进行分割，并且最大限度的进行自动类型转换。事实上，这种类型转换很多时候并不完美。所以<strong>最好提前能够对参数进行强类型限制</strong></p>
<h5 id="限制数字类型"><a href="#限制数字类型" class="headerlink" title="限制数字类型"></a>限制数字类型</h5><p>下面的函数执行后，会抛出异常<br>因为 <code>subtract</code> 的参数定义了强类型，参数的类型可能引起函数的处理结果改变。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">subtract</span><span class="params">([int]<span class="variable">$value1</span>,[int]<span class="variable">$value2</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$value1</span>-<span class="variable">$value2</span></span><br><span class="line">&#125;</span><br><span class="line">subtract LN P</span><br><span class="line"><span class="comment">#执行结果报错</span></span><br><span class="line">subtract : 无法处理对参数“value1”的参数转换。无法将值“LN”转换为类型“System.Int32”。错误:“输入字符串的格式不正确。”</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">10</span></span><br><span class="line">+ subtract LN P</span><br><span class="line">+          ~~</span><br><span class="line">    + CategoryInfo          : InvalidData: (:) [<span class="type">subtract</span>]，ParameterBindingArgumentTransformationException</span><br><span class="line">    + FullyQualifiedErrorId : ParameterArgumentTransformationError,subtract</span><br><span class="line"></span><br><span class="line">subtract <span class="number">8.1</span> <span class="number">7.9</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="comment">&lt;#结果为0，这是因为PowerShell对结果整型化时进行了四舍五入</span></span><br><span class="line"><span class="comment">但是如果将上面的函数的参数定义为Double型#&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">subtract</span><span class="params">([double]<span class="variable">$value1</span>,[double]<span class="variable">$value2</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$value1</span>-<span class="variable">$value2</span></span><br><span class="line">&#125;</span><br><span class="line">subtract <span class="number">8.1</span>  <span class="number">7.9</span></span><br><span class="line"><span class="number">0.199999999999999</span></span><br><span class="line"><span class="comment">&lt;#输出 0.199999999999999的原因就是 .NET使用IEEE754标准存储浮点数，</span></span><br><span class="line"><span class="comment">由于这些小数转化二进制会无限循环，会根据一定精度截取尾数，</span></span><br><span class="line"><span class="comment">这个问题引发了这种奇怪的结果，</span></span><br><span class="line"><span class="comment">其实著名的0.1+0.2!=0.3也是这个原因导致的#&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="限制日期类型"><a href="#限制日期类型" class="headerlink" title="限制日期类型"></a>限制日期类型</h5><p>函数的参数解释器会自动尝试将字符串转换成日期类型，如果转换失败就是抛出异常<br>看下面的例子</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DayOfWeek</span><span class="params">([datetime]<span class="variable">$date</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span>  <span class="variable">$date</span>.DayOfWeek</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DayofWeek <span class="string">&#x27;1927-8-1&#x27;</span></span><br><span class="line">Monday</span><br><span class="line"></span><br><span class="line">DayofWeek <span class="number">2008</span><span class="literal">-8</span><span class="literal">-1</span></span><br><span class="line">Friday</span><br><span class="line"></span><br><span class="line">DayofWeek <span class="string">&#x27;abc&#x27;</span></span><br><span class="line">DayOfWeek : 无法处理对参数“date”的参数转换。无法将值“abc”转换为类型“System.DateTime”。错误:“该字符串未被识别为有效的 DateTime。有一个未知单词(从索引 <span class="number">0</span> 处开始)。”</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">12</span></span><br><span class="line">+  DayofWeek <span class="string">&#x27;abc&#x27;</span></span><br><span class="line">+            ~~~~~</span><br><span class="line">    + CategoryInfo          : InvalidData: (:) [<span class="type">DayOfWeek</span>]，ParameterBindingArgumentTransformationException</span><br><span class="line">    + FullyQualifiedErrorId : ParameterArgumentTransformationError,DayOfWeek</span><br></pre></td></tr></table></figure>

<h5 id="Switch-参数"><a href="#Switch-参数" class="headerlink" title="Switch 参数"></a>Switch 参数</h5><p><code>Powershell</code> 函数最简单的参数类型为布尔类型，除了使用 <code>Bool</code> 类型，也可以使用 <code>Switch</code> 关键字。<br>下面的函数逆转字符串，但是可以通过 <code>$try</code> 参数进行控制，如果没有指定 <code>$try</code> 的值，默认值为 <code>$false</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">tryReverse</span><span class="params">( [switch]<span class="variable">$try</span> , [string]<span class="variable">$source</span> )</span> </span></span><br><span class="line"><span class="comment">#此处switch完全可以换成bool</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="built_in">string</span>]<span class="variable">$target</span>=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$try</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>( [<span class="built_in">int</span>]<span class="variable">$i</span> = <span class="variable">$source</span>.length <span class="literal">-1</span>; <span class="variable">$i</span> <span class="operator">-ge</span> <span class="number">0</span> ;<span class="variable">$i</span>--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$target</span> += <span class="variable">$source</span>[<span class="variable">$i</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$target</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$source</span></span><br><span class="line">&#125;</span><br><span class="line">tryReverse <span class="literal">-source</span> www.google.com</span><br><span class="line">tryReverse <span class="literal">-try</span> <span class="variable">$true</span> <span class="literal">-source</span> www.google.com</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">www.google.com</span><br><span class="line">moc.eloog.www</span><br></pre></td></tr></table></figure>

<h4 id="指定函数的返回值"><a href="#指定函数的返回值" class="headerlink" title="指定函数的返回值"></a>指定函数的返回值</h4><h5 id="一个或多个返回值"><a href="#一个或多个返回值" class="headerlink" title="一个或多个返回值"></a>一个或多个返回值</h5><p><code>PowerShell</code> 不像其它的编程语言，它的函数可以有多个返回值。如果你直接调用函数，返回值会在控制台输出。当然你也可以将结果存储在一个变量中进一步处理<br>下面的例子演示返回一个值：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Square</span><span class="params">([double]<span class="variable">$num</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>*<span class="variable">$num</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#在控制台输出结果</span></span><br><span class="line">Square <span class="number">9.87</span></span><br><span class="line"><span class="number">97.4169</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#将结果赋值给变量</span></span><br><span class="line"><span class="variable">$value</span>=Square <span class="number">9.87</span></span><br><span class="line"><span class="variable">$value</span></span><br><span class="line"><span class="number">97.4169</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#返回值为Double类型</span></span><br><span class="line"><span class="variable">$value</span>.GetType().FullName</span><br><span class="line">System.Double</span><br></pre></td></tr></table></figure>

<p>下面的例子演示返回多个值</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gbMeasure</span><span class="params">(<span class="variable">$amount</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$amount</span> GB=<span class="variable">$</span>(<span class="variable">$amount</span>) GB&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="variable">$amount</span> GB=<span class="variable">$</span>(<span class="variable">$amount</span>*1gb/1mb) MB&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="variable">$amount</span> GB=<span class="variable">$</span>(<span class="variable">$amount</span>*1gb/1kb) KB&quot;</span></span><br><span class="line">    <span class="string">&quot;<span class="variable">$amount</span> GB=<span class="variable">$</span>(<span class="variable">$amount</span>*1gb) B&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#函数返回4个值</span></span><br><span class="line">gbMeasure <span class="number">1</span></span><br><span class="line"><span class="number">1</span> GB=<span class="number">1</span> GB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1024</span> MB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1048576</span> KB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1073741824</span> B</span><br><span class="line"> </span><br><span class="line"><span class="comment">#将所有的返回值存储在一个变量中</span></span><br><span class="line"><span class="variable">$result</span>=gbMeasure <span class="number">1</span></span><br><span class="line"><span class="variable">$result</span></span><br><span class="line"> </span><br><span class="line"><span class="number">1</span> GB=<span class="number">1</span> GB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1024</span> MB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1048576</span> KB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1073741824</span> B</span><br><span class="line"> </span><br><span class="line"><span class="comment">#所有的返回值会自动存储在一个数组中</span></span><br><span class="line"><span class="variable">$result</span>=gbMeasure <span class="number">1</span></span><br><span class="line"><span class="variable">$result</span>.GetType().Name</span><br><span class="line">Object[]</span><br><span class="line"> </span><br><span class="line"><span class="comment">#通过索引访问每个返回值</span></span><br><span class="line"><span class="variable">$result</span>=gbMeasure <span class="number">1</span></span><br><span class="line"><span class="variable">$result</span>[<span class="number">3</span>]</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1073741824</span> B</span><br></pre></td></tr></table></figure>

<p>总结一下，如果一个函数返回一个值，像其它编程语言一样，这个值包括它的类型信息会直接返回。但是如果遇到多个返回值，PowerShell会将所有的返回值自动构造成一个对象数组。<br>可以通过索引访问数组</p>
<h5 id="Return语句"><a href="#Return语句" class="headerlink" title="Return语句"></a>Return语句</h5><p><code>Powershell</code> 会将函数中所有的输出作为返回值，但是也可以通过return语句指定具体的返回值。<br>Return 语句会将指定的值返回，同时也会中断函数的执行，<strong>return后面的语句会被忽略</strong></p>
<p>看一个例子</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">(<span class="variable">$num</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">1</span></span><br><span class="line">    <span class="number">9</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span></span><br><span class="line">    <span class="number">4</span></span><br><span class="line">    <span class="number">6</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="comment">&lt;# 1 和 9 作为输出会返回</span></span><br><span class="line"><span class="comment">return语句中的10 也会返回</span></span><br><span class="line"><span class="comment">return 语句后的4和6会被忽略#&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="访问返回值"><a href="#访问返回值" class="headerlink" title="访问返回值"></a>访问返回值</h5><p>一个函数返回了一个值还是多个值，是可以验证的。下面的例子会产生随机数，如果没有指定个数，默认会返回一个随机数，否则会返回指定个数的随机数</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lottery</span><span class="params">([int]<span class="variable">$number</span>=1)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$rand</span> = <span class="built_in">New-Object</span> system.random</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">1</span>; <span class="variable">$i</span> <span class="operator">-le</span> <span class="variable">$number</span>; <span class="variable">$i</span>++) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$rand</span>.next(<span class="number">1</span>,<span class="number">50</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数为空时，返回值不是数组:</span></span><br><span class="line"><span class="variable">$result</span> = lottery</span><br><span class="line"><span class="variable">$result</span> <span class="operator">-is</span> [<span class="built_in">array</span>]</span><br><span class="line">False</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果指定多个随机数时，返回值是数组类型:</span></span><br><span class="line"><span class="variable">$result</span> = lottery <span class="number">10</span></span><br><span class="line"><span class="variable">$result</span> <span class="operator">-is</span> [<span class="built_in">array</span>]</span><br><span class="line">True</span><br><span class="line"><span class="variable">$result</span>.count</span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>

<h5 id="从函数的返回值中消除输出"><a href="#从函数的返回值中消除输出" class="headerlink" title="从函数的返回值中消除输出"></a>从函数的返回值中消除输出</h5><p>函数默认会将函数中的所有输出作为函数的返回值返回，这样很方便。但有时可能会将不必要的输出误以为返回值。写脚本程序时，可能需要自定义一些函数，这个函数可能只需要一个返回值，但是为了提高函数的可读性，可能会在函数增加一些注释输出行，或者使用<code>write-host</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test</span><span class="params">()</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;Try to calculate.&quot;</span></span><br><span class="line">    <span class="string">&quot;3.1415926&quot;</span></span><br><span class="line">    <span class="string">&quot;Done.&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#保存在变量中输出,</span></span><br><span class="line"><span class="variable">$value</span>=Test</span><br><span class="line"><span class="variable">$value</span></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="keyword">Try</span> to calculate.</span><br><span class="line"><span class="number">3.1415926</span></span><br><span class="line">Done.</span><br><span class="line"> </span><br><span class="line"><span class="comment">#如果要过滤注释，只输出，不作为返回值，</span></span><br><span class="line"><span class="comment">#可以使用Write-Host命令</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test</span><span class="params">()</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Try to calculate.&quot;</span></span><br><span class="line">    <span class="string">&quot;3.1415926&quot;</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Done.&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 在变量值中保存返回值，在控制台输出注释行</span></span><br><span class="line"><span class="variable">$value</span>=Test</span><br><span class="line"><span class="comment">#控制台输出</span></span><br><span class="line"><span class="keyword">Try</span> to calculate.</span><br><span class="line">Done.</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 测试返回值</span></span><br><span class="line"><span class="variable">$value</span></span><br><span class="line"><span class="number">3.1415926</span></span><br></pre></td></tr></table></figure>

<p>恭喜你！到此 <code>PowerShell</code> 基础入门算是完成了！<br>之后将介绍 <code>PowerShell</code> 的进阶使用</p>
<h4 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h4><h5 id="PowerShell-Math类常用函数表"><a href="#PowerShell-Math类常用函数表" class="headerlink" title="PowerShell Math类常用函数表"></a>PowerShell Math类常用函数表</h5><table>
<thead>
<tr>
<th>函数名</th>
<th>调用写法</th>
<th>所在类</th>
<th>重载</th>
<th>描述</th>
<th>参数</th>
</tr>
</thead>
<tbody><tr>
<td>sin</td>
<td>[math]::sin(x)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x弧度的正弦值</td>
<td>double</td>
</tr>
<tr>
<td>cos</td>
<td>[math]::cos(x)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x弧度的余弦值</td>
<td>double</td>
</tr>
<tr>
<td>abs</td>
<td>[math]::abs(x)</td>
<td>System.Math</td>
<td>7</td>
<td>返回x的绝对值</td>
<td>所有数值型</td>
</tr>
<tr>
<td>sqrt</td>
<td>[math]::sqrt(x)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x的平方根</td>
<td>double</td>
</tr>
<tr>
<td>pow</td>
<td>[math]::pow(x,n)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x的n次幂</td>
<td>两参数都是double</td>
</tr>
<tr>
<td>log</td>
<td>[math]::log(x)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x的自然对数</td>
<td>double</td>
</tr>
<tr>
<td>log</td>
<td>[math]::log(x,n)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x的以n为底的对数</td>
<td>double</td>
</tr>
<tr>
<td>min</td>
<td>[math]::min(x,y)</td>
<td>System.Math</td>
<td>11</td>
<td>返回x，y中的最小值</td>
<td>所有数值型</td>
</tr>
<tr>
<td>max</td>
<td>[math]::max(x,y)</td>
<td>System.Math</td>
<td>11</td>
<td>返回x，y中的最大值</td>
<td>所有数值型</td>
</tr>
<tr>
<td>floor</td>
<td>[math]::ceiling(x)</td>
<td>System.Math</td>
<td>2</td>
<td>返回x向下取整的结果</td>
<td>double、decimal</td>
</tr>
<tr>
<td>ceiling</td>
<td>[math]::ceiling(x)</td>
<td>System.Math</td>
<td>2</td>
<td>返回x向上取整的结果</td>
<td>double、decimal</td>
</tr>
<tr>
<td><code>math</code> 类其他函数及详细用法参见微软文档: <a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/api/system.math?view=netframework-4.7.2#%E6%96%B9%E6%B3%95">Math类</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

  </div>
  
  
    
    <div class='footer'>
       <!-- 参考资料、相关资料等 -->
      
       <!-- 相关文章 -->
      
      <!-- 版权声明组件 -->
      
        
          <div class='copyright'>
            <blockquote>
              
                
                  <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

                
              
                
                  <p>本文永久链接是：<a href="https://www.lollipopnougat.top/2019/07/29/PowerShell入门指南(3)/">https://www.lollipopnougat.top/2019/07/29/PowerShell入门指南(3)/</a></p>
                
              
            </blockquote>
          </div>
        
      
      <!-- 打赏组件 -->
      
    </div>
  
  
    


  <div class='article-meta' id="bottom">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateModified" datetime="2021-04-25T23:24:47+08:00">
  <a class='notlink'>
    <i class="fa-solid fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2021年4月25日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/PowerShell/" rel="nofollow"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i><p>PowerShell</p></a></div>
  <span hidden itemprop="keywords">PowerShell</span>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.lollipopnougat.top/2019/07/29/PowerShell%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97(3)/&title=PowerShell入门指南(3) - LNP&summary=PowerShell入门指南(三)·一门新的编程语言
作为独立的编程语言作为一门独立的语言来说，PowerShell 是非常地Powerful，我们先来了解一下它的特点:"
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/qq.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/qq.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://www.lollipopnougat.top/2019/07/29/PowerShell%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97(3)/&title=PowerShell入门指南(3) - LNP&summary=PowerShell入门指南(三)·一门新的编程语言
作为独立的编程语言作为一门独立的语言来说，PowerShell 是非常地Powerful，我们先来了解一下它的特点:"
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/qzone.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/qzone.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.lollipopnougat.top/2019/07/29/PowerShell%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97(3)/&title=PowerShell入门指南(3) - LNP&summary=PowerShell入门指南(三)·一门新的编程语言
作为独立的编程语言作为一门独立的语言来说，PowerShell 是非常地Powerful，我们先来了解一下它的特点:"
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/weibo.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/weibo.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
    
      
    
  </div>
</div>



        
      
    </div>
    <!-- Custom Files bottomMeta begin -->
    
    <!-- Custom Files bottomMeta end -->
  </div>


  
  

  
    <div class="prev-next">
      
        <a class='prev' href='/2019/09/06/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%8F%E4%BC%9A%E7%BD%91%E7%AB%99%E7%9A%84%E6%90%AD%E5%BB%BA(1)/'>
          <p class='title'><i class="fa-solid fa-chevron-left" aria-hidden="true"></i>网络安全协会网站的搭建(一)</p>
          <p class='content'>网络安全协会网站的搭建一个网络安全协会要体现自己的特色，必须要有自己的网站才行啊特别是看了ACM协会的网站之后，更加坚定了开发的想法所以这个项目就出现了
网站预览


Vue.js 与 Node...</p>
        </a>
      
      
        <a class='next' href='/2019/04/30/%E8%AE%B0%E4%B8%80%E6%AC%A1express%E5%90%8E%E7%AB%AF%E7%9A%84%E6%90%AD%E5%BB%BA/'>
          <p class='title'>记一次express后端的搭建<i class="fa-solid fa-chevron-right" aria-hidden="true"></i></p>
          <p class='content'>Node.js作为网工人怎么能不会搭后端呢？今天就拿 Node.js 下的 Express 搭一个后端


Node.js 是什么东西你可能没听说过 Node.js，但是应该听说过 JavaSc...</p>
        </a>
      
    </div>
  
  <!-- Custom Files postEnd begin-->
  
  <!-- Custom Files postEnd end-->
</article>


  


  <article class="post white-box shadow floatable blur" id="comments">
    <span hidden>
      <meta itemprop="discussionUrl" content="/2019/07/29/PowerShell%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97(3)/index.html#comments">
    </span>
    <p ct><i class='fa-solid fa-comments'></i> 评论</p>
    

    <div id="layoutHelper-comments"></div>

  </article>






</div>
<aside id='l_side' itemscope itemtype="http://schema.org/WPSideBar">
  

  
    
    
      
<section class="widget blogger desktop mobile pjax">
  <div class='content'>
    
      
        <a class='avatar flat-box rectangle' href='/about/'>
          <img no-lazy src='https://www.lollipopnougat.top/picbed/33110314.png'/>
        </a>
      
    
    
      <div class='text'>
        
        
        
          <p><span id="jinrishici-sentence">LNP</span></p>
          <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="mailto:lollipopnougat@outlook.com"
              class="social fa-solid fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="https://github.com/lollipopnougat/"
              class="social fa-brands fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="https://www.zhihu.com/people/SDSR/activities"
              class="social fa-brands fa-zhihu flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="https://weibo.com/u/1949144895/"
              class="social fa-brands fa-weibo flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=505951930"
              class="social fa-solid fa-music flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
      </div>
    
  </div>
</section>

    
  

  
    
    
      
    
  

  
    
    
      
  
  <section class="widget category desktop pjax">
    
  <header>
    
      <a href='/categories/'><i class="fa-solid fa-folder-open fa-fw" aria-hidden="true"></i><span class='name'>文章分类</span></a>
    
  </header>


    <div class='content'>
      <ul class="entry navigation">
        
          <li><a class="flat-box"
            title="/categories/win32/" href="/categories/win32/"
            active-action="action-categorieswin32"
            ><div class='name'>win32</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/win32/%E6%B3%A8%E5%86%8C%E8%A1%A8/" href="/categories/win32/%E6%B3%A8%E5%86%8C%E8%A1%A8/"
            active-action="action-categorieswin32E6B3A8E5868CE8A1A8"
            ><div class='name'>注册表</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%89%8D%E7%AB%AF/" href="/categories/%E5%89%8D%E7%AB%AF/"
            active-action="action-categoriesE5898DE7ABAF"
            ><div class='name'>前端</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E5%89%8D%E7%AB%AF/HTML/" href="/categories/%E5%89%8D%E7%AB%AF/HTML/"
            active-action="action-categoriesE5898DE7ABAFHTML"
            ><div class='name'>HTML</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E5%89%8D%E7%AB%AF/vue/" href="/categories/%E5%89%8D%E7%AB%AF/vue/"
            active-action="action-categoriesE5898DE7ABAFvue"
            ><div class='name'>vue</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%90%8E%E7%AB%AF/" href="/categories/%E5%90%8E%E7%AB%AF/"
            active-action="action-categoriesE5908EE7ABAF"
            ><div class='name'>后端</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E5%90%8E%E7%AB%AF/Nodejs/" href="/categories/%E5%90%8E%E7%AB%AF/Nodejs/"
            active-action="action-categoriesE5908EE7ABAFNodejs"
            ><div class='name'>Nodejs</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%90%90%E6%A7%BD/" href="/categories/%E5%90%90%E6%A7%BD/"
            active-action="action-categoriesE59090E6A7BD"
            ><div class='name'>吐槽</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E6%9D%82%E8%B0%88/" href="/categories/%E6%9D%82%E8%B0%88/"
            active-action="action-categoriesE69D82E8B088"
            ><div class='name'>杂谈</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E6%9D%82%E8%B0%88/%E6%B2%A1%E5%95%A5%E7%94%A8%E7%9F%A5%E8%AF%86/" href="/categories/%E6%9D%82%E8%B0%88/%E6%B2%A1%E5%95%A5%E7%94%A8%E7%9F%A5%E8%AF%86/"
            active-action="action-categoriesE69D82E8B088E6B2A1E595A5E794A8E79FA5E8AF86"
            ><div class='name'>没啥用知识</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E7%88%AC%E8%99%AB%E5%BC%80%E5%8F%91/" href="/categories/%E7%88%AC%E8%99%AB%E5%BC%80%E5%8F%91/"
            active-action="action-categoriesE788ACE899ABE5BC80E58F91"
            ><div class='name'>爬虫开发</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E7%88%AC%E8%99%AB%E5%BC%80%E5%8F%91/python/" href="/categories/%E7%88%AC%E8%99%AB%E5%BC%80%E5%8F%91/python/"
            active-action="action-categoriesE788ACE899ABE5BC80E58F91python"
            ><div class='name'>python</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"
            active-action="action-categoriesE7BC96E7A88BE8AFADE8A880"
            ><div class='name'>编程语言</div><div class='badge'>(5)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/CSharp/" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/CSharp/"
            active-action="action-categoriesE7BC96E7A88BE8AFADE8A880CSharp"
            ><div class='name'>CSharp</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/PowerShell/" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/PowerShell/"
            active-action="action-categoriesE7BC96E7A88BE8AFADE8A880PowerShell"
            ><div class='name'>PowerShell</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Python/" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Python/"
            active-action="action-categoriesE7BC96E7A88BE8AFADE8A880Python"
            ><div class='name'>Python</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E8%8A%82%E6%97%A5%E7%A5%9D%E7%A6%8F/" href="/categories/%E8%8A%82%E6%97%A5%E7%A5%9D%E7%A6%8F/"
            active-action="action-categoriesE88A82E697A5E7A59DE7A68F"
            ><div class='name'>节日祝福</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E8%8A%82%E6%97%A5%E7%A5%9D%E7%A6%8F/%E5%85%83%E6%97%A6/" href="/categories/%E8%8A%82%E6%97%A5%E7%A5%9D%E7%A6%8F/%E5%85%83%E6%97%A6/"
            active-action="action-categoriesE88A82E697A5E7A59DE7A68FE58583E697A6"
            ><div class='name'>元旦</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E8%8A%82%E6%97%A5%E7%A5%9D%E7%A6%8F/%E6%98%A5%E8%8A%82/" href="/categories/%E8%8A%82%E6%97%A5%E7%A5%9D%E7%A6%8F/%E6%98%A5%E8%8A%82/"
            active-action="action-categoriesE88A82E697A5E7A59DE7A68FE698A5E88A82"
            ><div class='name'>春节</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" href="/categories/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"
            active-action="action-categoriesE99DA2E59091E5AFB9E8B1A1"
            ><div class='name'>面向对象</div><div class='badge'>(1)</div></a></li>
        
      </ul>
    </div>
  </section>


    
  

  
    
    
      
  
  <section class="widget tagcloud desktop mobile pjax">
    
  <header>
    
      <a href='/tags/'><i class="fa-solid fa-tags fa-fw" aria-hidden="true"></i><span class='name'>热门标签</span></a>
    
  </header>


    <div class='content'>
      <a href="/tags/C-C/" style="font-size: 14px; color: #999">C/C++</a> <a href="/tags/Express/" style="font-size: 14px; color: #999">Express</a> <a href="/tags/HTML/" style="font-size: 14px; color: #999">HTML</a> <a href="/tags/Node-js/" style="font-size: 14px; color: #999">Node.js</a> <a href="/tags/PowerShell/" style="font-size: 24px; color: #555">PowerShell</a> <a href="/tags/Vue-js/" style="font-size: 14px; color: #999">Vue.js</a> <a href="/tags/pip/" style="font-size: 14px; color: #999">pip</a> <a href="/tags/python/" style="font-size: 19px; color: #777">python</a> <a href="/tags/win32/" style="font-size: 19px; color: #777">win32</a> <a href="/tags/%E5%85%83%E6%97%A6/" style="font-size: 14px; color: #999">元旦</a> <a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size: 14px; color: #999">后端</a> <a href="/tags/%E5%90%90%E6%A7%BD/" style="font-size: 14px; color: #999">吐槽</a> <a href="/tags/%E6%98%A5%E8%8A%82/" style="font-size: 14px; color: #999">春节</a> <a href="/tags/%E6%9D%82%E8%B0%88/" style="font-size: 19px; color: #777">杂谈</a> <a href="/tags/%E6%B2%A1%E5%95%A5%E7%94%A8%E7%9F%A5%E8%AF%86/" style="font-size: 19px; color: #777">没啥用知识</a> <a href="/tags/%E6%B3%A8%E5%86%8C%E8%A1%A8/" style="font-size: 19px; color: #777">注册表</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 14px; color: #999">爬虫</a> <a href="/tags/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/" style="font-size: 19px; color: #777">网站搭建</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%8F%E4%BC%9A/" style="font-size: 14px; color: #999">网络安全协会</a> <a href="/tags/%E8%8A%82%E6%97%A5%E7%A5%9D%E7%A6%8F/" style="font-size: 19px; color: #777">节日祝福</a> <a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 14px; color: #999">面向对象</a>
    </div>
  </section>


    
  


<div class="widget-sticky pjax">

  
  


  <section class="widget toc-wrapper desktop mobile " id="toc-div" >
    
  <header>
    
      <i class="fa-solid fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#PowerShell%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97-%E4%B8%89-%C2%B7%E4%B8%80%E9%97%A8%E6%96%B0%E7%9A%84%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80"><span class="toc-text">PowerShell入门指南(三)·一门新的编程语言</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%9C%E4%B8%BA%E7%8B%AC%E7%AB%8B%E7%9A%84%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80"><span class="toc-text">作为独立的编程语言</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E7%82%B9"><span class="toc-text">特点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A0%B4%E5%A4%A9%E8%8D%92%E7%9A%84%E6%96%B9%E4%BE%BF"><span class="toc-text">破天荒的方便</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="toc-text">面向对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%9D%E6%89%98-NET"><span class="toc-text">依托 .NET</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%BA%E5%A4%A7%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-text">强大的兼容性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%B9%B3%E5%8F%B0%E7%9A%84%E5%8F%AF%E6%89%A9%E5%B1%95%E6%80%A7"><span class="toc-text">基于平台的可扩展性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Get-Help-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-text">使用Get-Help 快速入门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-text">基本语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-text">背景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E7%A9%BA%E7%99%BD%E5%AD%97%E7%AC%A6"><span class="toc-text">关于空白字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%9D%97%E5%92%8C%E4%BB%A3%E7%A0%81%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-text">代码块和代码基本结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PowerShell-%E8%84%9A%E6%9C%AC%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-text">PowerShell 脚本的基本结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E7%AD%96%E7%95%A5%E9%99%90%E5%88%B6"><span class="toc-text">执行策略限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C-PowerShell-%E8%84%9A%E6%9C%AC"><span class="toc-text">运行 PowerShell 脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%9B%E5%BB%BA%E8%84%9A%E6%9C%AC"><span class="toc-text">通过重定向创建脚本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E7%BC%96%E8%BE%91%E5%99%A8%E5%88%9B%E5%BB%BA%E8%84%9A%E6%9C%AC"><span class="toc-text">通过编辑器创建脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-text">变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%8F%98%E9%87%8F%E5%90%8D"><span class="toc-text">选择变量名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="toc-text">查看变量类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%8F%98%E9%87%8F"><span class="toc-text">删除变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B4%E5%9E%8B"><span class="toc-text">整型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%AE%E7%82%B9%E5%9E%8B"><span class="toc-text">浮点型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%AE%80%E5%8D%95%E7%B1%BB%E5%9E%8B"><span class="toc-text">其他简单类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B5%8B%E5%80%BC%E5%92%8C%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">赋值和返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%B1%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%BC%BA%E7%B1%BB%E5%9E%8B"><span class="toc-text">弱类型与强类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-text">类型转换</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%86%E6%94%AF"><span class="toc-text">条件分支</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#if-else"><span class="toc-text">if else</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#switch"><span class="toc-text">switch</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF"><span class="toc-text">循环</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#for%E5%BE%AA%E7%8E%AF"><span class="toc-text">for循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#do-while%E5%BE%AA%E7%8E%AF"><span class="toc-text">do-while循环</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%AA%E4%BD%BF%E7%94%A8while"><span class="toc-text">只使用while</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%B3%E5%87%BA%E5%BE%AA%E7%8E%AF"><span class="toc-text">跳出循环</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-text">数组</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%95%B0%E7%BB%84"><span class="toc-text">定义数组</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E6%95%B0%E7%BB%84%E7%9A%84%E5%A4%9A%E6%80%81"><span class="toc-text">对象数组的多态</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A9%BA%E6%95%B0%E7%BB%84%E5%92%8C%E5%8D%95%E5%85%83%E7%B4%A0%E6%95%B0%E7%BB%84"><span class="toc-text">空数组和单元素数组</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%95%B0%E7%BB%84"><span class="toc-text">使用数组</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%81%8D%E5%8E%86"><span class="toc-text">遍历</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%86%E6%95%B0%E7%BB%84%E9%80%86%E5%BA%8F%E8%BE%93%E5%87%BA"><span class="toc-text">将数组逆序输出</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%9F%90%E4%BA%9B%E5%85%83%E7%B4%A0"><span class="toc-text">访问某些元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8E%E6%95%B0%E7%BB%84%E4%B8%AD%E9%80%89%E6%8B%A9%E5%A4%9A%E4%B8%AA%E5%85%83%E7%B4%A0"><span class="toc-text">从数组中选择多个元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%99%E6%95%B0%E7%BB%84%E6%B7%BB%E5%8A%A0%E5%85%83%E7%B4%A0"><span class="toc-text">给数组添加元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E4%BD%8D%E7%BD%AE%E5%85%83%E7%B4%A0"><span class="toc-text">删除指定位置元素</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E5%88%B6%E6%95%B0%E7%BB%84"><span class="toc-text">复制数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%BA%E7%B1%BB%E5%9E%8B%E6%95%B0%E7%BB%84"><span class="toc-text">强类型数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%BF%94%E5%9B%9E%E6%95%B0%E7%BB%84"><span class="toc-text">命令返回数组</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%95%B0%E7%BB%84%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%9C"><span class="toc-text">使用数组存储结果</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%9C%9F%E5%AE%9E%E7%9A%84%E5%AF%B9%E8%B1%A1%E6%93%8D%E4%BD%9C"><span class="toc-text">使用真实的对象操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-text">定义函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E4%B8%AD%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9A%E4%B9%89%E6%96%B9%E6%B3%95"><span class="toc-text">脚本中函数的定义方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%8F%B0%E4%B8%8A%E5%A4%9A%E8%A1%8C%E8%BE%93%E5%85%A5%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-text">控制台上多行输入定义函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%8A%E5%87%BD%E6%95%B0%E7%B2%BE%E7%AE%80%E6%88%90%E4%B8%80%E8%A1%8C"><span class="toc-text">把函数精简成一行</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0%E4%BD%9C%E4%B8%BA%E5%88%AB%E5%90%8D"><span class="toc-text">使用函数作为别名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%87%BD%E6%95%B0"><span class="toc-text">更新函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%87%BD%E6%95%B0"><span class="toc-text">删除函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%87%BD%E6%95%B0"><span class="toc-text">输入输出函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BE%93%E5%85%A5"><span class="toc-text">输入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BE%93%E5%87%BA"><span class="toc-text">输出</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="toc-text">处理函数参数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#args-%E4%B8%87%E8%83%BD%E5%8F%82%E6%95%B0"><span class="toc-text">$args 万能参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9B%BA%E5%AE%9A%E5%8F%82%E6%95%B0"><span class="toc-text">使用固定参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%99%E5%8F%82%E6%95%B0%E5%AE%9A%E4%B9%89%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-text">给参数定义默认值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%BC%BA%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0"><span class="toc-text">使用强类型参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%99%90%E5%88%B6%E6%95%B0%E5%AD%97%E7%B1%BB%E5%9E%8B"><span class="toc-text">限制数字类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%99%90%E5%88%B6%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B"><span class="toc-text">限制日期类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Switch-%E5%8F%82%E6%95%B0"><span class="toc-text">Switch 参数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">指定函数的返回值</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AA%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">一个或多个返回值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Return%E8%AF%AD%E5%8F%A5"><span class="toc-text">Return语句</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">访问返回值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8E%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC%E4%B8%AD%E6%B6%88%E9%99%A4%E8%BE%93%E5%87%BA"><span class="toc-text">从函数的返回值中消除输出</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%84%E5%BD%95"><span class="toc-text">附录</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PowerShell-Math%E7%B1%BB%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E8%A1%A8"><span class="toc-text">PowerShell Math类常用函数表</span></a></li></ol></li></ol></li></ol>
    </div>
  </section>

  

</div>


<!-- 没有 pjax 占位会报错 万恶的 pjax -->

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <!-- Custom Files side begin -->
  
  <!-- Custom Files side end -->
</aside>



          <!--此文件用来存放一些不方便取值的变量-->
<!--思路大概是将值藏到重加载的区域内-->

<pjax>
<script>
  window.pdata={}
  pdata.ispage=true;
  pdata.commentPath="";
  pdata.commentPlaceholder="";
  pdata.commentConfig={};
  //  see: /layout/_partial/scripts/_ctrl/coverCtrl.ejs
  
    // header
    var l_header=document.getElementById("l_header");
    
    l_header.classList.add("show");
    
    
      // cover
      var cover_wrapper=document.querySelector('#l_cover .cover-wrapper');
      var scroll_down=document.getElementById('scroll-down');
      cover_wrapper.id="none";
      cover_wrapper.style.display="none";
      scroll_down.style.display="none";
    
  
</script>
</pjax>
        </div>
        
  
  <footer class="footer clearfix"  itemscope itemtype="http://schema.org/WPFooter">
    <br><br>
    
      
        <div class="aplayer-container">
          


        </div>
      
    
      
        <br>
        <div class="social-wrapper" itemprop="about" itemscope itemtype="http://schema.org/Thing">
          
            
              <a href="mailto:ab2defg145@126.com"
                class="social fa-solid fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://github.com/lollipopnougat/"
                class="social fa-solid fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://weibo.com/u/1949144895/"
                class="social fa-solid fa-weibo flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://www.zhihu.com/people/SDSR/activities"
                class="social fa-solid fa-zhihu flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://music.163.com/#/user/home?id=505951930"
                class="social fa-solid fa-music flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        
          <div><p><span id="lc-sv">本站总访问量为 <span id='number'><i class="fa-solid fa-loader fa-spin fa-fw" aria-hidden="true"></i></span> 次</span> <span id="lc-uv">访客数为 <span id='number'><i class="fa-solid fa-loader fa-spin fa-fw" aria-hidden="true"></i></span> 人</span></p>
</div>
        
      
    
      
        本站使用
        <a href="https://github.com/volantis-x/hexo-theme-volantis/#5.7.6" target="_blank" class="codename">Volantis</a>
        作为主题
      
    
      
        <div class='copyright'>
        <p><a href="/">Copyright © since 2017 XXX</a></p>

        </div>
      
    
    <!-- Custom Files footer begin-->
    
    <!-- Custom Files footer end-->
  </footer>


        <a id="s-top" class="fa-solid fa-arrow-up fa-fw" href="/" onclick="return false;" title="top"></a>
      </div>
    </div>
    <div>
      <script>
  /******************** volantis.dom ********************************/
  // 页面选择器 将dom对象缓存起来 see: /source/js/app.js etc.
  volantis.dom.bodyAnchor = volantis.dom.$(document.getElementById("safearea")); // 页面主体
  volantis.dom.topBtn = volantis.dom.$(document.getElementById('s-top')); // 向上
  volantis.dom.wrapper = volantis.dom.$(document.getElementById('wrapper')); // 整个导航栏
  volantis.dom.coverAnchor = volantis.dom.$(document.querySelector('#l_cover .cover-wrapper')); // 1个
  volantis.dom.switcher = volantis.dom.$(document.querySelector('#l_header .switcher .s-search')); // 搜索按钮   移动端 1个
  volantis.dom.header = volantis.dom.$(document.getElementById('l_header')); // 移动端导航栏
  volantis.dom.search = volantis.dom.$(document.querySelector('#l_header .m_search')); // 搜索框 桌面端 移动端 1个
  volantis.dom.mPhoneList = volantis.dom.$(document.querySelectorAll('#l_header .m-phone .list-v')); //  手机端 子菜单 多个
</script>

<script>
  
  volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fortawesome/fontawesome-free/css/all.min.css");
  
  
  
</script>

<!-- required -->


<!-- internal -->

<script src="/js/app.js"></script>





  













<div id="rightmenu-wrapper">
  <ul class="list-v rightmenu" id="rightmenu-content">
    
  <li class='navigation menuNavigation-Content'>


    <a class="nav icon-only fix-cursor-default" onclick="history.back()"><i class="fa-solid fa-arrow-left fa-fw"></i></a>



    <a class="nav icon-only fix-cursor-default" onclick="history.forward()"><i class="fa-solid fa-arrow-right fa-fw"></i></a>



    <a class="nav icon-only fix-cursor-default" onclick="window.location.reload()"><i class="fa-solid fa-redo fa-fw"></i></a>



    <a class="nav icon-only fix-cursor-default" onclick="VolantisApp.scrolltoElement(volantis.dom.bodyAnchor)"><i class="fa-solid fa-arrow-up fa-fw"></i></a>


  </li>


    <hr class="menuLoad-Content" >



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyPaste" data-event="copyPaste" data-group="inputBox">
      <i class="fa-solid fa-paste fa-fw"></i>
      粘贴文本
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyAll" data-event="copyAll" data-group="inputBox">
      <i class="fa-solid fa-object-ungroup fa-fw"></i>
      全选文本
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyCut" data-event="copyCut" data-group="inputBox">
      <i class="fa-solid fa-cut fa-fw"></i>
      剪切文本
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyText" data-event="copyText" data-group="seletctText">
      <i class="fa-solid fa-copy fa-fw"></i>
      复制文本
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="searchWord" data-event="OpenSearch(__text__)" data-group="seletctText">
      <i class="fa-solid fa-search fa-fw"></i>
      站内搜索
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="bingSearch" data-event="window.open(`https://cn.bing.com/search?q=${__text__}`)" data-group="seletctText">
      <i class="fa-solid fa-search fa-fw"></i>
      必应搜索
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="openTab" data-event="window.open(__link__)" data-group="elementCheck">
      <i class="fa-solid fa-external-link-square-alt fa-fw"></i>
      新标签页打开
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyLink" data-event="copyLink" data-group="elementCheck">
      <i class="fa-solid fa-link fa-fw"></i>
      复制链接地址
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyImg" data-event="copyImg" data-group="elementImage">
      <i class="fa-solid fa-image fa-fw"></i>
      复制图片
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="googleImg" data-event="window.open(`https://www.google.com.hk/searchbyimage?image_url=${__link__}`)" data-group="elementImage">
      <i class="fa-solid fa-images fa-fw"></i>
      谷歌识图
    </span>
  </li>



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="help" target="_blank" rel="noopener" href="https://volantis.js.org/faqs/" data-group="link">
      <i class="fa-solid fa-question fa-fw"></i>
      常见问题
    </a>
  </li>



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="examples" target="_blank" rel="noopener" href="https://volantis.js.org/examples/" data-group="link">
      <i class="fa-solid fa-rss fa-fw"></i>
      示例博客
    </a>
  </li>



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="contributors" target="_blank" rel="noopener" href="https://volantis.js.org/contributors/" data-group="link">
      <i class="fa-solid fa-fan fa-fw"></i>
      加入社区
    </a>
  </li>



    <hr class="menuLoad-Content" >



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="source_docs" target="_blank" rel="noopener" href="https://github.com/volantis-x/volantis-docs/" data-group="link">
      <i class="fa-solid fa-code-branch fa-fw"></i>
      本站源码
    </a>
  </li>



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="source_theme" target="_blank" rel="noopener" href="https://github.com/volantis-x/hexo-theme-volantis/" data-group="link">
      <i class="fa-solid fa-code-branch fa-fw"></i>
      主题源码
    </a>
  </li>



    <hr class="menuLoad-Content" >



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="darkMode" data-event="volantis.dark.toggle()" data-group="darkMode">
      <i class="fa-solid fa-moon fa-fw"></i>
      暗黑模式
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="printMode" data-event="printMode" data-group="articlePage">
      <i class="fa-solid fa-print fa-fw"></i>
      打印页面
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="readMode" data-event="readMode" data-group="articlePage">
      <i class="fa-solid fa-book-open fa-fw"></i>
      阅读模式
    </span>
  </li>


<div id="menuMusic">
  <li class='music name menuOption-Content'>
    <p class='nav music-title fix-cursor-default'></p>
  </li>
  <li class='music ctrl'>
    <a class='nav icon-only backward fix-cursor-default' href="/" onclick="return false;" title="backward">
      <i class='fa-solid fa-step-backward fa-fw'></i>
    </a>
    <a class='nav icon-only toggle fix-cursor-default' href="/" onclick="return false;" title="toggle">
      <i class='fa-solid fa-play fa-fw'></i>
    </a>
    <a class='nav icon-only forward fix-cursor-default' href="/" onclick="return false;" title="forward">
      <i class='fa-solid fa-step-forward fa-fw'></i>
    </a>
  </li>
  <li class='music volume'>
    <div class='nav volume'>
      <div class="aplayer-volume-bar-wrap">
        <div class="aplayer-volume-bar fix-cursor-pointer">
          <div class="aplayer-volume"></div>
          <i class='left fa-solid fa-volume-off fa-fw'></i>
          <i class='right fa-solid fa-volume-up fa-fw'></i>
        </div>
      </div>
    </div>
  </li>
</div>

  </ul>
</div>
<script src="/js/plugins/rightMenus.js"></script>
<script>
  const RightMenusFunction = {};
  












  //RightMenusFunction['copyPaste'] = (fun) => {fun()}





  //RightMenusFunction['copyAll'] = (fun) => {fun()}





  //RightMenusFunction['copyCut'] = (fun) => {fun()}





  //RightMenusFunction['copyText'] = (fun) => {fun()}





  RightMenusFunction['searchWord'] = (__text__) => {OpenSearch(__text__)}





  RightMenusFunction['bingSearch'] = (__text__) => {window.open(`https://cn.bing.com/search?q=${__text__}`)}





  RightMenusFunction['openTab'] = (__link__) => {window.open(__link__)}





  //RightMenusFunction['copyLink'] = (fun) => {fun()}





  //RightMenusFunction['copyImg'] = (fun) => {fun()}





  RightMenusFunction['googleImg'] = (__link__) => {window.open(`https://www.google.com.hk/searchbyimage?image_url=${__link__}`)}



















  RightMenusFunction['darkMode'] = () => {volantis.dark.toggle()}





  //RightMenusFunction['printMode'] = (fun) => {fun()}





  //RightMenusFunction['readMode'] = (fun) => {fun()}





</script>



<!-- rightmenu要在darkmode之前（ToggleButton） darkmode要在comments之前（volantis.dark.push）-->

  <script>
const rootElement = document.documentElement;
const darkModeStorageKey = "color-scheme";
const rootElementDarkModeAttributeName = "color-scheme";
const setLS = (k, v) => {
    localStorage.setItem(k, v);
};
const removeLS = (k) => {
    localStorage.removeItem(k);
};
const getLS = (k) => {
    return localStorage.getItem(k);
};
const getModeFromCSSMediaQuery = () => {
  return window.matchMedia("(prefers-color-scheme: dark)").matches
    ? "dark"
    : "light";
};
const resetRootDarkModeAttributeAndLS = () => {
  rootElement.removeAttribute(rootElementDarkModeAttributeName);
  removeLS(darkModeStorageKey);
};
const validColorModeKeys = {
  dark: true,
  light: true,
};
const applyCustomDarkModeSettings = (mode) => {
  const currentSetting = mode || getLS(darkModeStorageKey);
  getCustomDarkMode();
  if (currentSetting === getModeFromCSSMediaQuery()) {
    resetRootDarkModeAttributeAndLS();
  } else if (validColorModeKeys[currentSetting]) {
    rootElement.setAttribute(rootElementDarkModeAttributeName, currentSetting);
  } else {
    resetRootDarkModeAttributeAndLS();
  }
};
const invertDarkModeObj = {
  dark: "light",
  light: "dark",
};
/**
 * get target mode
 */
 const getCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  if(currentSetting=="dark"){
    volantis.dark.mode="light";
  }else{
    volantis.dark.mode="dark";
  }
  // console.log(volantis.dark.mode)
};
const toggleCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  setLS(darkModeStorageKey, currentSetting);
  return currentSetting;
};
/**
 * 暗黑模式触发器
 */
volantis.dark.toggle=()=>{
  const mode = toggleCustomDarkMode();
  applyCustomDarkModeSettings(mode);
  // 使用 volantis.dark.push 方法传入volantis.dark.toggle回调函数 参见layout/_partial/scripts/global.ejs
  volantis.dark.method.toggle.start();
}
/**
 * bind event for toggle button
 */

function bindToggleButton() {
  var btn= document.querySelectorAll("#wrapper .toggle-mode-btn,#rightmenu-wrapper .toggle-mode-btn")
  btn.forEach(function (e) {
    volantis.dom.$(e).on('click',volantis.dark.toggle);
  })
}
applyCustomDarkModeSettings();
document.addEventListener("DOMContentLoaded", ()=>{
  volantis.requestAnimationFrame(bindToggleButton)
});
volantis.pjax.push(bindToggleButton);

const darkModelListeners={
  dark:(mediaQueryList )=>{
    if(mediaQueryList.matches){
      volantis.dark.mode = "dark";
    }
    volantis.dark.method.toggle.start();
  },
  light:(mediaQueryList)=>{
    if(mediaQueryList.matches){
      volantis.dark.mode = "light";
    }
    volantis.dark.method.toggle.start();
  }
}
window.matchMedia('(prefers-color-scheme: dark)').addListener(darkModelListeners.dark)
window.matchMedia('(prefers-color-scheme: light)').addListener(darkModelListeners.light)
</script>




<script>
  function loadIssuesJS() {
    
      const sites_api = document.getElementById('sites-api');
      if (sites_api != undefined && typeof SitesJS === 'undefined') {
        volantis.js("/js/plugins/tags/sites.js")
      }
    
    
      const friends_api = document.getElementById('friends-api');
      if (friends_api != undefined && typeof FriendsJS === 'undefined') {
        volantis.js("/js/plugins/tags/friends.js")
      }
    
    
      const contributors_api = document.getElementById('contributors-api');
      if (contributors_api != undefined && typeof ContributorsJS === 'undefined') {
        volantis.js("/js/plugins/tags/contributors.js")
      }
    
  };
  loadIssuesJS()
  volantis.pjax.push(()=>{
    loadIssuesJS();
  })

</script>




  <script defer src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/vanilla-lazyload/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
  document.addEventListener('pjax:complete', function () {
    lazyLoadInstance.update();
  });
</script>




  

<script>
  window.FPConfig = {
	delay: 0,
	ignoreKeywords: ["#"],
	maxRPS: 6,
	hoverDelay: 0
  };
</script>
<script defer src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/flying-pages/flying-pages.min.js"></script>









      <script type="text/javascript">
  volantis.layoutHelper("comments",`<div id="gitalk-container"></div>`)
  function pjax_gitalk() {
    if(!document.querySelector("#gitalk-container"))return;
    let path = pdata.commentPath;
    if (path.length == 0) {
      let defaultPath = '';
      path = defaultPath || decodeURI(window.location.pathname);
    }
    if (document.getElementById('gitalk-container') != null) {
      var gitalk = new Gitalk(
        Object.assign(
          Object.assign({"js":"https://unpkg.com/gitalk@1/dist/gitalk.min.js","clientID":"f37d30d4d42490525d92","clientSecret":"760392841209c5cf53a8b851d732a03fa627130a","repo":"lollipopnougat.github.io","owner":"lollipopnougat","admin":["lollipopnougat"],"path":null}, {
            id: path,
            distractionFreeMode: false  // Facebook-like distraction free mode
          }),
        pdata.commentConfig)
      );
      gitalk.render('gitalk-container');
    }
  }
  volantis.js('https://unpkg.com/gitalk@1/dist/gitalk.min.js').then(pjax_gitalk)
  volantis.pjax.push(pjax_gitalk);
</script>

    





<!-- optional -->

  <script>
  const SearchServiceDataPathRoot = ("/" || "/").endsWith("/") ?
    "/" || "/" :
    "//" || "/";
  const SearchServiceDataPath = SearchServiceDataPathRoot + "content.json";

  function loadSearchScript() {
    // see: layout/_partial/scripts/_ctrl/cdnCtrl.ejs
    return volantis.js("/js/search/hexo.js");
  }

  function loadSearchService() {
    loadSearchScript();
    document.querySelectorAll(".input.u-search-input").forEach((e) => {
      e.removeEventListener("focus", loadSearchService, false);
    });

    document.querySelectorAll(".u-search-form").forEach((e) => {
      e.addEventListener("submit", (event) => {
        event.preventDefault();
      }, false);
    });
  }

  // 打开并搜索 字符串 s
  function OpenSearch(s) {
    if (typeof SearchService === 'undefined')
      loadSearchScript().then(() => {
        SearchService.setQueryText(s);
        SearchService.search();
      });
    else {
      SearchService.setQueryText(s);
      SearchService.search();
    }
  }

  // 访问含有 ?s=xxx  的链接时打开搜索 // 与搜索引擎 structured data 相关: /scripts/helpers/structured-data/lib/config.js
  if (window.location.search && /^\?s=/g.test(window.location.search)) {
    let queryText = decodeURI(window.location.search)
      .replace(/\ /g, "-")
      .replace(/^\?s=/g, "");
    OpenSearch(queryText);
  }

  // 搜索输入框获取焦点时加载搜索
  document.querySelectorAll(".input.u-search-input").forEach((e) => {
    e.addEventListener("focus", loadSearchService, false);
  });
</script>







  <script>



  function pjax_highlightjs_copyCode(){
    if (!(document.querySelector(".highlight .code pre") ||
      document.querySelector(".article pre code"))) {
      return;
    }
    VolantisApp.utilCopyCode(".highlight .code pre, .article pre code")
  }
  volantis.requestAnimationFrame(pjax_highlightjs_copyCode)
  volantis.pjax.push(pjax_highlightjs_copyCode)

</script>












  <script>
  function load_swiper() {
    if (!document.querySelectorAll(".swiper-container")[0]) return;
    volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/swiper/swiper-bundle.min.css");
    volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/swiper/swiper-bundle.min.js").then(() => {
      pjax_swiper();
    });
  }

  load_swiper();

  function pjax_swiper() {
    volantis.swiper = new Swiper('.swiper-container', {
      slidesPerView: 'auto',
      spaceBetween: 8,
      centeredSlides: true,
      loop: true,
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
    });
  }

  volantis.pjax.push(() => {
    if (!document.querySelectorAll(".swiper-container")[0]) return;
    if (typeof volantis.swiper === "undefined") {
      load_swiper();
    } else {
      pjax_swiper();
    }
  });
</script>


<!-- pjax 标签必须存在于所有页面 否则 pjax error -->
<pjax>

</pjax>

<script>
  function listennSidebarTOC() {
    const navItems = document.querySelectorAll(".toc li");
    if (!navItems.length) return;
    let targets = []
    const sections = [...navItems].map((element) => {
      const link = element.querySelector(".toc-link");
      const target = document.getElementById(
        decodeURI(link.getAttribute("href")).replace("#", "")
      );
      targets.push(target)
      // 解除 a 标签 href 的 锚点定位, a 标签 href 的 锚点定位 会随机启用?? 产生错位???
      link.setAttribute("onclick","return false;")
      link.setAttribute("toc-action","toc-"+decodeURI(link.getAttribute("href")).replace("#", ""))
      link.setAttribute("href","/")
      // 配置 点击 触发新的锚点定位
      link.addEventListener("click", (event) => {
        event.preventDefault();
        // 这里的 addTop 是通过错位使得 toc 自动展开.
        volantis.scroll.to(target,{addTop: 5, observer:true})
        // Anchor id
        history.pushState(null, document.title, "#" + target.id);
      });
      return target;
    });

    function activateNavByIndex(target) {
      if (target.classList.contains("active-current")) return;

      document.querySelectorAll(".toc .active").forEach((element) => {
        element.classList.remove("active", "active-current");
      });
      target.classList.add("active", "active-current");
      let parent = target.parentNode;
      while (!parent.matches(".toc")) {
        if (parent.matches("li")) parent.classList.add("active");
        parent = parent.parentNode;
      }
    }

    // 方案一：
    volantis.activateNavIndex=0
    activateNavByIndex(navItems[volantis.activateNavIndex])
    volantis.scroll.push(()=>{
      if (targets[0].getBoundingClientRect().top >= 0) {
        volantis.activateNavIndex = 0
      }else if (targets[targets.length-1].getBoundingClientRect().top < 0) {
        volantis.activateNavIndex = targets.length-1
      } else {
        for (let index = 0; index < targets.length; index++) {
          const target0 = targets[index];
          const target1 = targets[(index+1)%targets.length];
          if (target0.getBoundingClientRect().top < 0&&target1.getBoundingClientRect().top >= 0) {
            volantis.activateNavIndex=index
            break;
          }
        }
      }
      activateNavByIndex(navItems[volantis.activateNavIndex])
    })

    // 方案二：
    // IntersectionObserver 不是完美精确到像素级别 也不是低延时性的
    // function findIndex(entries) {
    //   let index = 0;
    //   let entry = entries[index];
    //   if (entry.boundingClientRect.top > 0) {
    //     index = sections.indexOf(entry.target);
    //     return index === 0 ? 0 : index - 1;
    //   }
    //   for (; index < entries.length; index++) {
    //     if (entries[index].boundingClientRect.top <= 0) {
    //       entry = entries[index];
    //     } else {
    //       return sections.indexOf(entry.target);
    //     }
    //   }
    //   return sections.indexOf(entry.target);
    // }
    // function createIntersectionObserver(marginTop) {
    //   marginTop = Math.floor(marginTop + 10000);
    //   let intersectionObserver = new IntersectionObserver(
    //     (entries, observe) => {
    //       let scrollHeight = document.documentElement.scrollHeight;
    //       if (scrollHeight > marginTop) {
    //         observe.disconnect();
    //         createIntersectionObserver(scrollHeight);
    //         return;
    //       }
    //       let index = findIndex(entries);
    //       activateNavByIndex(navItems[index]);
    //     }, {
    //       rootMargin: marginTop + "px 0px -100% 0px",
    //       threshold: 0,
    //     }
    //   );
    //   sections.forEach((element) => {
    //     element && intersectionObserver.observe(element);
    //   });
    // }
    // createIntersectionObserver(document.documentElement.scrollHeight);
  }

  document.addEventListener("DOMContentLoaded", ()=>{
    volantis.requestAnimationFrame(listennSidebarTOC)
  });
  document.addEventListener("pjax:success", ()=>{
    volantis.requestAnimationFrame(listennSidebarTOC)
  });
</script>



<script>
  document.onreadystatechange = function () {
    if (document.readyState == 'complete') {
      // 页面加载完毕 样式加载失败，或是当前网速慢，或是开启了省流模式
      const { saveData, effectiveType } = navigator.connection || navigator.mozConnection || navigator.webkitConnection || {}
      if (getComputedStyle(document.querySelector("#safearea"), null)["display"] == "none" || saveData || /2g/.test(effectiveType)) {
        document.querySelectorAll(".reveal").forEach(function (e) {
          e.style["opacity"] = "1";
        });
        document.querySelector("#safearea").style["display"] = "block";
      }
    }
  }
</script>


  <script type="application/ld+json">[{"@context":"http://schema.org","@type":"Organization","name":"LNP","url":"https://www.lollipopnougat.top/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},{"@context":"http://schema.org","@type":"Person","name":"lollipopnougat","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://www.lollipopnougat.top/","sameAs":["https://github.com/volantis-x"],"description":""},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://www.lollipopnougat.top/","name":"LNP"}},{"@type":"ListItem","position":2,"item":{"@id":"https://www.lollipopnougat.top/categories/编程语言/","name":"编程语言"}},{"@type":"ListItem","position":2,"item":{"@id":"https://www.lollipopnougat.top/categories/编程语言/PowerShell/","name":"PowerShell"}},{"@type":"ListItem","position":3,"item":{"@id":"https://www.lollipopnougat.top/2019/07/29/PowerShell入门指南(3)/","name":"PowerShell入门指南(3)"}}]},{"@context":"http://schema.org","@type":"WebSite","name":"LNP","url":"https://www.lollipopnougat.top/","keywords":null,"description":"","author":{"@type":"Person","name":"lollipopnougat","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://www.lollipopnougat.top/","description":""},"publisher":{"@type":"Organization","name":"LNP","url":"https://www.lollipopnougat.top/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"potentialAction":{"@type":"SearchAction","name":"Site Search","target":{"@type":"EntryPoint","urlTemplate":"https://www.lollipopnougat.top?s={search_term_string}"},"query-input":"required name=search_term_string"}},{"@context":"http://schema.org","@type":"BlogPosting","headline":"PowerShell入门指南(3)","description":"PowerShell入门指南(三)·一门新的编程语言\n作为独立的编程语言作为一门独立的语言来说，PowerShell 是非常地Powerful，我们先来了解一下它的特点:","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.lollipopnougat.top/2019/07/29/PowerShell%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97(3)/"},"author":{"@type":"Person","name":"lollipopnougat","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://www.lollipopnougat.top/"},"publisher":{"@type":"Organization","name":"LNP","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"url":"https://www.lollipopnougat.top/2019/07/29/PowerShell%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97(3)/","wordCount":85,"datePublished":"2019-07-29T01:56:12.000Z","dateModified":"2021-04-25T15:24:47.976Z","articleSection":"编程语言","keywords":"PowerShell","image":{"@type":"ImageObject","url":"https://gcore.jsdelivr.net/gh/lollipopnougat/website-calculator/img/powershell.png","width":1024,"height":768}}]</script>



      
        <!--
  pjax重载区域接口：
  1.  <pjax></pjax> 标签 pjax 标签必须存在于所有页面 否则 pjax error
  2.  script[data-pjax]
  3.  .pjax-reload script
  4.  .pjax
-->



<script src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/pjax/pjax.min.js"></script>


<script>
    var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox]):not([onclick="return false;"]):not([onclick="return!1"]):not([target="_blank"]):not([target="view_window"]):not([href$=".xml"])',
        selectors: [
          "head title",
          "head meta[name=keywords]",
          "head meta[name=description]",
          
          "#l_main",
          "#pjax-header-nav-list",
          ".pjax",
          "pjax", // <pjax></pjax> 标签
          "script[data-pjax], .pjax-reload script" // script标签添加data-pjax 或 script标签外层添加.pjax-reload 的script代码段重载
        ],
        cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
        timeout: 5000,
        
      });
    });

    document.addEventListener('pjax:send', function (e) {
      //window.stop(); // 相当于点击了浏览器的停止按钮

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      // 使用 volantis.pjax.send 方法传入pjax:send回调函数 参见layout/_partial/scripts/global.ejs
      volantis.pjax.method.send.start();
    });

    document.addEventListener('pjax:complete', function () {
      // 使用 volantis.pjax.push 方法传入重载函数 参见layout/_partial/scripts/global.ejs
      volantis.pjax.method.complete.start();
    });

    document.addEventListener('pjax:error', function (e) {
      if(volantis.debug) {
        console.error(e);
        console.log('pjax error: \n' + JSON.stringify(e));
      }else{
        // 使用 volantis.pjax.error 方法传入pjax:error回调函数 参见layout/_partial/scripts/global.ejs
        volantis.pjax.method.error.start();
        window.location.href = e.triggerElement.href;
      }
    });
</script>

      
    </div>
    <!-- import body_end begin-->
    <!-- import body_end end-->
    <!-- Custom Files bodyEnd begin-->
    
    <!-- Custom Files bodyEnd end-->
  </body>
</html>
