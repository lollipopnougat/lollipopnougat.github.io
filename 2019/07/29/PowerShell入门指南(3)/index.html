<!DOCTYPE html>
<html>
<head hexo-theme="Volantis" version="1.5.4" docs="https://xaoxuu.com/wiki/volantis/"><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>PowerShell入门指南(3) | LNP</title>
  
  

  
  <link rel="alternate" href="/Crepeblog/atom.xml" title="LNP">
  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css">
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  

  

  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  
  <link rel="stylesheet" href="/Crepeblog/style.css">
  
  <link rel="icon" type="image/x-icon" sizes="64x64" href="https://cdn.jsdelivr.net/gh/lollipopnougat/picbed/favicon.ico">

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width = num + "%";
    }
    var _hmt = _hmt || [];
    (function () {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?23b906b10aa5d808fd3fa1073b94b427";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>

  
  
</head>
<body>
  
  
  <div class="cover-wrapper">
    <cover class='cover post half'>
      
        
  <p class="title white">lnp's blog</p>
  
    <p class="subtitle white">没什么存在感的博客</p>
  


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <i class="icon fas fa-search fa-fw"></i>
      <input type="text" class="input u-search-input" placeholder="搜索文章" />
    </form>
  </div>

<div class='menu navigation'>
  <ul class='h-list'>
    
      
        <li>
          <a class="nav home white"
            href="/Crepeblog/"
            
            
            id="Crepeblog">
            <i class='fas fa-bullhorn fa-fw'></i>&nbsp;所有文章
          </a>
        </li>
      
        <li>
          <a class="nav home white"
            href="/Crepeblog/projects"
            
            
            id="Crepeblogprojects">
            <i class='fas fa-book fa-fw'></i>&nbsp;我的项目
          </a>
        </li>
      
        <li>
          <a class="nav home white"
            href="https://github.com/lollipopnougat?tab=repositories"
            
              rel="nofollow"
            
            
              target="_blank"
            
            id="https:github.comlollipopnougat?tab=repositories">
            <i class='fas fa-code-branch fa-fw'></i>&nbsp;GitHub项目
          </a>
        </li>
      
        <li>
          <a class="nav home white"
            href="/Crepeblog/friends"
            
              rel="nofollow"
            
            
            id="Crepeblogfriends">
            <i class='fas fa-handshake fa-fw'></i>&nbsp;朋友
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header nav-blur">
  <div id="loading-bar-wrapper">
    <div id="loading-bar"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" target="_self" href='/Crepeblog/' >
        
          
            <i class='https://cdn.jsdelivr.net/gh/lollipopnougat/picbed/favicon.ico'></i>
          
          
            LNP
          
        
      </a>
			<div class='menu navigation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/Crepeblog/"
                  
                    rel="nofollow"
                  
                  
                    target="_self"
                  
                  id="Crepeblog">
									<i class='fas fa-flag fa-fw'></i>&nbsp;所有文章
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/Crepeblog/atom.xml"
                  
                  
                    target="_self"
                  
                  id="Crepeblogatom.xml">
									<i class='fas fa-globe-asia fa-fw'></i>&nbsp;RSS订阅
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/Crepeblog/projects"
                  
                  
                    target="_self"
                  
                  id="Crepeblogprojects">
									<i class='fas fa-cube fa-fw'></i>&nbsp;项目
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/Crepeblog/archives"
                  
                    rel="nofollow"
                  
                  
                    target="_self"
                  
                  id="Crepeblogarchives">
									<i class='fas fa-archive fa-fw'></i>&nbsp;归档
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/Crepeblog/friends"
                  
                    rel="nofollow"
                  
                  
                    target="_self"
                  
                  id="Crepeblogfriends">
									<i class='fas fa-users fa-fw'></i>&nbsp;朋友
								</a>
							</li>
      			
      		
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="搜索文档" />
        </form>
      </div>

			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone white-box">
    <header>
		<nav class="menu navigation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/Crepeblog/"
                
                  rel="nofollow"
                
                
                  target="_self"
                
                id="Crepeblog">
								<i class='fas fa-flag fa-fw'></i>&nbsp;所有文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/Crepeblog/atom.xml"
                
                
                  target="_self"
                
                id="Crepeblogatom.xml">
								<i class='fas fa-globe-asia fa-fw'></i>&nbsp;RSS订阅
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/Crepeblog/projects"
                
                
                  target="_self"
                
                id="Crepeblogprojects">
								<i class='fas fa-cube fa-fw'></i>&nbsp;项目
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/Crepeblog/archives"
                
                  rel="nofollow"
                
                
                  target="_self"
                
                id="Crepeblogarchives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/Crepeblog/friends"
                
                  rel="nofollow"
                
                
                  target="_self"
                
                id="Crepeblogfriends">
								<i class='fas fa-users fa-fw'></i>&nbsp;朋友
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box  body-blur article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/Crepeblog/2019/07/29/PowerShell入门指南(3)/">
        PowerShell入门指南(3)
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    
      <a href="https://lollipopnougat.github.io/Crepeblog" rel="nofollow">
        
          <i class="fas fa-user" aria-hidden="true"></i>
        
        <p>LNP.</p>
      </a>
    
  </div>


          
        
          
            

          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-edit" aria-hidden="true"></i>
    <p>消息发布于：2019年7月29日</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <h3 id="PowerShell入门指南-三-·一门新的编程语言"><a href="#PowerShell入门指南-三-·一门新的编程语言" class="headerlink" title="PowerShell入门指南(三)·一门新的编程语言"></a>PowerShell入门指南(三)·一门新的编程语言</h3><hr>
<h4 id="作为独立的编程语言"><a href="#作为独立的编程语言" class="headerlink" title="作为独立的编程语言"></a>作为独立的编程语言</h4><p>作为一门独立的语言来说，<code>PowerShell</code> 是非常地Powerful，我们先来了解一下它的特点:</p>
<a id="more"></a>

<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li><h4 id="破天荒的方便"><a href="#破天荒的方便" class="headerlink" title="破天荒的方便"></a>破天荒的方便</h4><p>诸如存储计算中 <code>GB</code>， <code>MB</code>， <code>KB</code> 单位等；数组声明中的 <code>1..n</code> 和下标为 <code>-1</code> 的处理；还有所见即所得，通俗易懂的<strong>动词</strong>+<strong>名词</strong>结构的Cmdlet(PowerShell命令的称呼)。<br>还有自带的文档支持也很是丰富，只要熟练掌握 <code>Get-Help</code> 命令，其他命令的用法均可通过 <code>Get-Help</code> 查到</p>
</li>
<li><h4 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h4><p>良心啊，这个语言竟然是面向对象的<br>与面向过程相比，面向对象更方便更容易描述现实世界，也算赶上了时髦。</p>
</li>
<li><h4 id="依托-NET"><a href="#依托-NET" class="headerlink" title="依托 .NET"></a>依托 .NET</h4><p>正所谓大树下面好乘凉，<code>PowerShell</code> 绑上 <code>.NET</code> 这个大款了，借助 <code>.NET</code> 平台强大的类库，几乎让一切都成为可能。</p>
</li>
<li><h4 id="强大的兼容性"><a href="#强大的兼容性" class="headerlink" title="强大的兼容性"></a>强大的兼容性</h4><p>完全兼容 <code>Windows</code> 平台上其它调用，如可执行文件(exe)，批处理bat/cmd和VBscript等, 在 <code>Linux</code> 和 <code>macOS</code> 上也能很好地工作。</p>
</li>
<li><h4 id="基于平台的可扩展性"><a href="#基于平台的可扩展性" class="headerlink" title="基于平台的可扩展性"></a>基于平台的可扩展性</h4><p>微软有个优点，与应用相比，它更喜欢做平台。<code>PowerShell</code> 早已变成一个平台，在 <code>PowerShell</code> 刚发布的第二年，微软的 System Center Operations Manager 和 SharePoint 就提供了针对该平台的组件，后来的活动目录，Hyper-V，Windows Azure，Office 365就更不用说了。除了微软，亚马逊的云平台管理，Dell的out-of-hand 管理，也都提供了基于 <code>PowerShell</code> 的管理组件。<code>PowerShell</code> 俨然变成了一个标准，变成了一个规范。</p>
</li>
</ul>
<hr>
<h3 id="使用Get-Help-快速入门"><a href="#使用Get-Help-快速入门" class="headerlink" title="使用Get-Help 快速入门"></a>使用<code>Get-Help</code> 快速入门</h3><p>下面用一个简单例子说明如何<code>Get-Help</code>，设想这样一个场景：<br>你想通过命令行查看所有进程，你第一个反应应该是用一个跟Process相关的命令来达到此目的，所以你可以会尝试执行：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Command</span> *<span class="keyword">Process</span></span><br><span class="line"><span class="comment">#结果</span></span><br><span class="line">CommandType     Name                   Version    Source</span><br><span class="line">-----------     ----                   -------    ------</span><br><span class="line">Cmdlet          <span class="built_in">Debug-Process</span>          <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          Enter-PSHostProcess    <span class="number">3.0</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Core</span><br><span class="line">Cmdlet          Exit-PSHostProcess     <span class="number">3.0</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Core</span><br><span class="line">Cmdlet          <span class="built_in">Get-Process</span>            <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          <span class="built_in">Start-Process</span>          <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          <span class="built_in">Stop-Process</span>           <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Management</span><br><span class="line">Cmdlet          <span class="built_in">Wait-Process</span>           <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerShell.Management</span><br></pre></td></tr></table></figure>

<p>得知处理进程的命令有这些<br>然后再用 <code>Get-Help Get-Process -full</code> 就能得到 <code>Get-Process</code> 的详细用法以及使用范例</p>
<h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p><code>PowerShell</code> 是一个强类型(变量一旦定义，其本身类型不可改变就是强类型，反之就是弱类型)的动态脚本语言，支持面向对象，支持调用系统API和 <code>.NET</code> 库。<br>受到了 <code>Python</code>, <code>Ksh</code>, <code>Perl</code>, <code>C#</code>, <code>CL</code>, <code>DCL</code>, <code>SQL</code>, <code>Tcl</code>, <code>Tk</code>, <code>Chef</code>, <code>Puppet</code> 等语言的影响，结合了以上语言的部分特性。</p>
<p><code>PowerShell</code> 代码的外观和操作方式与C#的相似程度最高，不过也有它自己的特色。</p>
<h4 id="关于空白字符"><a href="#关于空白字符" class="headerlink" title="关于空白字符"></a>关于空白字符</h4><p>与 <code>Python</code> 等语言不同，<strong><code>PowerShell</code> 的解释器不会考虑代码中的空格或制表符</strong>(这些字符统称空白字符)。这样一来，格式化代码就有很大的自由度，但是遵循某些规则将有助于提高代码的可读性。</p>
<h4 id="代码块和代码基本结构"><a href="#代码块和代码基本结构" class="headerlink" title="代码块和代码基本结构"></a>代码块和代码基本结构</h4><p><code>PowerShell</code> 代码由一系列语句构成，每条语句可以使用一个分号结束，当然也可以不写。<strong>按照习惯是不写分号的，因此要用换行来区分不同的语句，如果必须写到一行中，那就在每一句后加个分号</strong>。</p>
<p>和C语系的大多数语言类似，<code>PowerShell</code> 是一种块结构的语言，这些块用 <code>{</code> 和 <code>}</code> 来界定，代码块可以包含任意多条语句，或者不包含任何语句，下面的示例还使用了缩进格式，这样能大大提高可读性，实际上编译器会自带缩进代码。一般情况下，每个代码块都有自己的缩进级别，代码块之间还能嵌套。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">&lt;#代码行1#&gt;</span></span><br><span class="line">    <span class="comment">&lt;#代码行2#&gt;</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">&lt;#代码行3#&gt;</span></span><br><span class="line">        <span class="comment">&lt;#代码行4#&gt;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">&lt;#代码行5#&gt;</span>;<span class="comment">&lt;#代码行6#&gt;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然 <code>PowerShell</code> 的缩进不是强制的。</p>
<p>在 <code>PowerShell</code> 代码中，另一种常见的语句是注释，注释并不是能执行的语句，而是对代码的描述说明性文本。当代码运行时，解释器会忽略这些内容。<br>代码最好有注释，特别是处理较复杂的工作时，注释可以为正在进行的操作添加提示，例如“这行代码要求用户输入一个字符”、“此段代码是 LNP 编写的”。<br><code>PowerShell</code> 有两种添加注释方法</p>
<ul>
<li>行注释:  <code>#</code></li>
<li>块注释:  <code>&lt;#</code> 和 <code>#&gt;</code></li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这是一行注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;#</span></span><br><span class="line"><span class="comment">这是注释块</span></span><br><span class="line"><span class="comment">123ABC</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"></span><br><span class="line">ls <span class="comment">#列出当前目录下的文件和文件夹，是Get-ChildItem的别名</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#注意下面语句会产生错误</span></span><br><span class="line"><span class="comment">&lt;#块注释由"#&gt;</span><span class="string">"结尾#&gt;</span></span><br></pre></td></tr></table></figure>

<p>第一个 <code>#&gt;</code> 后面的部分会被认为是 <code>PowerShell</code> 代码，因此出现错误。</p>
<p>还有特别的注意一点，<strong><code>PowerShell</code> 代码是不区分大小写的</strong>，因此只要拼写正确的命令(或变量)，而无需关心大小写即可执行，不过最好还是有一定规范。</p>
<hr>
<h3 id="PowerShell-脚本的基本结构"><a href="#PowerShell-脚本的基本结构" class="headerlink" title="PowerShell 脚本的基本结构"></a><code>PowerShell</code> 脚本的基本结构</h3><p><code>PowerShell</code> 像 <code>Python</code> 一样，允许使用控制台直接输入命令进行交互，也可以事先把代码写入一个文件再作为脚本运行。<br>一个 <code>PowerShell</code> 脚本仅仅是一个包含 <code>PowerShell</code> 代码的文本文件。如果这个文本文件执行， <code>PowerShell</code> 解释器会逐行解释并执行它的的语句。<code>PowerShell</code> 脚本有点像以前 <code>CMD</code> 控制台上的批处理文件。可以通过非常简单的文本编辑工具创建 <code>PowerShell</code> 脚本。</p>
<p>PowerShell脚本文件的扩展名是 <code>.ps1</code></p>
<hr>
<h3 id="执行策略限制"><a href="#执行策略限制" class="headerlink" title="执行策略限制"></a>执行策略限制</h3><p><code>PowerShell</code> 一般初始化情况下都会禁止脚本执行。脚本能否执行取决于PowerShell的执行策略。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PS E:&gt; ./MyScript.ps1</span><br><span class="line"></span><br><span class="line">无法加载文件 E:MyScript.ps1，因为在此系统中禁止执行脚本。有关详细信息，请参阅 <span class="string">"get-help about_signing"</span>。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">15</span></span><br><span class="line">+ .MyScript.ps1 &lt; &lt;&lt;&lt;</span><br><span class="line">    + CategoryInfo          : NotSpecified: (:) [], PSSecurityException</span><br><span class="line">    + FullyQualifiedErrorId : RuntimeException</span><br></pre></td></tr></table></figure>

<p><strong>只有管理员才有权限更改这个策略。非管理员会报错。</strong></p>
<p>查看脚本执行策略，可以通过在 <code>PowerShell</code> 控制台直接输入:<br><code>Get-ExecutionPolicy</code><br><strong>更改脚本执行策略，可以管理员启动PowerShell，在控制台输入:</strong><br><code>Set-ExecutionPolicy &lt;策略&gt;</code><br>策略|解释<br>-|-<br>Unrestricted|权限最高，可以不受限制执行任何脚本。<br>Default|为Powershell默认的策略，即Restricted<br>Restricted|不允许任何脚本执行<br>AllSigned|所有脚本都必须经过签名才能在运行<br>RemoteSigned|本地脚本无限制，但是对来自网络的脚本必须经过签名</p>
<p>如果要使用脚本功能又要兼顾安全性，我们就选择RemoteSigned<br>即在以管理员身份允许的 <code>PowerShell</code> 输入<br><code>Set-ExecutionPolicy RemoteSigned</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">执行策略可以防止您执行不信任的脚本。更改执行策略可能会使您面临 about_Execution_Policies帮助主题中所述的安全风险。是否要更改执行策略?</span><br><span class="line">[Y] 是(Y)  [N] 否(N)  [S] 挂起(S)  [?] 帮助 (默认值为“Y”): y</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="运行-PowerShell-脚本"><a href="#运行-PowerShell-脚本" class="headerlink" title="运行 PowerShell 脚本"></a>运行 <code>PowerShell</code> 脚本</h3><p>当您的脚本编写成功后您可能第一次会像下面的方式运行它，也就是只输入脚本的文件名，会报错。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PS E:&gt; MyScript.ps1</span><br><span class="line"></span><br><span class="line">无法将“MyScript.ps1”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括</span><br><span class="line">路径，请确保路径正确，然后重试。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">13</span></span><br><span class="line">+ MyScript.ps1 &lt; &lt;&lt;&lt;</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (MyScript.ps1:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class="line"></span><br><span class="line">Suggestion [<span class="number">3</span>,General]: 未找到命令 MyScript.ps1，但它确实存在于当前位置。Windows PowerShell 默认情况下不从当前位置加载命令。如果信任此命令，请改为键入 <span class="string">"./MyScript.ps1"</span>。有关更多详细信息，请参阅 <span class="string">"get-h</span></span><br><span class="line"><span class="string">elp about_Command_Precedence"</span>。</span><br></pre></td></tr></table></figure>

<p>解决办法很简单，如果脚本在当前工作目录，请在脚本文件明前添加<code>./</code>，或者使用绝对路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PS E:&gt; .\MyScript.ps1</span><br><span class="line"></span><br><span class="line">2019年3月27日 18:33:03</span><br><span class="line">C:\Program Files\Common Files</span><br><span class="line">files count</span><br><span class="line">20</span><br><span class="line"></span><br><span class="line">PS E:&gt; E:MyScript.ps1</span><br><span class="line"></span><br><span class="line">2019年3月27日 18:33:11</span><br><span class="line">C:\Program Files\Common Files</span><br><span class="line">files count</span><br><span class="line">20</span><br></pre></td></tr></table></figure>

<h5 id="通过重定向创建脚本"><a href="#通过重定向创建脚本" class="headerlink" title="通过重定向创建脚本"></a>通过重定向创建脚本</h5><p>如果想要执行的脚本不是很长，我们甚至可以直接在控制台中要执行的语句重定向给一个脚本文件。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS E:&gt; <span class="string">'"Hello,World!"'</span> &gt; MyScript.ps1</span><br><span class="line">PS E:&gt; ./MyScript.ps1</span><br><span class="line">Hello,World!</span><br></pre></td></tr></table></figure>

<p>这样有个缺点，就是您的代码必须放在闭合的引号中。这样的书写方式一旦在脚本内部也有引号时，是一件很痛苦的事。甚至您还可能希望在脚本中换行。下面的Here-strings例子不错，也就是将脚本文件通过<code>@&#39; &#39;@</code>闭合起来。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PS E:&gt; <span class="string">@'</span></span><br><span class="line"><span class="string">&gt;&gt; Get-Date</span></span><br><span class="line"><span class="string">&gt;&gt; $Env:CommonProgramFiles</span></span><br><span class="line"><span class="string">&gt;&gt; #Script End</span></span><br><span class="line"><span class="string">&gt;&gt; "files count"</span></span><br><span class="line"><span class="string">&gt;&gt; (ls).Count</span></span><br><span class="line"><span class="string">&gt;&gt; #Script Really End</span></span><br><span class="line"><span class="string">&gt;&gt;</span></span><br><span class="line"><span class="string">&gt;&gt; '@ &gt; myscript.ps1</span></span><br><span class="line"><span class="string">&gt;&gt;</span></span><br><span class="line"><span class="string">PS E:&gt; .MyScript.ps1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2019年3月27日 18:15:10</span></span><br><span class="line"><span class="string">C:\Program Files\Common Files</span></span><br><span class="line"><span class="string">files count</span></span><br><span class="line"><span class="string">20</span></span><br></pre></td></tr></table></figure>

<p>Here-String以 <code>@&#39;</code>开头，以<code>&#39;@</code>结束.任何文本都可以存放在里面，哪怕是一些特殊字符，空号，白空格。但是如果您不小心将单引号写成了双引号，<code>PowerShell</code> 将会把里面的变量进行解析。</p>
<h5 id="通过编辑器创建脚本"><a href="#通过编辑器创建脚本" class="headerlink" title="通过编辑器创建脚本"></a>通过编辑器创建脚本</h5><p>其实最方便的还是使用文本编辑器直接编写代码，保存成PS1文件，右键即可执行。<br>这里推荐使用Visual Studio Code(以下简称VSC)，VSC提供了PS1的自动补全(安装插件)、语法高亮、自动缩进、格式化代码、断点调试等功能。</p>
<hr>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>变量可以临时保存数据，因此可以把数据保存在变量中，以便进一步操作。<code>PowerShell</code> 的变量定义非常方便。<br>我们可以用 <code>$变量名=初值</code> 的方法定义变量，解释器会根据所赋的初值判断变量类型，类似于C#的 <code>var</code> 关键字或C++11中的 <code>auto</code> 关键字<code>PowerShell</code> 不需要显示地去声明，可以自动创建变量，只须记住变量的前缀为$.<br>创建好了变量后，可以通过变量名输出变量，也可以把变量名存在字符串中。但是有个例外:<strong>单引号中的字符串不会识别和处理变量名。</strong></p>
<h4 id="选择变量名"><a href="#选择变量名" class="headerlink" title="选择变量名"></a>选择变量名</h4><p>在 <code>PowerShell</code> 中变量名均是以美元符 <code>$</code> 开始，剩余字符可以是数字、字母、下划线的任意字符，并且PowerShell变量名也对大小写不敏感（<code>$a</code> 和 <code>$A</code> 是同一个变量)。<br>某些特殊的字符(比如<code>$</code>等)在 <code>PowerShell</code> 中有特殊的用途，一般不推荐使用这些字符作为变量名。当然你硬要使用，请把整个变量名后缀用花括号括起来。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:/&gt; $&#123;<span class="string">"I"</span>like $&#125;=<span class="number">5.1</span></span><br><span class="line">PS C:/&gt; $&#123;<span class="string">"I"</span>like $&#125;</span><br><span class="line"><span class="number">5.1</span></span><br></pre></td></tr></table></figure>

<p><strong>不能定义和保留变量名称相同的变量</strong><br>使用<code>ls variable:</code> 列出当前使用的所有变量，刚启动的 <code>PowerShell</code> 执行此命令能看到 <code>PowerShell</code> 的所有自动化变量(一旦打开 <code>Powershell</code> 就会自动加载的变量，后面将会详细解释这些变量的作用)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">Name                           Value</span><br><span class="line">----                           -----</span><br><span class="line">$</span><br><span class="line">?                              True</span><br><span class="line">^</span><br><span class="line">args                           &#123;&#125;</span><br><span class="line">ConfirmPreference              High</span><br><span class="line">ConsoleFileName</span><br><span class="line">DebugPreference                SilentlyContinue</span><br><span class="line">Error                          &#123;&#125;</span><br><span class="line">ErrorActionPreference          Continue</span><br><span class="line">ErrorView                      NormalView</span><br><span class="line">ExecutionContext               System.Management.Automation.EngineIntrinsics</span><br><span class="line">false                          False</span><br><span class="line">FormatEnumerationLimit         4</span><br><span class="line">HOME                           C:\Users\aaaaa</span><br><span class="line">Host                           System.Management.Automation.Internal.Host.InternalHost</span><br><span class="line">InformationPreference          SilentlyContinue</span><br><span class="line">input                          System.Collections.ArrayList+ArrayListEnumeratorSimple</span><br><span class="line">MaximumAliasCount              4096</span><br><span class="line">MaximumDriveCount              4096</span><br><span class="line">MaximumErrorCount              256</span><br><span class="line">MaximumFunctionCount           4096</span><br><span class="line">MaximumHistoryCount            4096</span><br><span class="line">MaximumVariableCount           4096</span><br><span class="line">MyInvocation                   System.Management.Automation.InvocationInfo</span><br><span class="line">NestedPromptLevel              0</span><br><span class="line">null</span><br><span class="line">OutputEncoding                 System.Text.ASCIIEncoding</span><br><span class="line">PID                            8796</span><br><span class="line">PROFILE                        C:\Users\aaaaa\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</span><br><span class="line">ProgressPreference             Continue</span><br><span class="line">PSBoundParameters              &#123;&#125;</span><br><span class="line">PSCommandPath</span><br><span class="line">PSCulture                      zh-CN</span><br><span class="line">PSDefaultParameterValues       &#123;&#125;</span><br><span class="line">PSEdition                      Desktop</span><br><span class="line">PSEmailServer</span><br><span class="line">PSHOME                         C:\Windows\System32\WindowsPowerShell\v1.0</span><br><span class="line">PSScriptRoot</span><br><span class="line">PSSessionApplicationName       wsman</span><br><span class="line">PSSessionConfigurationName     http://schemas.microsoft.com/powershell/Microsoft.PowerShell</span><br><span class="line">PSSessionOption                System.Management.Automation.Remoting.PSSessionOption</span><br><span class="line">PSUICulture                    zh-CN</span><br><span class="line">PSVersionTable                 &#123;PSVersion, PSEdition, PSCompatibleVersions, BuildVersion...&#125;</span><br><span class="line">PWD                            C:\Users\aaaaa</span><br><span class="line">ShellId                        Microsoft.PowerShell</span><br><span class="line">StackTrace</span><br><span class="line">true                           True</span><br><span class="line">VerbosePreference              SilentlyContinue</span><br><span class="line">WarningPreference              Continue</span><br><span class="line">WhatIfPreference               False</span><br></pre></td></tr></table></figure>

<h4 id="查看变量类型"><a href="#查看变量类型" class="headerlink" title="查看变量类型"></a>查看变量类型</h4><p>变量可以自动存储任何<code>PowerShell</code>能够识别的类型信息，可以通过 <code>$变量名.GetType()</code> 查看和验证 <code>PowerShell</code> 分配给变量的数据类型</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PS C:/&gt; <span class="variable">$num</span>=<span class="number">10</span></span><br><span class="line">PS C:/&gt; <span class="variable">$num</span>.gettype() <span class="comment">#不区分大小写</span></span><br><span class="line"></span><br><span class="line">IsPublic IsSerial Name                            BaseType</span><br><span class="line">-------- -------- ----                            --------</span><br><span class="line">True     True     Int32                           System.ValueType</span><br></pre></td></tr></table></figure>

<h4 id="删除变量"><a href="#删除变量" class="headerlink" title="删除变量"></a>删除变量</h4><p>如果不想继续使用自定义的变量，可以使用<code>del variable:变量名</code>的方法删除变量，注意此处无<code>$</code>符号</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="number">0</span></span><br><span class="line"><span class="variable">$a</span> <span class="nomarkup">-eq</span> <span class="literal">$null</span></span><br><span class="line">False</span><br><span class="line">del variable:a</span><br><span class="line"><span class="variable">$a</span> <span class="nomarkup">-eq</span> <span class="literal">$null</span> </span><br><span class="line">True</span><br></pre></td></tr></table></figure>

<p>PowerShell支持的变量类型和C#大体相同(没有了short、uint、ulong等)，大多都继承自<code>System.ValueType</code>类( .NET类)，其基本数据类型包括</p>
<h4 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h4><table>
<thead>
<tr>
<th>类型</th>
<th>名称</th>
<th>允许的值</th>
<th>所属类</th>
</tr>
</thead>
<tbody><tr>
<td>byte</td>
<td>无符号整数(1字节)</td>
<td>0~255之间的整数</td>
<td>System.Byte</td>
</tr>
<tr>
<td>sbyte</td>
<td>有符号整数(1字节)</td>
<td>-128~127之间的整数</td>
<td>System.SByte</td>
</tr>
<tr>
<td>int16</td>
<td>有符号短整型(2字节)</td>
<td>-32768~32767之间的整数</td>
<td>System.Int16</td>
</tr>
<tr>
<td>uint16</td>
<td>无符号短整型(2字节)</td>
<td>0~65535之间的整数</td>
<td>System.UInt16</td>
</tr>
<tr>
<td>int</td>
<td>有符号整型</td>
<td>-2147483648~2147483647之间的整数</td>
<td>System.Int32</td>
</tr>
<tr>
<td>uint32</td>
<td>无符号整型</td>
<td>0~4294967295之间的整数</td>
<td>System.UInt32</td>
</tr>
<tr>
<td>long</td>
<td>有符号长整数(8字节)</td>
<td>-9223372036854775808~9223372036854775807之间的整数</td>
<td>System.Int64</td>
</tr>
<tr>
<td>ulong</td>
<td>无符号长整数(8字节)</td>
<td>0~18446744073709551615之间的整数</td>
<td>System.UInt64</td>
</tr>
</tbody></table>
<p>其实 <code>int</code> 、<code>long</code> 、以及下面的 <code>float</code> 都是 .NET的语法糖，真正的原生类型名是<code>int32</code>、<code>int64</code>、<code>single</code> 之类的类名</p>
<h4 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h4><p>浮点数标准形式(<code>float</code>和<code>double</code>) 
$+/-m×2^e$<br>其中m为尾数，e为阶码，尾数是一个非负数，阶码是一个整数<br>PowerShell还支持一个特别的浮点数类型 <code>decimal</code>，其形式为<br>$+/-m×10^e$</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>名称</th>
<th>指数</th>
<th>m范围</th>
<th>e范围</th>
<th>近似最小值</th>
<th>近似最大值</th>
<th>所属类</th>
</tr>
</thead>
<tbody><tr>
<td>float</td>
<td>单精度浮点数</td>
<td>2</td>
<td>0~$2^{24}$</td>
<td>-149~104</td>
<td>$1.5×10^{-45}$</td>
<td>$3.4×10^{38}$</td>
<td>System.Single</td>
</tr>
<tr>
<td>double</td>
<td>双精度浮点数</td>
<td>2</td>
<td>0~$2^{53}$</td>
<td>-1075~970</td>
<td>$5.0×10^{-324}$</td>
<td>$1.7×10^{308}$</td>
<td>System.Double</td>
</tr>
<tr>
<td>decimal</td>
<td>16字节浮点数</td>
<td>10</td>
<td>0~$2^{96}$</td>
<td>-28~0</td>
<td>$1.0×10^{-28}$</td>
<td>$7.9×10^{28}$</td>
<td>System.Decimal</td>
</tr>
</tbody></table>
<h4 id="其他简单类型"><a href="#其他简单类型" class="headerlink" title="其他简单类型"></a>其他简单类型</h4><p>除了数值类型以外，还有3种基本类型</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>名称</th>
<th>允许的值</th>
<th>所属类</th>
</tr>
</thead>
<tbody><tr>
<td>char</td>
<td>字符型</td>
<td>一个Unicode字符，存储0~65535之间的整数</td>
<td>System.Char</td>
</tr>
<tr>
<td>bool</td>
<td>布尔型</td>
<td>布尔值: <code>$true</code> 或 <code>$false</code>(必须加<code>$</code>符号)</td>
<td>System.Boolean</td>
</tr>
<tr>
<td>enum</td>
<td>枚举</td>
<td>限定取值一组命名常量的独特的值类型</td>
<td>System.Enum</td>
</tr>
<tr>
<td>datetime</td>
<td>时间型</td>
<td>包含日期、时间的类型</td>
<td>System.DateTime</td>
</tr>
<tr>
<td>string</td>
<td>字符串</td>
<td>一组字符</td>
<td>System.String</td>
</tr>
</tbody></table>
<p>注意 <strong>C/C++的 <code>char</code> 仅支持ASCII里面的256个字符, <code>PowerShell</code> 和 <code>C#</code> 的 <code>char</code> 是支持Unicode的</strong>，
<strong>PowerShell和C#的<code>string</code>类型并不是继承自 <code>System.ValuType</code> 类，而是继承自 <code>System.Object</code> 类</strong>，因此严格来说 <code>string</code> 类型并非是简单类型。<br><strong>PowerShell的转义字符是 ` 而不是 \</strong>，这也是和C#的一个区别</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用char</span></span><br><span class="line">PS D:/&gt;[char]<span class="variable">$c</span>=<span class="string">"A"</span></span><br><span class="line"><span class="variable">$c</span></span><br><span class="line">A</span><br><span class="line"><span class="comment">#使用bool</span></span><br><span class="line">PS D:/&gt;<span class="variable">$boolean</span>=<span class="literal">$true</span></span><br><span class="line"><span class="variable">$boolean</span></span><br><span class="line">True</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用enum</span></span><br><span class="line">enum fruit</span><br><span class="line">&#123;</span><br><span class="line">	apple</span><br><span class="line">	banana</span><br><span class="line">	cherry</span><br><span class="line">	durian</span><br><span class="line">&#125;</span><br><span class="line">[fruit]<span class="variable">$en</span>=[fruit]::apple</span><br><span class="line"><span class="variable">$en</span></span><br><span class="line">apple</span><br><span class="line"><span class="variable">$item</span>=<span class="string">"cherry"</span></span><br><span class="line">[fruit]<span class="variable">$enu</span>=[fruit]::(<span class="variable">$item</span>)</span><br><span class="line"><span class="variable">$enu</span></span><br><span class="line">cherry</span><br><span class="line"></span><br><span class="line"><span class="comment">#这种使用方法是错误的</span></span><br><span class="line">PS D:/&gt; [fruit]<span class="variable">$enum</span>=banana</span><br><span class="line"></span><br><span class="line">banana : 无法将“banana”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正确，然后再试一次。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">12</span></span><br><span class="line">+ [fruit]<span class="variable">$en</span>=banana</span><br><span class="line">+            ~~~~~~</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (banana:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class="line"></span><br><span class="line"><span class="comment">#当尝试使用非枚举值进行赋值时</span></span><br><span class="line">PS D:/&gt; [fruit]<span class="variable">$en</span>=[fruit]::peach</span><br><span class="line"></span><br><span class="line">由于枚举值无效，无法将 Null 转换为类型“fruit”。请指定以下枚举值之一，然后重试。可能的枚举值为“apple,banana,cherry,durian”。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">1</span></span><br><span class="line">+ [fruit]<span class="variable">$en</span>=[fruit]::peach</span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : MetadataError: (:) [], ArgumentTransformationMetadataException</span><br><span class="line">    + FullyQualifiedErrorId : RuntimeException</span><br><span class="line"></span><br><span class="line">PS D:/&gt; <span class="string">"\n 123 `n 123"</span></span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment">\n 123</span></span><br><span class="line"><span class="comment"> 123</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"></span><br><span class="line">PS D:/&gt;<span class="variable">$date</span>=<span class="built_in">get-date</span></span><br><span class="line"><span class="variable">$date</span></span><br><span class="line"><span class="variable">$date</span>.gettype()</span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment">2019年3月28日 19:32:30</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">IsPublic IsSerial Name                            BaseType</span></span><br><span class="line"><span class="comment">-------- -------- ----                            --------</span></span><br><span class="line"><span class="comment">True     True     DateTime                        System.ValueType</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="赋值和返回值"><a href="#赋值和返回值" class="headerlink" title="赋值和返回值"></a>赋值和返回值</h4><p>赋值操作符为 <code>=</code>，几乎可以把任何数据赋值给一个变量，甚至一条cmdlet命令<br>，因为 <code>PowerShell</code> 支持面向对象，对象可以包罗万象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">PS D:\powershell\test&gt; $item=ls</span><br><span class="line">PS D:\powershell\test&gt; $item</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    目录: D:\powershell\test</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-a----       2017/11/24     12:52            136 4-3.cpp</span><br><span class="line">-a----        2019/3/27     15:13             65 anapple.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS D:\powershell\test&gt; $item.gettype()</span><br><span class="line"></span><br><span class="line">IsPublic IsSerial Name                              BaseType</span><br><span class="line">-------- -------- ----                              --------</span><br><span class="line">True     True     Object[]                          System.Array</span><br><span class="line"></span><br><span class="line">$item为一个对象数组</span><br></pre></td></tr></table></figure>

<h4 id="弱类型与强类型"><a href="#弱类型与强类型" class="headerlink" title="弱类型与强类型"></a>弱类型与强类型</h4><p>一般对 <code>PowerShell</code> 变量重新赋值时，变量类型会自动改变，这是弱类型语言的特点；<br>而 <code>PowerShell</code> 依托的 .NET是强类型的，所以 <code>PowerShell</code> 可以使用强类型。<br>强类型语言在速度上略逊于弱类型语言，但是强类型定义语言带来的严谨性又能避免不必要的错误。<br>可以在变量前添加类型限定符使该变量变为强类型，可以确保变量的类型不会随着赋值而改变</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[int]<span class="variable">$num</span>=<span class="number">123</span> <span class="comment">#正确</span></span><br><span class="line">[int]<span class="variable">$num</span>=ls <span class="comment">&lt;#错误</span></span><br><span class="line"><span class="comment">无法将“System.Object[]”类型的“System.Object[]”值转换为“System.Int32”类型。</span></span><br><span class="line"><span class="comment">所在位置 行:1 字符: 1</span></span><br><span class="line"><span class="comment">+ [int]$num=ls</span></span><br><span class="line"><span class="comment">+ ~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment">    + CategoryInfo          : MetadataError: (:) [], ArgumentTransformationMetadataException</span></span><br><span class="line"><span class="comment">    + FullyQualifiedErrorId : RuntimeException</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><p><code>PowerShell</code> 能够非常方便地将字符串等基本类型转换成期望的类型。之所以神奇，是因为 <code>PowerShell</code> 本身做了很多辛苦的工作，按照优先级：</p>
<ol>
<li><strong>直接赋值</strong>：输入类型和期望类型一致，可以直接交付。</li>
<li><strong>基于语言的类型转换</strong>：当目标类型为<code>void</code>,<code>Boolean</code>,<code>String</code> , <code>Array</code> , <code>Hashtable</code> , <code>PSReference</code> (i.e.: [ref]), <code>XmlDocument</code> , <code>Delegate</code> 和 <code>Enum</code> 时，基于语言的类型转换开始工作。</li>
<li><strong>Parse 转换</strong>：如果目标类型包含了 <code>Parse()</code> 方法，则采用它。</li>
<li><strong>Static Create 转换</strong>：如果目标类型包含静态的Create，则采用它。</li>
<li><strong>构造函数转换</strong>：如果目标类型定义了构造函数，采用它。</li>
<li><strong>Cast 转换</strong>：如果目标类型定义了从源类型的显式或者隐式的操作符，则采用它。</li>
<li><strong>IConvertible 接口转换</strong>：如果目标类型实现了支持源类型<code>IConvertible</code> 接口，则采用它。</li>
<li><strong>IDictionary 转换</strong>：如果源类型是词典或者哈希表，会尝试创建一个实例，然后来填充name和value属性。</li>
<li><strong>PSObject 属性转换</strong>：如果源类型是<code>PSObject</code>，通过目标类型的默认的构造函数创建一个实例，然后使用<code>PSObject</code>中的属性名称和值来填充实例的属性。</li>
<li><strong>TypeConverter 转换</strong>：如果存在注册的 <code>TypeConverter</code> 或 <code>PSTypeConverter</code> 来处理转换，则使用它。</li>
</ol>
<p>注意<strong>对浮点数向整数进行类型转换时，会自动四舍五入！！</strong><br>如果要C++/C#那种向下取整的方法请使用 <code>[math]::Floor()</code> 函数<br>看几个转换的例子</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS D:/test&gt; <span class="variable">$s</span>=<span class="number">12.56</span></span><br><span class="line">PS D:/test&gt; [int]<span class="variable">$s</span></span><br><span class="line"><span class="number">13</span></span><br><span class="line">PS D:/test&gt; [convert]::ToInt32(<span class="variable">$s</span>)</span><br><span class="line"><span class="number">13</span></span><br></pre></td></tr></table></figure>

<p><code>[convert]::ToInt32()</code> 是 .NET <code>System.Convert</code> 类提供的转换函数<br><code>convert</code> 类中的转换函数格式为:<code>TO</code>+<code>原生类型名()</code>，这里的原生类型名指的是各个类型实际类名<br>常用：</p>
<ul>
<li><code>[convert]::ToInt32()</code></li>
<li><code>[convert]::ToSingle()</code></li>
<li><code>[convert]::ToDouble()</code></li>
<li><code>[convert]::ToBoolean()</code></li>
<li><code>[convert]::ToString()</code></li>
</ul>
<p><code>convert</code> 类提供了一系列方法来完成不同变量之间的转换，获得函数列表及使用方法请参考微软的 .NET文档<a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.convert?redirectedfrom=MSDN&view=netframework-4.7.2#%E6%96%B9%E6%B3%95" target="_blank" rel="noopener">Convert类 方法列表</a></p>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><p>注意逻辑运算符和比较运算符的写法,不支持 <code>C#</code> 的<code>&amp;&amp;</code> <code>||</code> <code>！</code> <code>==</code> <code>!=</code> <code>&lt;</code> <code>&gt;</code> <code>&gt;=</code> <code>&lt;=</code>这些运算符</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#加 减 乘 除 取余</span></span><br><span class="line">+ - * / %</span><br><span class="line"><span class="comment">#自增、自减运算符，和C#或C++完全一致</span></span><br><span class="line">++<span class="variable">$i</span></span><br><span class="line"><span class="variable">$i</span>++</span><br><span class="line"><span class="variable">$i</span>--</span><br><span class="line">--<span class="variable">$i</span></span><br><span class="line"><span class="comment">#且</span></span><br><span class="line">-and</span><br><span class="line"><span class="comment">#并</span></span><br><span class="line">-or</span><br><span class="line"><span class="comment">#非</span></span><br><span class="line"><span class="nomarkup">-not</span></span><br><span class="line">!</span><br><span class="line"><span class="comment">#样例</span></span><br><span class="line"><span class="literal">$true</span> -and <span class="literal">$false</span> -or <span class="nomarkup">-not</span> <span class="number">0</span></span><br><span class="line">!<span class="literal">$true</span></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">True</span><br><span class="line">False</span><br><span class="line"><span class="comment">#等于 (equal to)</span></span><br><span class="line"><span class="nomarkup">-eq</span></span><br><span class="line"><span class="comment">#不等于 (not equal to)</span></span><br><span class="line">-nq</span><br><span class="line"><span class="comment">#大于 (greater than)</span></span><br><span class="line"><span class="nomarkup">-gt</span></span><br><span class="line"><span class="comment">#大于等于 (greater than or equal to)</span></span><br><span class="line"><span class="nomarkup">-ge</span></span><br><span class="line"><span class="comment">#小于 (less than)</span></span><br><span class="line"><span class="nomarkup">-lt</span></span><br><span class="line"><span class="comment">#小于等于 (less than or equal to)</span></span><br><span class="line"><span class="nomarkup">-le</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#对于字符串类型，可以在比较运算符前加i或c表示是否区分大小写,</span></span><br><span class="line"><span class="comment">#i表示对大小写不敏感，c表示敏感，不写默认不敏感</span></span><br><span class="line"><span class="string">"a"</span> <span class="nomarkup">-eq</span> <span class="string">"A"</span></span><br><span class="line"><span class="string">"a"</span> -ceq <span class="string">"A"</span></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">True</span><br><span class="line">False</span><br><span class="line"></span><br><span class="line"><span class="comment">#判断变量是否为兼容类型(同一类型或其父类型)，类型格式为 [类型名]</span></span><br><span class="line">-is</span><br><span class="line"><span class="comment">#示例</span></span><br><span class="line"><span class="variable">$a</span>=<span class="number">0</span></span><br><span class="line"><span class="variable">$a</span> -is [int]</span><br><span class="line"><span class="variable">$b</span>=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"><span class="variable">$b</span> -is [array]</span><br><span class="line"><span class="variable">$a</span> -is [ValueType]</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">True</span><br><span class="line">True</span><br><span class="line">True <span class="comment"># System.Int32类继承自System.ValueType类，因此int是其父类型ValueType的子类型</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="条件分支"><a href="#条件分支" class="headerlink" title="条件分支"></a>条件分支</h3><h4 id="if-else"><a href="#if-else" class="headerlink" title="if else"></a>if else</h4><p><code>if</code> 和 <code>else</code> 用法和C#完全一样，除了大括号不允许省略，多分支时还多了个<code>elseif</code> 可用，和<code>Python</code> 的 <code>elif</code> 作用相同</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="literal">$true</span> -and <span class="literal">$true</span>) &#123;</span><br><span class="line">	<span class="variable">$a</span>=<span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(<span class="variable">$a</span> <span class="nomarkup">-eq</span> <span class="variable">$b</span>) &#123;</span><br><span class="line">	<span class="variable">$a</span>=<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="variable">$a</span>=<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h4><p>PowerShell的<code>switch</code>非常灵活，使用起来较为方便<br>相对C#或C++，PowerShell的switch不需要写`case:``，但是必须写大括号</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="string">"Beijing"</span></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$a</span>) </span><br><span class="line">&#123;</span><br><span class="line">	<span class="string">"Beijing"</span> &#123;<span class="variable">$res</span>=<span class="string">"北京"</span>&#125;</span><br><span class="line">	<span class="string">"Shanghai"</span> &#123;<span class="variable">$res</span>=<span class="string">"上海"</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>默认比较运算符为<code>-eq</code>，你也可以使用下面的例子自定义比较条件，必须保证表达式返回boolen类型($true和$false)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$v</span>=<span class="number">18</span></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$v</span>)</span><br><span class="line">&#123;</span><br><span class="line">	&#123;<span class="variable">$_</span> <span class="nomarkup">-lt</span> <span class="number">10</span>&#125; &#123;<span class="string">"小于10"</span>&#125; <span class="comment"># $_ 表示当前的传入的变量 直接写的字符串会被输出</span></span><br><span class="line">	<span class="number">10</span> &#123;<span class="string">"等于10"</span>&#125;</span><br><span class="line">	&#123;<span class="variable">$_</span> <span class="nomarkup">-gt</span> <span class="number">10</span>&#125; &#123;<span class="string">"小于10"</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment">大于10</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><p>接下来介绍循环</p>
<h4 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h4><p><code>PowerShell</code> 的 <code>for</code> 循环类似于<code>C#</code>，看一个样例:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span> <span class="nomarkup">-lt</span> <span class="number">10</span>;<span class="variable">$i</span>++)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">Write-Output</span> <span class="string">"Hello"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="do-while循环"><a href="#do-while循环" class="headerlink" title="do-while循环"></a>do-while循环</h4><p><code>Do</code> 和 <code>While</code> 可能产生死循环，为了防止死循环的发生，因此我们必须确切的指定循环终止的条件。指定了循环终止的条件后，一旦条件不满足就会退出循环。<br><code>do-while()</code> 会先执行再去判断，能保证循环至少执行一次。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> </span><br><span class="line">&#123; </span><br><span class="line">	<span class="variable">$n</span>=<span class="built_in">Read-Host</span> <span class="string">"请输入数字"</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$n</span> <span class="nomarkup">-ne</span> <span class="number">0</span>)</span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment">请输入数字: 1</span></span><br><span class="line"><span class="comment">请输入数字: 2</span></span><br><span class="line"><span class="comment">请输入数字: s</span></span><br><span class="line"><span class="comment">请输入数字: 0</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="只使用while"><a href="#只使用while" class="headerlink" title="只使用while"></a>只使用while</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$n</span>=<span class="number">5</span></span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$n</span> <span class="nomarkup">-gt</span> <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$n</span></span><br><span class="line">    <span class="variable">$n</span>=<span class="variable">$n</span>-<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<h5 id="跳出循环"><a href="#跳出循环" class="headerlink" title="跳出循环"></a>跳出循环</h5><p>使用 <code>continue</code> 关键字，可以终止当前循环，跳过 <code>continue</code> 后其它语句，重新下一次循环。<br>跳出循环语句使用 <code>break</code> 关键字</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$n</span>=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$n</span> <span class="nomarkup">-lt</span> <span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$n</span> <span class="nomarkup">-eq</span> <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$n</span>=<span class="variable">$n</span>+<span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$n</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$n</span>=<span class="variable">$n</span>+<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="variable">$n</span>=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$n</span> <span class="nomarkup">-lt</span> <span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$n</span> <span class="nomarkup">-eq</span> <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$n</span></span><br><span class="line">    <span class="variable">$n</span>++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还有一种循环 <code>foreach</code> ，等到我们讲到数组再说</p>
<hr>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><h4 id="定义数组"><a href="#定义数组" class="headerlink" title="定义数组"></a>定义数组</h4><p>在 <code>PowerShell</code> 中创建数组可以使用逗号</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$nums</span>=<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$nums</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>对于连续的数字数组可以使用一个更快捷的方法:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$nums</span>=<span class="number">1</span>..<span class="number">5</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$nums</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>

<h5 id="对象数组的多态"><a href="#对象数组的多态" class="headerlink" title="对象数组的多态"></a>对象数组的多态</h5><p>像变量一样，如果数组中元素的类型为弱类型，默认可以存储不同类型的值。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$array</span>=<span class="number">1</span>,<span class="string">"2019"</span>,([Guid]::NewGuid()),(<span class="built_in">get-date</span>)</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$array</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2019</span></span><br><span class="line"></span><br><span class="line">Guid</span><br><span class="line">----</span><br><span class="line">ea5f17c6-c0a2-<span class="number">42</span>ba-<span class="number">9</span>de4-e4d03bebffaf</span><br><span class="line"></span><br><span class="line">DisplayHint : DateTime</span><br><span class="line">Date        : <span class="number">2019</span>/<span class="number">3</span>/<span class="number">29</span> <span class="number">0</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">Day         : <span class="number">29</span></span><br><span class="line">DayOfWeek   : Friday</span><br><span class="line">DayOfYear   : <span class="number">88</span></span><br><span class="line">Hour        : <span class="number">23</span></span><br><span class="line">Kind        : Local</span><br><span class="line">Millisecond : <span class="number">120</span></span><br><span class="line">Minute      : <span class="number">23</span></span><br><span class="line">Month       : <span class="number">3</span></span><br><span class="line">Second      : <span class="number">39</span></span><br><span class="line">Ticks       : <span class="number">636894986191207086</span></span><br><span class="line">TimeOfDay   : <span class="number">23</span>:<span class="number">23</span>:<span class="number">39.1207086</span></span><br><span class="line">Year        : <span class="number">2019</span></span><br><span class="line">DateTime    : <span class="number">2019</span>年<span class="number">3</span>月<span class="number">29</span>日 <span class="number">23</span>:<span class="number">23</span>:<span class="number">39</span></span><br><span class="line"></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$array</span>|<span class="keyword">foreach</span>&#123;<span class="variable">$_</span>.gettype()&#125;</span><br><span class="line"><span class="comment">#查看数组各元素类型</span></span><br><span class="line">IsPublic IsSerial Name                                     BaseType</span><br><span class="line">-------- -------- ----                                     --------</span><br><span class="line">True     True     Int32                                    System.ValueType</span><br><span class="line">True     True     String                                   System.Object</span><br><span class="line">True     True     Guid                                     System.ValueType</span><br><span class="line">True     True     DateTime                                 System.ValueType</span><br></pre></td></tr></table></figure>

<h5 id="空数组和单元素数组"><a href="#空数组和单元素数组" class="headerlink" title="空数组和单元素数组"></a>空数组和单元素数组</h5><p>对数组元素可以查看它的公有属性，比如长度<br>只需要输入<code>$数组名.Count</code>即可显示数组长度</p>
<h6 id="空数组"><a href="#空数组" class="headerlink" title="空数组"></a>空数组</h6><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$a</span>=@()</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$a</span> -is [array]</span><br><span class="line">True</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$a</span>.Count</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>

<h6 id="单元素数组"><a href="#单元素数组" class="headerlink" title="单元素数组"></a>单元素数组</h6><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS C:Powershell&gt; <span class="variable">$a</span>=,<span class="string">"moss"</span></span><br><span class="line">PS C:Powershell&gt; <span class="variable">$a</span> -is [array]</span><br><span class="line">True</span><br><span class="line">PS C:Powershell&gt; <span class="variable">$a</span>.Count</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="使用数组"><a href="#使用数组" class="headerlink" title="使用数组"></a>使用数组</h4><h5 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h5><h6 id="直接法"><a href="#直接法" class="headerlink" title="直接法"></a>直接法</h6><p>将数组作为单独一行将会自动遍历这个数组的所有元素</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PS C:/&gt; <span class="variable">$a</span>=<span class="number">1</span>..<span class="number">10</span></span><br><span class="line">PS C:/&gt; <span class="variable">$a</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>

<h6 id="for-循环遍历"><a href="#for-循环遍历" class="headerlink" title="for 循环遍历"></a><code>for</code> 循环遍历</h6><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PS C:/&gt; <span class="variable">$a</span>=<span class="number">1</span>..<span class="number">5</span></span><br><span class="line">PS C:/&gt; <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span> <span class="nomarkup">-lt</span> <span class="number">5</span>;<span class="variable">$i</span>++) &#123;</span><br><span class="line">&gt;&gt; <span class="variable">$a</span>[<span class="variable">$i</span>] &#125;</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="foreach-遍历法"><a href="#foreach-遍历法" class="headerlink" title="foreach 遍历法"></a><code>foreach</code> 遍历法</h6><p>还有一种遍历的方法，用到了之前提到的 <code>foreach</code> 语句<br>意思是使用变量 <code>$n</code> 对 <code>$a</code> 元素进行迭代，这实际上是一种对可迭代对象的访问算法<br>在 <code>C#</code> 也有这种语法</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,<span class="string">"D"</span>,<span class="string">"E"</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$n</span> <span class="keyword">in</span> <span class="variable">$a</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$n</span>+<span class="string">" "</span>+<span class="variable">$n</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">A A</span><br><span class="line">B B</span><br><span class="line">C C</span><br><span class="line">D D</span><br><span class="line">E E</span><br></pre></td></tr></table></figure>

<p><code>foreach</code>还有一种遍历的写法</p>
<p>这里我们需要先了解一下<strong>管道</strong><br>管道的符号 |<br>管道允许将它左侧命令的输出结果发送到右侧做命令的参数<br>管道并不是什么新事物，以前的Cmd控制台也有重定向的命令，例如Dir | More可以将结果分屏显示。<br>传统的Cmd管道是基于文本的，但是 <code>PowerShell</code> 是基于对象的</p>
<p>列出当前目录下的目录和文件，然后根据文件名降序排列，再投影(数据库术语)文件名，文件大小，文件的修改时间:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PS D:/test&gt; ls | <span class="built_in">Sort-Object</span> -Descending Name | <span class="built_in">Select-Object</span> Name,Length,LastWriteTime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    目录: D:/test</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Name        Length LastWriteTime</span><br><span class="line">----        ------ -------------</span><br><span class="line">out.txt        <span class="number">523</span> <span class="number">2019</span>/<span class="number">2</span>/<span class="number">24</span> <span class="number">22</span>:<span class="number">46</span>:<span class="number">35</span></span><br><span class="line">lang.json     <span class="number">6415</span> <span class="number">2019</span>/<span class="number">2</span>/<span class="number">16</span> <span class="number">23</span>:<span class="number">49</span>:<span class="number">24</span></span><br><span class="line">anapple.txt     <span class="number">65</span> <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span> <span class="number">15</span>:<span class="number">13</span>:<span class="number">52</span></span><br><span class="line"><span class="number">4</span>-<span class="number">3</span>.cpp        <span class="number">136</span> <span class="number">2017</span>/<span class="number">11</span>/<span class="number">24</span> <span class="number">12</span>:<span class="number">52</span>:<span class="number">28</span></span><br></pre></td></tr></table></figure>

<p>可迭代对象(比如数组)可以由管道送到一些命令上进一步处理<br><code>foreach</code>就可以接受管道送来的可迭代对象，并进行遍历</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$array</span>=<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,<span class="string">"D"</span>,<span class="string">"E"</span></span><br><span class="line"><span class="variable">$array</span>|<span class="keyword">foreach</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$_</span>+<span class="string">"s"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">As</span><br><span class="line">Bs</span><br><span class="line">Cs</span><br><span class="line">Ds</span><br><span class="line">Es</span><br></pre></td></tr></table></figure>

<h5 id="将数组逆序输出"><a href="#将数组逆序输出" class="headerlink" title="将数组逆序输出"></a>将数组逆序输出</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$books</span>=<span class="string">"A1"</span>,<span class="string">"B2"</span>,<span class="string">"C3"</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$books</span>[(<span class="variable">$books</span>.Count)..<span class="number">0</span>]</span><br><span class="line">C3</span><br><span class="line">B2</span><br><span class="line">A1</span><br></pre></td></tr></table></figure>

<h5 id="访问某些元素"><a href="#访问某些元素" class="headerlink" title="访问某些元素"></a>访问某些元素</h5><p>与C#相同，数组的元素可以使用索引寻址，第一个元素的索引为0，第i个元素的索引为i-1，最后一个元素的索引为Count-1，但是 <code>PowerShell</code> 为了使用方便，直接可以将 -1 作为最后的一个元素的索引(参考了 <code>Python</code> 的语法)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$books</span>=<span class="string">"1A"</span>,<span class="string">"2B"</span>,<span class="string">"3C"</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$books</span>[<span class="number">0</span>]</span><br><span class="line"><span class="number">1</span>A</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$books</span>[<span class="number">1</span>]</span><br><span class="line"><span class="number">2</span>B</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$books</span>[(<span class="variable">$book</span>.Count-<span class="number">1</span>)]</span><br><span class="line"><span class="number">3</span>C</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$books</span>[-<span class="number">1</span>]</span><br><span class="line"><span class="number">3</span>C</span><br></pre></td></tr></table></figure>

<h5 id="从数组中选择多个元素"><a href="#从数组中选择多个元素" class="headerlink" title="从数组中选择多个元素"></a>从数组中选择多个元素</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$result</span>=ls</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$result</span>[<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>]</span><br><span class="line">    Directory: C:Powershell</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime     Length Name</span><br><span class="line">----                -------------     ------ ----</span><br><span class="line">d----        <span class="number">2011</span>/<span class="number">11</span>/<span class="number">23</span>     <span class="number">17</span>:<span class="number">25</span>            ABC</span><br><span class="line">-a---        <span class="number">2011</span>/<span class="number">11</span>/<span class="number">24</span>     <span class="number">20</span>:<span class="number">04</span>      <span class="number">26384</span> a.txt</span><br><span class="line">-a---        <span class="number">2011</span>/<span class="number">11</span>/<span class="number">24</span>     <span class="number">20</span>:<span class="number">27</span>      <span class="number">12060</span> alias.ps1</span><br><span class="line">-a---        <span class="number">2011</span>/<span class="number">11</span>/<span class="number">24</span>     <span class="number">17</span>:<span class="number">37</span>       <span class="number">7420</span> name.html</span><br></pre></td></tr></table></figure>

<h5 id="给数组添加元素"><a href="#给数组添加元素" class="headerlink" title="给数组添加元素"></a>给数组添加元素</h5><p>因为PowerShell数组在内存中是顺序存储的，所以数组的大小必须是确定的，这样才方便分配存储空间，所以给数组增加元素其实相当于创建一个新的数组，只不过之后会把原来的副本删除。在当前数组追加元素可以使用 <code>+=</code> 操作符。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$books</span>=<span class="string">"A1"</span>,<span class="string">"B2"</span>,<span class="string">"C3"</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$books</span>+=<span class="string">"D4"</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$books</span></span><br><span class="line">A1</span><br><span class="line">B2</span><br><span class="line">C3</span><br><span class="line">D4</span><br></pre></td></tr></table></figure>

<h5 id="删除指定位置元素"><a href="#删除指定位置元素" class="headerlink" title="删除指定位置元素"></a>删除指定位置元素</h5><p>采用截断重连法删除指定元素</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$num</span>=<span class="number">1</span>..<span class="number">4</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$num</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$num</span>=<span class="variable">$num</span>[<span class="number">0</span>..<span class="number">1</span>]+<span class="variable">$num</span>[<span class="number">3</span>] <span class="comment">#相当于删掉了第三项</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$num</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>

<h4 id="复制数组"><a href="#复制数组" class="headerlink" title="复制数组"></a>复制数组</h4><p>数组属于引用类型，使用默认的的赋值运算符在两个变量之间赋值只是复制了一个引用，两个变量共享同一份数据。这样的模式有一个弊病如果其中一个改变也会株连到另外一个。所以复制数组最好使用 <code>Clone()</code> 方法( <code>System.Array</code> 类的成员函数)，除非有特殊需求。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$chs</span>=@(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>)</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$chsBak</span>=<span class="variable">$chs</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$chsBak</span>[<span class="number">1</span>]=<span class="string">"H"</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$chs</span></span><br><span class="line">A</span><br><span class="line">H</span><br><span class="line">C</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$chs</span>.Equals(<span class="variable">$chsBak</span>)</span><br><span class="line">True</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$chsNew</span>=<span class="variable">$chs</span>.Clone()</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$chsNew</span>[<span class="number">1</span>]=<span class="string">"Good"</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$chs</span>.Equals(<span class="variable">$chsNew</span>)</span><br><span class="line">False</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$chs</span></span><br><span class="line">A</span><br><span class="line">H</span><br><span class="line">C</span><br></pre></td></tr></table></figure>

<h4 id="强类型数组"><a href="#强类型数组" class="headerlink" title="强类型数组"></a>强类型数组</h4><p><code>PowerShell</code> 数组一般具有多态性，如果你不指定元素的具体类型，解释器会自动选择合适的类型存储每个元素。如果要统一限制所有元素的类型，可是使用类型名和一对方括号作为数组变量的类型。这样每当赋值时，会自动类型检查。如果目标数据类型不能转换成功，就会抛出一个异常，这样的数组被称为强类型数组<br>定义方法<code>[类型[]]$数组名=初值</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; [int[]] <span class="variable">$nums</span>=@()</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$nums</span>+=<span class="number">2012</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$nums</span>+=<span class="number">12.3</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$nums</span>+=<span class="string">"999"</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$nums</span>+=<span class="string">"can not convert"</span></span><br><span class="line">Cannot convert value <span class="string">"can not convert"</span> to type <span class="string">"System.Int32"</span>. Error: <span class="string">"Input string was not in a correct format."</span></span><br><span class="line">At line:<span class="number">1</span> char:<span class="number">6</span></span><br><span class="line">+ <span class="variable">$nums</span> &lt;&lt;&lt;&lt; +=<span class="string">"can not convert"</span></span><br><span class="line">    + CategoryInfo          : MetadataError: (:) [], ArgumentTransformationMetadataException</span><br><span class="line">    + FullyQualifiedErrorId : RuntimeException</span><br></pre></td></tr></table></figure>

<h4 id="命令返回数组"><a href="#命令返回数组" class="headerlink" title="命令返回数组"></a>命令返回数组</h4><p>当我们把一个命令的执行结果保存到一个变量中，可能会认为变量存放的是纯文本。<br>但是，事实上 <code>PowerShell</code> 会把文本按每一行作为元素存为数组。如果一个命令的返回值不止一个结果时， <code>PowerShell</code> 也会自动把结果存储为数组</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$IPcfg</span>=ipconfig</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$IPcfg</span></span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Windows IP 配置</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">以太网适配器 以太网:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   媒体状态  . . . . . . . . . . . . : 媒体已断开连接</span></span><br><span class="line"><span class="comment">   连接特定的 DNS 后缀 . . . . . . . : lan</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">无线局域网适配器 本地连接* 1:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   媒体状态  . . . . . . . . . . . . : 媒体已断开连接</span></span><br><span class="line"><span class="comment">   连接特定的 DNS 后缀 . . . . . . . :</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">无线局域网适配器 本地连接* 2:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   连接特定的 DNS 后缀 . . . . . . . :</span></span><br><span class="line"><span class="comment">   本地链接 IPv6 地址. . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   IPv4 地址 . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   子网掩码  . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   默认网关. . . . . . . . . . . . . :</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">以太网适配器 VMware Network Adapter VMnet8:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   连接特定的 DNS 后缀 . . . . . . . :</span></span><br><span class="line"><span class="comment">   本地链接 IPv6 地址. . . . . . . . : fe80::f88d:cd97:5343:9713%16</span></span><br><span class="line"><span class="comment">   IPv4 地址 . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   子网掩码  . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   默认网关. . . . . . . . . . . . . :</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">无线局域网适配器 WLAN:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   连接特定的 DNS 后缀 . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   本地链接 IPv6 地址. . . . . . . . : fe80::954:3964:3731:997e%18</span></span><br><span class="line"><span class="comment">   IPv4 地址 . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   子网掩码  . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">   默认网关. . . . . . . . . . . . . : ****</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$IPcfg</span>.Count</span><br><span class="line"><span class="number">37</span></span><br></pre></td></tr></table></figure>

<h5 id="使用数组存储结果"><a href="#使用数组存储结果" class="headerlink" title="使用数组存储结果"></a>使用数组存储结果</h5><p>判断一个变量是否为数组</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PS C:/Powershell&gt; <span class="variable">$ip</span>=ipconfig</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$ip</span> -is [array]</span><br><span class="line">True</span><br><span class="line">PS C:/Powershell&gt; <span class="string">"abac"</span> -is [array]</span><br><span class="line">False</span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$str</span>=<span class="string">"字符串"</span></span><br><span class="line">PS C:/Powershell&gt; <span class="variable">$str</span>.ToCharArray() -is [array] <span class="comment">#转换为字符数组</span></span><br><span class="line">True</span><br></pre></td></tr></table></figure>

<h5 id="使用真实的对象操作"><a href="#使用真实的对象操作" class="headerlink" title="使用真实的对象操作"></a>使用真实的对象操作</h5><p>为什么不愿把IPconfig返回的结果称为对象，因为它不是真正Cmdlet命令(事实上ipconfig是一个单独的程序)，真正的 <code>PowerShell</code> 命令返回的数组元素可不止一个字符串，它是一个内容丰富的对象。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">PS D:/test&gt; <span class="variable">$list</span>=ls</span><br><span class="line">PS D:/test&gt; <span class="variable">$list</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    目录: D:/test</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-a----       <span class="number">2017</span>/<span class="number">11</span>/<span class="number">24</span>     <span class="number">12</span>:<span class="number">52</span>            <span class="number">136</span> <span class="number">4</span>-<span class="number">3</span>.cpp</span><br><span class="line">-a----        <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span>     <span class="number">15</span>:<span class="number">13</span>             <span class="number">65</span> anapple.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS D:/test&gt; <span class="variable">$list</span>.gettype()</span><br><span class="line"></span><br><span class="line">IsPublic IsSerial Name                                     BaseType</span><br><span class="line">-------- -------- ----                                     --------</span><br><span class="line">True     True     Object[]                                 System.Array</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS D:/test&gt; <span class="keyword">foreach</span>(<span class="variable">$i</span> <span class="keyword">in</span> <span class="variable">$list</span>)&#123;<span class="variable">$i</span>.name&#125;</span><br><span class="line"><span class="number">4</span>-<span class="number">3</span>.cpp</span><br><span class="line">anapple.txt</span><br><span class="line"></span><br><span class="line">PS D:/test&gt; <span class="variable">$list</span>[<span class="number">0</span>].gettype()</span><br><span class="line"></span><br><span class="line">IsPublic IsSerial Name                                     BaseType</span><br><span class="line">-------- -------- ----                                     --------</span><br><span class="line">True     True     FileInfo                                 System.IO.FileSystemInfo</span><br></pre></td></tr></table></figure>

<p>上面的例子中数组的每一个元素存放的是一个 <code>System.IO.DirectoryInfo</code> 对象。<br>当我们输出这些对象时，<code>PowerShell</code> 会自动帮我们把它转换成友好的文本格式。<br>对于任何一个对象都可以使用 <code>Format-List *</code> 来查看它所有的属性和方法。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">PS D:/test&gt; <span class="variable">$list</span>[<span class="number">0</span>]|fl * </span><br><span class="line"><span class="comment"># "|"符号是管道符，将左边返回结果做参数发送到右侧，fl是Format-List的简称</span></span><br><span class="line"></span><br><span class="line">PSPath            : Microsoft.PowerShell.Core\FileSystem::D:test\<span class="number">4</span>-<span class="number">3</span>.cpp</span><br><span class="line">PSParentPath      : Microsoft.PowerShell.Core\FileSystem::D:\test</span><br><span class="line">PSChildName       : <span class="number">4</span>-<span class="number">3</span>.cpp</span><br><span class="line">PSDrive           : D</span><br><span class="line">PSProvider        : Microsoft.PowerShell.Core\FileSystem</span><br><span class="line">PSIsContainer     : False</span><br><span class="line">Mode              : -a----</span><br><span class="line">VersionInfo       : File:             D:\test\<span class="number">4</span>-<span class="number">3</span>.cpp</span><br><span class="line">                    InternalName:</span><br><span class="line">                    OriginalFilename:</span><br><span class="line">                    FileVersion:</span><br><span class="line">                    FileDescription:</span><br><span class="line">                    Product:</span><br><span class="line">                    ProductVersion:</span><br><span class="line">                    Debug:            False</span><br><span class="line">                    Patched:          False</span><br><span class="line">                    PreRelease:       False</span><br><span class="line">                    PrivateBuild:     False</span><br><span class="line">                    SpecialBuild:     False</span><br><span class="line">                    Language:</span><br><span class="line"></span><br><span class="line">BaseName          : <span class="number">4</span>-<span class="number">3</span></span><br><span class="line">Target            : &#123;&#125;</span><br><span class="line">LinkType          :</span><br><span class="line">Name              : <span class="number">4</span>-<span class="number">3</span>.cpp</span><br><span class="line">Length            : <span class="number">136</span></span><br><span class="line">DirectoryName     : D:\test</span><br><span class="line">Directory         : D:\test</span><br><span class="line">IsReadOnly        : False</span><br><span class="line">Exists            : True</span><br><span class="line">FullName          : D:\test\<span class="number">4</span>-<span class="number">3</span>.cpp</span><br><span class="line">Extension         : .cpp</span><br><span class="line">CreationTime      : <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">32</span></span><br><span class="line">CreationTimeUtc   : <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span> <span class="number">7</span>:<span class="number">07</span>:<span class="number">32</span></span><br><span class="line">LastAccessTime    : <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">32</span></span><br><span class="line">LastAccessTimeUtc : <span class="number">2019</span>/<span class="number">3</span>/<span class="number">27</span> <span class="number">7</span>:<span class="number">07</span>:<span class="number">32</span></span><br><span class="line">LastWriteTime     : <span class="number">2017</span>/<span class="number">11</span>/<span class="number">24</span> <span class="number">12</span>:<span class="number">52</span>:<span class="number">28</span></span><br><span class="line">LastWriteTimeUtc  : <span class="number">2017</span>/<span class="number">11</span>/<span class="number">24</span> <span class="number">4</span>:<span class="number">52</span>:<span class="number">28</span></span><br><span class="line">Attributes        : Archive</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>函数是自定义的 <code>Powershell</code> 代码，有三个原则：  </p>
<ul>
<li><strong>简短</strong>：函数名简短，并且显而易见。  </li>
<li><strong>聚合</strong>：函数可以完成多个操作。  </li>
<li><strong>封装和扩展</strong>：将一批 <code>Powershell</code> 语句进行封装，实现全新的功能需求。<br>函数的结构由三部分组成：函数名，参数，函数体</li>
</ul>
<h4 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h4><h5 id="脚本中函数的定义方法"><a href="#脚本中函数的定义方法" class="headerlink" title="脚本中函数的定义方法"></a>脚本中函数的定义方法</h5><p>函数可以在文本编辑器上编写，写完以后复制进 <code>PowerShell</code> 控制台即可。如果控制台设置为快速编辑模式，从记事本复制后，直接在控制台鼠标右键即可完成粘贴(Windows 10默认开启了快速编辑模式)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> FuncName(args[]) <span class="comment">#括号可省略</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">&lt;#代码段#&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="控制台上多行输入定义函数"><a href="#控制台上多行输入定义函数" class="headerlink" title="控制台上多行输入定义函数"></a>控制台上多行输入定义函数</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS C:/PowerShell&gt; <span class="keyword">function</span> MyPing</span><br><span class="line">&gt;&gt; &#123;</span><br><span class="line">&gt;&gt; PING.EXE  -n <span class="number">1</span> <span class="variable">$args</span></span><br><span class="line">&gt;&gt; &#125;</span><br><span class="line">PS C:/PowerShell&gt;</span><br></pre></td></tr></table></figure>

<h5 id="把函数精简成一行"><a href="#把函数精简成一行" class="headerlink" title="把函数精简成一行"></a>把函数精简成一行</h5><p>我们可以将一个函数定义在一行上，但是这样阅读和理解起来就不方便，所以要在每条命令后加分号进行分割(最后一句可以不写<code>;</code>)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:/PowerShell&gt; <span class="keyword">function</span> cd...&#123; cd.. ; cd.. &#125;</span><br><span class="line">PS C:/PowerShell&gt; cd...</span><br></pre></td></tr></table></figure>

<h5 id="使用函数作为别名"><a href="#使用函数作为别名" class="headerlink" title="使用函数作为别名"></a>使用函数作为别名</h5><p>假如 <code>PowerShell</code> 不支持 <code>Get-SystemVersion</code> 命令，你可以通过定义函数实现这个功能：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> get-systemversion</span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$psversiontable</span>.BuildVersion</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Get-SystemVersion</span><br><span class="line"></span><br><span class="line">Major  Minor  Build  Revision</span><br><span class="line">-----  -----  -----  --------</span><br><span class="line"><span class="number">10</span>     <span class="number">0</span>      <span class="number">17134</span>  <span class="number">590</span></span><br></pre></td></tr></table></figure>

<h5 id="更新函数"><a href="#更新函数" class="headerlink" title="更新函数"></a>更新函数</h5><p>如果要更新已经定义好的函数，简单的方法是重新定义，这样新的定义会覆盖旧的定义。但是如果函数代码没有保存副本，可以先将函数定义导出到ps文件，然后就可以编辑了。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PS C:/PowerShell&gt; <span class="keyword">function</span> MyPing</span><br><span class="line">&gt;&gt; &#123;</span><br><span class="line">&gt;&gt; PING.EXE  -n <span class="number">1</span> <span class="variable">$args</span></span><br><span class="line">&gt;&gt; &#125;</span><br><span class="line"></span><br><span class="line">PS C:/PowerShell&gt; <span class="variable">$function:MyPing</span> | <span class="built_in">Out-File</span> myPing.ps1</span><br><span class="line">PS C:/PowerShell&gt; <span class="variable">$function:MyPing</span></span><br><span class="line"></span><br><span class="line">PING.EXE  -n <span class="number">1</span> <span class="variable">$args</span></span><br><span class="line"></span><br><span class="line">PS C:/PowerShell&gt; <span class="variable">$function:MyPing</span> | <span class="built_in">Out-File</span> myPing.ps1</span><br><span class="line">PS C:/PowerShell&gt; .myPing.ps1</span><br><span class="line">必须指定 IP 地址。</span><br><span class="line">PS C:/PowerShell&gt; notepad.exe $$</span><br></pre></td></tr></table></figure>

<h5 id="删除函数"><a href="#删除函数" class="headerlink" title="删除函数"></a>删除函数</h5><p>控制台定义的函数只会在当前会话生效，一旦控制台退出，会自动消失。在不关闭控制台的条件下删除一个已经定义好的函数，可是使用虚拟驱动器的方法：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> cc&#123;<span class="string">"hello"</span>&#125;</span><br><span class="line">PS C:/&gt; cc</span><br><span class="line">hello</span><br><span class="line">PS C:/&gt; del <span class="keyword">function</span>:cc</span><br><span class="line">PS C:/&gt; cc</span><br><span class="line">cc : 无法将“cc”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正确，然后再试一次。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">1</span></span><br><span class="line">+ cc</span><br><span class="line">+ ~~</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (cc:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br></pre></td></tr></table></figure>

<h4 id="输入输出函数"><a href="#输入输出函数" class="headerlink" title="输入输出函数"></a>输入输出函数</h4><p>用于脚本文件的编写</p>
<h5 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h5><p>PowerShell提供了 <code>Read-Host</code> 命令，可以接收返回用户在控制台输入的字符</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$name</span>=<span class="built_in">read-host</span> <span class="string">"请输入你的名字"</span> </span><br><span class="line"><span class="comment">#会把提示信息打印到PS控制台，也可以不写提示信息</span></span><br><span class="line"><span class="comment">&lt;#执行+输入 结果:</span></span><br><span class="line"><span class="comment">请输入你的名字: Nougat </span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"><span class="variable">$name</span></span><br><span class="line">Nougat</span><br></pre></td></tr></table></figure>

<p>注意到</p>
<ol>
<li>提示信息(如果有)后面自动加了个冒号；</li>
<li>用户键入任何信息都被作为该命令的返回结果；</li>
<li>可以把键入的信息传递给一个变量；</li>
</ol>
<h5 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h5><p>有两种输出命令<br><code>Write-Host</code>和<code>Write-Output</code><br>若输出字符串不包含空白字符可以不加引号</p>
<h6 id="Write-Host"><a href="#Write-Host" class="headerlink" title="Write-Host"></a><code>Write-Host</code></h6><p>当需要展示一个特定信息，比如使用其他颜色来吸引人们的注意力的时候，可使用 <code>Write-Host</code> 命令<br> <code>Write-Host</code> 和其他Cmdlets一样使用管道，但是它不放置任何数据道管道中。反而会直接写到宿主应用程序的界面。正如此，可以使用<code>-ForegroundColor</code> 和 <code>-BackgroundColor</code> 参数将前景和背景设置为其他颜色：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">write-host</span> <span class="string">"啊哈"</span> -ForegroundColor White -BackgroundColor Red</span><br><span class="line">啊哈</span><br></pre></td></tr></table></figure>

<p>注：<strong>不是每个使用PowerShell的应用程序都支持其他颜色，也并不是每个应用程序都支持所有颜色</strong>。
该输出方法<strong>不适用于常规的输出结果</strong>，因为 <code>Write-Host</code> 命令输出到屏幕的任何东西都无法被捕捉。若执行远程命令或无人值守命令(纯自动化)， <code>Write-Host</code> 可能不会按照你的预期工作。因此，此命令仅仅用于与人进行直接交互。</p>
<h6 id="Write-Output"><a href="#Write-Output" class="headerlink" title="Write-Output"></a><code>Write-Output</code></h6><p><code>Write-Output</code>命令会将对象发送给管道。由于它不会直接发送到显示界面，所以不允许你指定其他任何的颜色。</p>
<p>它是<code>PowerShell</code>默认使用的一个Cmdlets，默认输出方式即使用该命令，即使你没有指定，<code>PowerShell</code>会在底层将信息传递给<code>Write-Output</code>命令(就是一行直接写一个变量就能直接输出的情况)，另外这个命令还有两个别名 <code>write</code> 和 <code>echo</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">write-host</span> ACB <span class="comment">#无空白字符可以不写引号 </span></span><br><span class="line">ACB</span><br><span class="line">write <span class="string">"ABC"</span></span><br><span class="line">ABC</span><br><span class="line">echo <span class="string">"ABD"</span></span><br><span class="line">ABD</span><br></pre></td></tr></table></figure>

<p><code>Write-Output</code>输出基本过程为：</p>
<blockquote>
<ol>
<li><code>Write-Output</code>命令将<code>string</code>类型的对象<code>Hello World!</code>放入管道中；</li>
<li>管道中只有这个<code>string</code>对象，其会直接到达管道的末端，也就是<code>Out-Default</code>命令；</li>
<li><code>Out-Default</code>命令将对象传递给<code>Out-Host</code>命令；</li>
<li><code>Out-Host</code>命令要求<code>PowerShell</code>的格式化系统格式化该对象。</li>
<li><code>Out-Host</code>将格式化的结果集放在显示界面上</li>
</ol>
</blockquote>
<p>还有一点，在输出多个对象时，<code>Write-Host</code>会以空格隔开各对象<br><code>Write-Output</code>会以换行隔开各对象</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">write-host</span> <span class="string">"ABC"</span> <span class="string">"23232"</span></span><br><span class="line">ABC <span class="number">23232</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">write-output</span> <span class="string">"ABC"</span> <span class="string">"23232"</span></span><br><span class="line">ABC </span><br><span class="line"><span class="number">23232</span></span><br></pre></td></tr></table></figure>

<h6 id="其他的输出方式"><a href="#其他的输出方式" class="headerlink" title="其他的输出方式"></a>其他的输出方式</h6><p><code>Write-Warning/Verbose/Debug/Error</code></p>
<p>具体参考：<a href="https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.utility/write-debug?view=powershell-3.0" target="_blank" rel="noopener">微软官方文档</a></p>
<h4 id="处理函数参数"><a href="#处理函数参数" class="headerlink" title="处理函数参数"></a>处理函数参数</h4><p><code>PowerShell</code> 函数可以接受参数，并对参数进行处理。函数的参数有3个特性：</p>
<ol>
<li>任意参数：内部变量<code>$args</code> 接受函数调用时接受的参数，<code>$args</code>是一个数组类型；</li>
<li>命名参数：函数的每一个参数可以分配一个名称，在调用时通过名称指定对应的参数；</li>
<li>预定义参数：函数在定义参数时可以指定默认值，如果调用时没有专门指定参数的值，就会保持默认值；</li>
</ol>
<h5 id="args-万能参数"><a href="#args-万能参数" class="headerlink" title="$args 万能参数"></a>$args 万能参数</h5><p>给一个函数定义参数最简单的是使用<code>$args</code>这个内置的参数。它可以识别任意个参数。尤其适用那些参数可有可无的函数。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> sayHello</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$args</span>.Count <span class="nomarkup">-eq</span> <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"No argument!"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$args</span> | <span class="keyword">foreach</span> &#123;<span class="string">"Hello,$(<span class="variable">$_</span>)"</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#无参调用</span></span><br><span class="line">sayhello</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">No argument!</span><br><span class="line"></span><br><span class="line"><span class="comment">#一参调用</span></span><br><span class="line">sayhello <span class="string">"World!"</span> <span class="comment">#也可以写成sayhello("World!")</span></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">Hello,World!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#多参数调用</span></span><br><span class="line"><span class="variable">$str</span>=<span class="string">"it's me."</span></span><br><span class="line">sayhello <span class="number">123</span> <span class="string">"aha"</span> <span class="variable">$str</span> <span class="comment">#如果字符串不包含空白字符(比如空格)，引号可以不写</span></span><br><span class="line"><span class="comment">&lt;#输出</span></span><br><span class="line"><span class="comment">Hello,123</span></span><br><span class="line"><span class="comment">Hello,aha</span></span><br><span class="line"><span class="comment">Hello,it's me.</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br></pre></td></tr></table></figure>

<p>因为 <code>$arg</code> 是一个数组,可以用它很方便的写出求和函数</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> Add</span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$sum</span>=<span class="number">0</span></span><br><span class="line">	<span class="variable">$args</span> | <span class="keyword">foreach</span> &#123;<span class="variable">$sum</span>=<span class="variable">$sum</span>+<span class="variable">$_</span>&#125;</span><br><span class="line">	<span class="variable">$sum</span></span><br><span class="line">&#125;</span><br><span class="line">Add <span class="number">10</span> <span class="number">7</span> <span class="number">3</span> <span class="number">100</span></span><br><span class="line"><span class="comment">#120</span></span><br></pre></td></tr></table></figure>

<h5 id="使用固定参数"><a href="#使用固定参数" class="headerlink" title="使用固定参数"></a>使用固定参数</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> StringContact(<span class="variable">$str1</span>,<span class="variable">$str2</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$str1</span>+<span class="variable">$str2</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">StringContact LN P</span><br><span class="line"><span class="comment">#StringContact -str1 word -str2 press</span></span><br><span class="line"><span class="comment">#StringContact("word","press")</span></span><br><span class="line">LNP</span><br><span class="line">wordpress</span><br></pre></td></tr></table></figure>

<h5 id="给参数定义默认值"><a href="#给参数定义默认值" class="headerlink" title="给参数定义默认值"></a>给参数定义默认值</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> stringContact(<span class="variable">$str1</span>=<span class="string">"LN"</span>,<span class="variable">$str2</span>=<span class="string">"P"</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$str1</span>+<span class="variable">$str2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stringContact</span><br><span class="line">LNP</span><br></pre></td></tr></table></figure>

<h5 id="使用强类型参数"><a href="#使用强类型参数" class="headerlink" title="使用强类型参数"></a>使用强类型参数</h5><p>通过之前的例子发现将用户的参数传递给函数显得比较混乱。罪魁祸首就是<code>PowerShell</code>的参数解释器，它可以自动处理和分配参数给函数。<br>函数的参数解释器比较傲慢，它对你提供的参数的信息完全不关心。它只会粗略地将参数进行分割，并且最大限度的进行自动类型转换。事实上，这种类型转换很多时候并不完美。所以<strong>最好提前能够对参数进行强类型限制</strong></p>
<h5 id="限制数字类型"><a href="#限制数字类型" class="headerlink" title="限制数字类型"></a>限制数字类型</h5><p>下面的函数执行后，会抛出异常<br>因为 <code>subtract</code> 的参数定义了强类型，参数的类型可能引起函数的处理结果改变。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> subtract([int]<span class="variable">$value1</span>,[int]<span class="variable">$value2</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$value1</span>-<span class="variable">$value2</span></span><br><span class="line">&#125;</span><br><span class="line">subtract LN P</span><br><span class="line"><span class="comment">#执行结果报错</span></span><br><span class="line">subtract : 无法处理对参数“value1”的参数转换。无法将值“LN”转换为类型“System.Int32”。错误:“输入字符串的格式不正确。”</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">10</span></span><br><span class="line">+ subtract LN P</span><br><span class="line">+          ~~</span><br><span class="line">    + CategoryInfo          : InvalidData: (:) [subtract]，ParameterBindingArgumentTransformationException</span><br><span class="line">    + FullyQualifiedErrorId : ParameterArgumentTransformationError,subtract</span><br><span class="line"></span><br><span class="line">subtract <span class="number">8.1</span> <span class="number">7.9</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="comment">&lt;#结果为0，这是因为PowerShell对结果整型化时进行了四舍五入</span></span><br><span class="line"><span class="comment">但是如果将上面的函数的参数定义为Double型#&gt;</span></span><br><span class="line"><span class="keyword">function</span> subtract([double]<span class="variable">$value1</span>,[double]<span class="variable">$value2</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$value1</span>-<span class="variable">$value2</span></span><br><span class="line">&#125;</span><br><span class="line">subtract <span class="number">8.1</span>  <span class="number">7.9</span></span><br><span class="line"><span class="number">0.199999999999999</span></span><br><span class="line"><span class="comment">&lt;#输出 0.199999999999999的原因就是 .NET使用IEEE754标准存储浮点数，</span></span><br><span class="line"><span class="comment">由于这些小数转化二进制会无限循环，会根据一定精度截取尾数，</span></span><br><span class="line"><span class="comment">这个问题引发了这种奇怪的结果，</span></span><br><span class="line"><span class="comment">其实著名的0.1+0.2!=0.3也是这个原因导致的#&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="限制日期类型"><a href="#限制日期类型" class="headerlink" title="限制日期类型"></a>限制日期类型</h5><p>函数的参数解释器会自动尝试将字符串转换成日期类型，如果转换失败就是抛出异常<br>看下面的例子</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> DayOfWeek([datetime]<span class="variable">$date</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span>  <span class="variable">$date</span>.DayOfWeek</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DayofWeek <span class="string">'1927-8-1'</span></span><br><span class="line">Monday</span><br><span class="line"></span><br><span class="line">DayofWeek <span class="number">2008</span>-<span class="number">8</span>-<span class="number">1</span></span><br><span class="line">Friday</span><br><span class="line"></span><br><span class="line">DayofWeek <span class="string">'abc'</span></span><br><span class="line">DayOfWeek : 无法处理对参数“date”的参数转换。无法将值“abc”转换为类型“System.DateTime”。错误:“该字符串未被识别为有效的 DateTime。有一个未知单词(从索引 <span class="number">0</span> 处开始)。”</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">12</span></span><br><span class="line">+  DayofWeek <span class="string">'abc'</span></span><br><span class="line">+            ~~~~~</span><br><span class="line">    + CategoryInfo          : InvalidData: (:) [DayOfWeek]，ParameterBindingArgumentTransformationException</span><br><span class="line">    + FullyQualifiedErrorId : ParameterArgumentTransformationError,DayOfWeek</span><br></pre></td></tr></table></figure>

<h5 id="Switch-参数"><a href="#Switch-参数" class="headerlink" title="Switch 参数"></a>Switch 参数</h5><p><code>Powershell</code> 函数最简单的参数类型为布尔类型，除了使用 <code>Bool</code> 类型，也可以使用 <code>Switch</code> 关键字。<br>下面的函数逆转字符串，但是可以通过 <code>$try</code> 参数进行控制，如果没有指定 <code>$try</code> 的值，默认值为 <code>$false</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>  tryReverse( [switch]<span class="variable">$try</span> , [string]<span class="variable">$source</span> ) </span><br><span class="line"><span class="comment">#此处switch完全可以换成bool</span></span><br><span class="line">&#123;</span><br><span class="line">    [string]<span class="variable">$target</span>=<span class="string">""</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$try</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>( [int]<span class="variable">$i</span> = <span class="variable">$source</span>.length -<span class="number">1</span>; <span class="variable">$i</span> <span class="nomarkup">-ge</span> <span class="number">0</span> ;<span class="variable">$i</span>--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$target</span> += <span class="variable">$source</span>[<span class="variable">$i</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$target</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$source</span></span><br><span class="line">&#125;</span><br><span class="line">tryReverse -source www.google.com</span><br><span class="line">tryReverse -try <span class="literal">$true</span> -source www.google.com</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">www.google.com</span><br><span class="line">moc.eloog.www</span><br></pre></td></tr></table></figure>

<h4 id="指定函数的返回值"><a href="#指定函数的返回值" class="headerlink" title="指定函数的返回值"></a>指定函数的返回值</h4><h5 id="一个或多个返回值"><a href="#一个或多个返回值" class="headerlink" title="一个或多个返回值"></a>一个或多个返回值</h5><p><code>PowerShell</code> 不像其它的编程语言，它的函数可以有多个返回值。如果你直接调用函数，返回值会在控制台输出。当然你也可以将结果存储在一个变量中进一步处理<br>下面的例子演示返回一个值：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> Square([double]<span class="variable">$num</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>*<span class="variable">$num</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#在控制台输出结果</span></span><br><span class="line">Square <span class="number">9.87</span></span><br><span class="line"><span class="number">97.4169</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#将结果赋值给变量</span></span><br><span class="line"><span class="variable">$value</span>=Square <span class="number">9.87</span></span><br><span class="line"><span class="variable">$value</span></span><br><span class="line"><span class="number">97.4169</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#返回值为Double类型</span></span><br><span class="line"><span class="variable">$value</span>.GetType().FullName</span><br><span class="line">System.Double</span><br></pre></td></tr></table></figure>

<p>下面的例子演示返回多个值</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> gbMeasure(<span class="variable">$amount</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"<span class="variable">$amount</span> GB=$(<span class="variable">$amount</span>) GB"</span></span><br><span class="line">    <span class="string">"<span class="variable">$amount</span> GB=$(<span class="variable">$amount</span>*1gb/1mb) MB"</span></span><br><span class="line">    <span class="string">"<span class="variable">$amount</span> GB=$(<span class="variable">$amount</span>*1gb/1kb) KB"</span></span><br><span class="line">    <span class="string">"<span class="variable">$amount</span> GB=$(<span class="variable">$amount</span>*1gb) B"</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#函数返回4个值</span></span><br><span class="line">gbMeasure <span class="number">1</span></span><br><span class="line"><span class="number">1</span> GB=<span class="number">1</span> GB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1024</span> MB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1048576</span> KB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1073741824</span> B</span><br><span class="line"> </span><br><span class="line"><span class="comment">#将所有的返回值存储在一个变量中</span></span><br><span class="line"><span class="variable">$result</span>=gbMeasure <span class="number">1</span></span><br><span class="line"><span class="variable">$result</span></span><br><span class="line"> </span><br><span class="line"><span class="number">1</span> GB=<span class="number">1</span> GB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1024</span> MB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1048576</span> KB</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1073741824</span> B</span><br><span class="line"> </span><br><span class="line"><span class="comment">#所有的返回值会自动存储在一个数组中</span></span><br><span class="line"><span class="variable">$result</span>=gbMeasure <span class="number">1</span></span><br><span class="line"><span class="variable">$result</span>.GetType().Name</span><br><span class="line">Object[]</span><br><span class="line"> </span><br><span class="line"><span class="comment">#通过索引访问每个返回值</span></span><br><span class="line"><span class="variable">$result</span>=gbMeasure <span class="number">1</span></span><br><span class="line"><span class="variable">$result</span>[<span class="number">3</span>]</span><br><span class="line"><span class="number">1</span> GB=<span class="number">1073741824</span> B</span><br></pre></td></tr></table></figure>

<p>总结一下，如果一个函数返回一个值，像其它编程语言一样，这个值包括它的类型信息会直接返回。但是如果遇到多个返回值，PowerShell会将所有的返回值自动构造成一个对象数组。<br>可以通过索引访问数组</p>
<h5 id="Return语句"><a href="#Return语句" class="headerlink" title="Return语句"></a>Return语句</h5><p><code>Powershell</code> 会将函数中所有的输出作为返回值，但是也可以通过return语句指定具体的返回值。<br>Return 语句会将指定的值返回，同时也会中断函数的执行，<strong>return后面的语句会被忽略</strong></p>
<p>看一个例子</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> test(<span class="variable">$num</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">1</span></span><br><span class="line">    <span class="number">9</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span></span><br><span class="line">    <span class="number">4</span></span><br><span class="line">    <span class="number">6</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="comment">&lt;# 1 和 9 作为输出会返回</span></span><br><span class="line"><span class="comment">return语句中的10 也会返回</span></span><br><span class="line"><span class="comment">return 语句后的4和6会被忽略#&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="访问返回值"><a href="#访问返回值" class="headerlink" title="访问返回值"></a>访问返回值</h5><p>一个函数返回了一个值还是多个值，是可以验证的。下面的例子会产生随机数，如果没有指定个数，默认会返回一个随机数，否则会返回指定个数的随机数</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> lottery([int]<span class="variable">$number</span>=<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$rand</span> = <span class="built_in">New-Object</span> system.random</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">1</span>; <span class="variable">$i</span> <span class="nomarkup">-le</span> <span class="variable">$number</span>; <span class="variable">$i</span>++) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$rand</span>.next(<span class="number">1</span>,<span class="number">50</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数为空时，返回值不是数组:</span></span><br><span class="line"><span class="variable">$result</span> = lottery</span><br><span class="line"><span class="variable">$result</span> -is [array]</span><br><span class="line">False</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果指定多个随机数时，返回值是数组类型:</span></span><br><span class="line"><span class="variable">$result</span> = lottery <span class="number">10</span></span><br><span class="line"><span class="variable">$result</span> -is [array]</span><br><span class="line">True</span><br><span class="line"><span class="variable">$result</span>.count</span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>

<h5 id="从函数的返回值中消除输出"><a href="#从函数的返回值中消除输出" class="headerlink" title="从函数的返回值中消除输出"></a>从函数的返回值中消除输出</h5><p>函数默认会将函数中的所有输出作为函数的返回值返回，这样很方便。但有时可能会将不必要的输出误以为返回值。写脚本程序时，可能需要自定义一些函数，这个函数可能只需要一个返回值，但是为了提高函数的可读性，可能会在函数增加一些注释输出行，或者使用<code>write-host</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> Test()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"Try to calculate."</span></span><br><span class="line">    <span class="string">"3.1415926"</span></span><br><span class="line">    <span class="string">"Done."</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#保存在变量中输出,</span></span><br><span class="line"><span class="variable">$value</span>=Test</span><br><span class="line"><span class="variable">$value</span></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="keyword">Try</span> to calculate.</span><br><span class="line"><span class="number">3.1415926</span></span><br><span class="line">Done.</span><br><span class="line"> </span><br><span class="line"><span class="comment">#如果要过滤注释，只输出，不作为返回值，</span></span><br><span class="line"><span class="comment">#可以使用Write-Host命令</span></span><br><span class="line"><span class="keyword">function</span> Test()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">"Try to calculate."</span></span><br><span class="line">    <span class="string">"3.1415926"</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">"Done."</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 在变量值中保存返回值，在控制台输出注释行</span></span><br><span class="line"><span class="variable">$value</span>=Test</span><br><span class="line"><span class="comment">#控制台输出</span></span><br><span class="line"><span class="keyword">Try</span> to calculate.</span><br><span class="line">Done.</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 测试返回值</span></span><br><span class="line"><span class="variable">$value</span></span><br><span class="line"><span class="number">3.1415926</span></span><br></pre></td></tr></table></figure>

<p>恭喜你！到此 <code>PowerShell</code> 基础入门算是完成了！<br>之后将介绍 <code>PowerShell</code> 的进阶使用</p>
<h4 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h4><h5 id="PowerShell-Math类常用函数表"><a href="#PowerShell-Math类常用函数表" class="headerlink" title="PowerShell Math类常用函数表"></a>PowerShell Math类常用函数表</h5><table>
<thead>
<tr>
<th>函数名</th>
<th>调用写法</th>
<th>所在类</th>
<th>重载</th>
<th>描述</th>
<th>参数</th>
</tr>
</thead>
<tbody><tr>
<td>sin</td>
<td>[math]::sin(x)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x弧度的正弦值</td>
<td>double</td>
</tr>
<tr>
<td>cos</td>
<td>[math]::cos(x)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x弧度的余弦值</td>
<td>double</td>
</tr>
<tr>
<td>abs</td>
<td>[math]::abs(x)</td>
<td>System.Math</td>
<td>7</td>
<td>返回x的绝对值</td>
<td>所有数值型</td>
</tr>
<tr>
<td>sqrt</td>
<td>[math]::sqrt(x)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x的平方根</td>
<td>double</td>
</tr>
<tr>
<td>pow</td>
<td>[math]::pow(x,n)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x的n次幂</td>
<td>两参数都是double</td>
</tr>
<tr>
<td>log</td>
<td>[math]::log(x)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x的自然对数</td>
<td>double</td>
</tr>
<tr>
<td>log</td>
<td>[math]::log(x,n)</td>
<td>System.Math</td>
<td>1</td>
<td>返回x的以n为底的对数</td>
<td>double</td>
</tr>
<tr>
<td>min</td>
<td>[math]::min(x,y)</td>
<td>System.Math</td>
<td>11</td>
<td>返回x，y中的最小值</td>
<td>所有数值型</td>
</tr>
<tr>
<td>max</td>
<td>[math]::max(x,y)</td>
<td>System.Math</td>
<td>11</td>
<td>返回x，y中的最大值</td>
<td>所有数值型</td>
</tr>
<tr>
<td>floor</td>
<td>[math]::ceiling(x)</td>
<td>System.Math</td>
<td>2</td>
<td>返回x向下取整的结果</td>
<td>double、decimal</td>
</tr>
<tr>
<td>ceiling</td>
<td>[math]::ceiling(x)</td>
<td>System.Math</td>
<td>2</td>
<td>返回x向上取整的结果</td>
<td>double、decimal</td>
</tr>
<tr>
<td><code>math</code> 类其他函数及详细用法参见微软文档: <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.math?view=netframework-4.7.2#%E6%96%B9%E6%B3%95" target="_blank" rel="noopener">Math类</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

          
        </div>
        
          <br>
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/Crepeblog/tags/PowerShell/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>PowerShell</p></a></div>


        
      
    </div>
  </section>


        
        
            <div class="prev-next">
                
                    <section class="prev">
                        <span class="art-item-left">
                            <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页</h6>
                            <h4>
                                <a href="/Crepeblog/2019/09/06/网络安全协会网站的搭建(1)/" rel="prev" title="网络安全协会网站的搭建(一)">
                                  
                                      网络安全协会网站的搭建(一)
                                  
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/Crepeblog/tags/Vue-js/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Vue.js</a> <a class="tag" href="/Crepeblog/tags/网站搭建/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> 网站搭建</a> <a class="tag" href="/Crepeblog/tags/网络安全协会/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> 网络安全协会</a>
                                </h6>
                            
                        </span>
                    </section>
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/Crepeblog/2019/04/30/记一次express后端的搭建/" rel="prev" title="记一次express后端的搭建">
                                    
                                        记一次express后端的搭建
                                    
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/Crepeblog/tags/网站搭建/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> 网站搭建</a> <a class="tag" href="/Crepeblog/tags/Node-js/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Node.js</a> <a class="tag" href="/Crepeblog/tags/Express/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Express</a> <a class="tag" href="/Crepeblog/tags/后端/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> 后端</a>
                                </h6>
                            
                        </span>
                    </section>
                
            </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box comments  body-blur">
    <section class="article typo">
      <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4>
      
      
      
      
        <section id="comments">
          <div id="valine_container" class="valine_thread">
            <i class="fas fa-spinner fa-spin fa-fw"></i>
          </div>
        </section>
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'PowerShell入门指南(3)',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        

<section class="widget grid  widget-blur desktop">
  
  <header>
    
      <i class="fas fa-map-signs fa-fw" aria-hidden="true"></i><span class='name'>博客导航</span>
    
  </header>


  <div class='content'>
    <ul class="grid navigation">
      
        <li><a class="flat-box" title="/Crepeblog/" href="/Crepeblog/"
          
          
          id="Crepeblog">
          
            <i class="fas fa-bullhorn fa-fw" aria-hidden="true"></i>
          
          近期消息
        </a></li>
      
        <li><a class="flat-box" title="/Crepeblog/archives/" href="/Crepeblog/archives/"
          
          
          id="Crepeblogarchives">
          
            <i class="fas fa-file-archive fa-fw" aria-hidden="true"></i>
          
          消息归档
        </a></li>
      
        <li><a class="flat-box" title="https://github.com/xaoxuu/hexo-theme-material-x/releases/" href="https://github.com/xaoxuu/hexo-theme-material-x/releases/"
          
            rel="external nofollow noopener noreferrer"
          
          
            target="_blank"
          
          id="https:github.comxaoxuuhexo-theme-material-xreleases">
          
            <i class="fas fa-clipboard-list fa-fw" aria-hidden="true"></i>
          
          主题更新日志
        </a></li>
      
    </ul>
  </div>
</section>

      
    
      
    
  
    
      
        

<section class="widget blogger  widget-blur desktop">
  <div class='content'>
    
      <div class='avatar'>
        <img class='avatar' src='https://cdn.jsdelivr.net/gh/lollipopnougat/picbed/33110314.png'/>
      </div>
    
    
      <div class='text'>
        
        
        
          <p><span id="jinrishici-sentence">LNP</span></p>
          <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="mailto:ab2defg145@126.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://github.com/lollipopnougat"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://weibo.com/u/1949144895"
              class="social fab fa-weibo flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://www.zhihu.com/people/SDSR/activities"
              class="social fab fa-zhihu flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=505951930"
              class="social fas fa-music flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
      
    
      
        


  <section class="widget toc-wrapper  widget-blur desktop mobile">
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#PowerShell入门指南-三-·一门新的编程语言"><span class="toc-text">PowerShell入门指南(三)·一门新的编程语言</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#作为独立的编程语言"><span class="toc-text">作为独立的编程语言</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#特点"><span class="toc-text">特点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#破天荒的方便"><span class="toc-text">破天荒的方便</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#面向对象"><span class="toc-text">面向对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#依托-NET"><span class="toc-text">依托 .NET</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#强大的兼容性"><span class="toc-text">强大的兼容性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#基于平台的可扩展性"><span class="toc-text">基于平台的可扩展性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用Get-Help-快速入门"><span class="toc-text">使用Get-Help 快速入门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基本语法"><span class="toc-text">基本语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#背景"><span class="toc-text">背景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#关于空白字符"><span class="toc-text">关于空白字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码块和代码基本结构"><span class="toc-text">代码块和代码基本结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PowerShell-脚本的基本结构"><span class="toc-text">PowerShell 脚本的基本结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#执行策略限制"><span class="toc-text">执行策略限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运行-PowerShell-脚本"><span class="toc-text">运行 PowerShell 脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#通过重定向创建脚本"><span class="toc-text">通过重定向创建脚本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#通过编辑器创建脚本"><span class="toc-text">通过编辑器创建脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#变量"><span class="toc-text">变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#选择变量名"><span class="toc-text">选择变量名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看变量类型"><span class="toc-text">查看变量类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除变量"><span class="toc-text">删除变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#整型"><span class="toc-text">整型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#浮点型"><span class="toc-text">浮点型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#其他简单类型"><span class="toc-text">其他简单类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#赋值和返回值"><span class="toc-text">赋值和返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#弱类型与强类型"><span class="toc-text">弱类型与强类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#类型转换"><span class="toc-text">类型转换</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运算符"><span class="toc-text">运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#条件分支"><span class="toc-text">条件分支</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#if-else"><span class="toc-text">if else</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#switch"><span class="toc-text">switch</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#循环"><span class="toc-text">循环</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#for循环"><span class="toc-text">for循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#do-while循环"><span class="toc-text">do-while循环</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#只使用while"><span class="toc-text">只使用while</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#跳出循环"><span class="toc-text">跳出循环</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数组"><span class="toc-text">数组</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#定义数组"><span class="toc-text">定义数组</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#对象数组的多态"><span class="toc-text">对象数组的多态</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#空数组和单元素数组"><span class="toc-text">空数组和单元素数组</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用数组"><span class="toc-text">使用数组</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#遍历"><span class="toc-text">遍历</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#将数组逆序输出"><span class="toc-text">将数组逆序输出</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#访问某些元素"><span class="toc-text">访问某些元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#从数组中选择多个元素"><span class="toc-text">从数组中选择多个元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#给数组添加元素"><span class="toc-text">给数组添加元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#删除指定位置元素"><span class="toc-text">删除指定位置元素</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#复制数组"><span class="toc-text">复制数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#强类型数组"><span class="toc-text">强类型数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#命令返回数组"><span class="toc-text">命令返回数组</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#使用数组存储结果"><span class="toc-text">使用数组存储结果</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#使用真实的对象操作"><span class="toc-text">使用真实的对象操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#函数"><span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#定义函数"><span class="toc-text">定义函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#脚本中函数的定义方法"><span class="toc-text">脚本中函数的定义方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#控制台上多行输入定义函数"><span class="toc-text">控制台上多行输入定义函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#把函数精简成一行"><span class="toc-text">把函数精简成一行</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#使用函数作为别名"><span class="toc-text">使用函数作为别名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#更新函数"><span class="toc-text">更新函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#删除函数"><span class="toc-text">删除函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#输入输出函数"><span class="toc-text">输入输出函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#输入"><span class="toc-text">输入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#输出"><span class="toc-text">输出</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#处理函数参数"><span class="toc-text">处理函数参数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#args-万能参数"><span class="toc-text">$args 万能参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#使用固定参数"><span class="toc-text">使用固定参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#给参数定义默认值"><span class="toc-text">给参数定义默认值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#使用强类型参数"><span class="toc-text">使用强类型参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#限制数字类型"><span class="toc-text">限制数字类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#限制日期类型"><span class="toc-text">限制日期类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Switch-参数"><span class="toc-text">Switch 参数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#指定函数的返回值"><span class="toc-text">指定函数的返回值</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#一个或多个返回值"><span class="toc-text">一个或多个返回值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Return语句"><span class="toc-text">Return语句</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#访问返回值"><span class="toc-text">访问返回值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#从函数的返回值中消除输出"><span class="toc-text">从函数的返回值中消除输出</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#附录"><span class="toc-text">附录</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PowerShell-Math类常用函数表"><span class="toc-text">PowerShell Math类常用函数表</span></a></li></ol></li></ol></li></ol>
    </div>
  </section>


      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
      
    
      
    
      
    
      
        
  

  <section class="widget tagcloud  widget-blur desktop">
    
  <header>
    
      <a href='blog/tags/'><i class="fas fa-tags fa-fw" aria-hidden="true"></i><span class='name'>热门标签</span></a>
    
  </header>


    <div class='content'>
      <a href="/Crepeblog/tags/C-C/" style="font-size: 14px; color: #999">C/C++</a> <a href="/Crepeblog/tags/Express/" style="font-size: 14px; color: #999">Express</a> <a href="/Crepeblog/tags/HTML/" style="font-size: 14px; color: #999">HTML</a> <a href="/Crepeblog/tags/Node-js/" style="font-size: 14px; color: #999">Node.js</a> <a href="/Crepeblog/tags/PowerShell/" style="font-size: 24px; color: #555">PowerShell</a> <a href="/Crepeblog/tags/Vue-js/" style="font-size: 14px; color: #999">Vue.js</a> <a href="/Crepeblog/tags/python/" style="font-size: 14px; color: #999">python</a> <a href="/Crepeblog/tags/元旦/" style="font-size: 14px; color: #999">元旦</a> <a href="/Crepeblog/tags/后端/" style="font-size: 14px; color: #999">后端</a> <a href="/Crepeblog/tags/吐槽/" style="font-size: 14px; color: #999">吐槽</a> <a href="/Crepeblog/tags/春节/" style="font-size: 14px; color: #999">春节</a> <a href="/Crepeblog/tags/爬虫/" style="font-size: 14px; color: #999">爬虫</a> <a href="/Crepeblog/tags/网站搭建/" style="font-size: 19px; color: #777">网站搭建</a> <a href="/Crepeblog/tags/网络安全协会/" style="font-size: 14px; color: #999">网络安全协会</a> <a href="/Crepeblog/tags/节日祝福/" style="font-size: 19px; color: #777">节日祝福</a> <a href="/Crepeblog/tags/面向对象/" style="font-size: 14px; color: #999">面向对象</a>
    </div>
  </section>


      
    
      
    
      
    
      
    
      
    
  
</aside>

<footer class="clearfix white">
  <br><br>
  
    <div class="social-wrapper">
      
        
          <a href="mailto:ab2defg145@126.com"
            class="social fas fa-envelope flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://github.com/lollipopnougat"
            class="social fab fa-github flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://weibo.com/u/1949144895"
            class="social fab fa-weibo flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://www.zhihu.com/people/SDSR/activities"
            class="social fab fa-zhihu flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://music.163.com/#/user/home?id=505951930"
            class="social fas fa-music flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  
    <br>
    <div class="aplayer-container">
      

  
    <meting-js
      theme='#1BCDFC'
      autoplay='false'
      volume='0.7'
      loop='all'
      order='list'
      fixed='false'
      list-max-height='340px'
      server='netease'
      type='playlist'
      id='2579535954'
      list-folded='true'>
    </meting-js>
  


    </div>
  
  <br>
  <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
  <div>
    本站使用
    <a href="https://xaoxuu.com/wiki/volantis/" target="_blank" class="codename">Volantis</a>
    作为主题
    
      ，
      总访问量为
      <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
      次
    
    。
  </div>
  
</footer>
<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/Crepeblog/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>


  <script async src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>
  <script async src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script>




  <script async src="//cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    <script src="//cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('') {
          $('').backstretch(
          ["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/2884F904-F1F3-479E-AE27-5EBC291B63B0.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/298468D7-E388-44A8-8CC5-8213BDC33CED.jpeg"],
          {
            duration: "10000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/2884F904-F1F3-479E-AE27-5EBC291B63B0.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/298468D7-E388-44A8-8CC5-8213BDC33CED.jpeg"],
          {
            duration: "10000",
            fade: "2500"
          });
        }
      });
    </script>
  









  
    <script src="/Crepeblog/js/valine.js"></script>
  
  <script>
  var GUEST_INFO = ['nick','mail','link'];
  var guest_info = 'nick,mail,link'.split(',').filter(function(item){
    return GUEST_INFO.indexOf(item) > -1
  });
  var notify = 'true' == true;
  var verify = 'true' == true;
  var valine = new Valine();
  valine.init({
    el: '#valine_container',
    notify: notify,
    verify: verify,
    guest_info: guest_info,
    
    appId: "pexXNosfrdkaSXNiev7EMXs8-gzGzoHsz",
    appKey: "yIuA205Vt21KbLTH3nmmGVj2",
    placeholder: "快来评论吧~",
    pageSize:'10',
    avatar:'mp',
    lang:'zh-cn',
    highlight:'true'
  })
  </script>



  <script src="/Crepeblog/js/app.js"></script>


  <script src="/Crepeblog/js/search.js"></script>


  <script src="//cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@20.2.33/js/comment_typing.js"></script>


<!-- 夝制 -->

  <script src="//cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>




<!-- fancybox -->

  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>







  <script>setLoadingBarProgress(100);</script>
</body>
</html>
